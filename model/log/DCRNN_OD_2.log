data.shape (17544, 69)
pred_NYC-Taxi_DCRNN_2201031939 training started Mon Jan  3 19:39:48 2022
TRAIN XS.shape YS,shape (14021, 12, 69, 1) (14021, 3, 69, 1)
Model Training Started ... Mon Jan  3 19:39:48 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 69, 64]           --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 69, 64]              75,072
|    |    └─DCGRU_Cell: 3-2              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 69, 64]              147,648
|    |    └─DCGRU_Cell: 3-14             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 69, 64]              (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 69, 1]               --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 69, 64]              75,072
|    |    └─DCGRU_Cell: 3-26             [-1, 69, 64]              147,648
|    └─Linear: 2-1                       [-1, 69, 1]               65
├─DCGRU_Decoder: 1-3                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 69, 64]              (recursive)
|    └─Linear: 2-2                       [-1, 69, 1]               (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 69, 64]              (recursive)
|    └─Linear: 2-3                       [-1, 69, 1]               (recursive)
==========================================================================================
Total params: 445,505
Trainable params: 445,505
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.40
Params size (MB): 1.70
Estimated Total Size (MB): 2.11
==========================================================================================
XS_torch.shape:   torch.Size([14021, 12, 69, 1])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 24  seconds  train loss: 0.44122893315866557 validation loss: 0.3833950840944028
epoch 1 time used: 24  seconds  train loss: 0.3977502903178028 validation loss: 0.3674079942757649
epoch 2 time used: 24  seconds  train loss: 0.3880455719655058 validation loss: 0.36074506264037565
epoch 3 time used: 25  seconds  train loss: 0.3808189087225787 validation loss: 0.3586613268629184
epoch 4 time used: 25  seconds  train loss: 0.37585215265174854 validation loss: 0.3563363950591188
epoch 5 time used: 25  seconds  train loss: 0.3708008517941474 validation loss: 0.35289176149294843
epoch 6 time used: 25  seconds  train loss: 0.36709671081531153 validation loss: 0.3507360247326659
epoch 7 time used: 25  seconds  train loss: 0.3643910416007469 validation loss: 0.3459170874669357
epoch 8 time used: 25  seconds  train loss: 0.3614776575938474 validation loss: 0.34793153799607013
epoch 9 time used: 25  seconds  train loss: 0.3589269447042921 validation loss: 0.34388141423310814
epoch 10 time used: 26  seconds  train loss: 0.35665734286684536 validation loss: 0.33930422009499633
epoch 11 time used: 25  seconds  train loss: 0.35508824040962034 validation loss: 0.34299190395978674
epoch 12 time used: 25  seconds  train loss: 0.35342946960516386 validation loss: 0.3426437165760273
epoch 13 time used: 24  seconds  train loss: 0.3522971682627037 validation loss: 0.34044641480742355
epoch 14 time used: 25  seconds  train loss: 0.35034091393139916 validation loss: 0.3378107146712214
epoch 15 time used: 25  seconds  train loss: 0.3498192231799711 validation loss: 0.3365931964505419
epoch 16 time used: 24  seconds  train loss: 0.3483831158359081 validation loss: 0.3371490791771525
epoch 17 time used: 25  seconds  train loss: 0.3472802648919003 validation loss: 0.3352084688064512
epoch 18 time used: 24  seconds  train loss: 0.346453051818556 validation loss: 0.33713026000510876
epoch 19 time used: 24  seconds  train loss: 0.34509139321197857 validation loss: 0.3335568359662517
epoch 20 time used: 24  seconds  train loss: 0.3442866271953844 validation loss: 0.3350010984160189
epoch 21 time used: 24  seconds  train loss: 0.34325570011900736 validation loss: 0.3343724296117468
epoch 22 time used: 25  seconds  train loss: 0.34245328681454196 validation loss: 0.33428077915703575
epoch 23 time used: 24  seconds  train loss: 0.34184907445271706 validation loss: 0.3314169065073702
epoch 24 time used: 24  seconds  train loss: 0.3409793771339388 validation loss: 0.33732520315011977
epoch 25 time used: 25  seconds  train loss: 0.33989338704573435 validation loss: 0.33268963899601545
epoch 26 time used: 24  seconds  train loss: 0.3392990845342704 validation loss: 0.33042495208540035
epoch 27 time used: 24  seconds  train loss: 0.33820857264570353 validation loss: 0.3308757969772754
epoch 28 time used: 25  seconds  train loss: 0.3376057092300797 validation loss: 0.3305711262884374
epoch 29 time used: 24  seconds  train loss: 0.33691001135672505 validation loss: 0.3342044766773446
epoch 30 time used: 24  seconds  train loss: 0.3360505593126202 validation loss: 0.32891733170031684
epoch 31 time used: 25  seconds  train loss: 0.3352546732997832 validation loss: 0.33117628614357114
epoch 32 time used: 24  seconds  train loss: 0.33429891686312024 validation loss: 0.3282616207651322
epoch 33 time used: 25  seconds  train loss: 0.33376919168931557 validation loss: 0.327590112252978
epoch 34 time used: 23  seconds  train loss: 0.33309374892987603 validation loss: 0.3282616576737699
epoch 35 time used: 25  seconds  train loss: 0.3322400803922791 validation loss: 0.3273817638601498
epoch 36 time used: 25  seconds  train loss: 0.33151669253695076 validation loss: 0.3258826465893662
epoch 37 time used: 24  seconds  train loss: 0.33059681841710664 validation loss: 0.32774126531393677
epoch 38 time used: 25  seconds  train loss: 0.3302508693080326 validation loss: 0.3252579862739587
epoch 39 time used: 24  seconds  train loss: 0.3295707214255655 validation loss: 0.32603591636324775
epoch 40 time used: 24  seconds  train loss: 0.3288838132355942 validation loss: 0.3264450916241593
epoch 41 time used: 25  seconds  train loss: 0.3282578133063632 validation loss: 0.32627607697564676
epoch 42 time used: 24  seconds  train loss: 0.327546388970006 validation loss: 0.3249431204197411
epoch 43 time used: 24  seconds  train loss: 0.32672494936541313 validation loss: 0.32421593086690953
epoch 44 time used: 25  seconds  train loss: 0.32615336108215476 validation loss: 0.3241392286994834
epoch 45 time used: 24  seconds  train loss: 0.3254556563960095 validation loss: 0.3219581630933101
epoch 46 time used: 25  seconds  train loss: 0.32511464241354016 validation loss: 0.322401233319208
epoch 47 time used: 22  seconds  train loss: 0.3240445868410036 validation loss: 0.3253445087911331
epoch 48 time used: 25  seconds  train loss: 0.3237812776479264 validation loss: 0.3224031327794908
epoch 49 time used: 24  seconds  train loss: 0.32321066773011625 validation loss: 0.3235930299935719
epoch 50 time used: 24  seconds  train loss: 0.32246485133881597 validation loss: 0.324464210580569
epoch 51 time used: 23  seconds  train loss: 0.32230290326459576 validation loss: 0.3216928335441159
epoch 52 time used: 24  seconds  train loss: 0.32199323110289707 validation loss: 0.32209196394331713
epoch 53 time used: 25  seconds  train loss: 0.3210403696407042 validation loss: 0.3201220696882323
epoch 54 time used: 24  seconds  train loss: 0.3203591468243246 validation loss: 0.3203334155010619
epoch 55 time used: 24  seconds  train loss: 0.31991237893647156 validation loss: 0.32168079415390444
epoch 56 time used: 18  seconds  train loss: 0.319405793541217 validation loss: 0.32067127064235945
epoch 57 time used: 24  seconds  train loss: 0.3192974238528621 validation loss: 0.32232775772495126
epoch 58 time used: 24  seconds  train loss: 0.31904529264900633 validation loss: 0.3203515810111014
epoch 59 time used: 25  seconds  train loss: 0.3182863473386923 validation loss: 0.32092144325401056
epoch 60 time used: 24  seconds  train loss: 0.31854761728332454 validation loss: 0.32231146153285717
epoch 61 time used: 24  seconds  train loss: 0.31730223956502995 validation loss: 0.3198672891071165
epoch 62 time used: 25  seconds  train loss: 0.31723585782161473 validation loss: 0.32145796720463415
epoch 63 time used: 24  seconds  train loss: 0.31677528687202855 validation loss: 0.31911526272722607
epoch 64 time used: 24  seconds  train loss: 0.3160008213245639 validation loss: 0.3180048650696967
epoch 65 time used: 24  seconds  train loss: 0.31592929411836196 validation loss: 0.319573543392041
epoch 66 time used: 24  seconds  train loss: 0.31539125200743623 validation loss: 0.3189609916939167
epoch 67 time used: 24  seconds  train loss: 0.315221879209802 validation loss: 0.3197826313176838
epoch 68 time used: 24  seconds  train loss: 0.3151081756248045 validation loss: 0.31761880393240427
epoch 69 time used: 24  seconds  train loss: 0.31491257787178345 validation loss: 0.32006491447814317
epoch 70 time used: 24  seconds  train loss: 0.3145649521270014 validation loss: 0.3176798305202741
epoch 71 time used: 24  seconds  train loss: 0.31374577469067033 validation loss: 0.31765910852179824
epoch 72 time used: 24  seconds  train loss: 0.3136851004758175 validation loss: 0.3187182381604647
epoch 73 time used: 24  seconds  train loss: 0.31297186644760605 validation loss: 0.316186263791779
epoch 74 time used: 24  seconds  train loss: 0.3130649154781712 validation loss: 0.31676167644097064
epoch 75 time used: 24  seconds  train loss: 0.31233698253061004 validation loss: 0.317438260953357
epoch 76 time used: 25  seconds  train loss: 0.3123175411357295 validation loss: 0.3172820453397628
epoch 77 time used: 24  seconds  train loss: 0.3118615579849973 validation loss: 0.3162875227328375
epoch 78 time used: 24  seconds  train loss: 0.31192207674580597 validation loss: 0.3187190905782881
epoch 79 time used: 24  seconds  train loss: 0.31160949872649374 validation loss: 0.3167648354361415
epoch 80 time used: 21  seconds  train loss: 0.3107291063288349 validation loss: 0.317125609753408
epoch 81 time used: 18  seconds  train loss: 0.311009537029002 validation loss: 0.3161265171567032
epoch 82 time used: 18  seconds  train loss: 0.31060678879407005 validation loss: 0.3165768630594372
epoch 83 time used: 18  seconds  train loss: 0.3103043000026444 validation loss: 0.315818754421665
epoch 84 time used: 24  seconds  train loss: 0.31032560425159167 validation loss: 0.31486952857364603
epoch 85 time used: 24  seconds  train loss: 0.3098452170508515 validation loss: 0.3160780877537953
epoch 86 time used: 25  seconds  train loss: 0.3095484520932693 validation loss: 0.3157218389183334
epoch 87 time used: 24  seconds  train loss: 0.310121757853175 validation loss: 0.31675126657306435
epoch 88 time used: 24  seconds  train loss: 0.30935731602096 validation loss: 0.314311569051884
epoch 89 time used: 25  seconds  train loss: 0.30905429739535417 validation loss: 0.3150455670668204
epoch 90 time used: 24  seconds  train loss: 0.30913254031732335 validation loss: 0.31690588528880104
epoch 91 time used: 24  seconds  train loss: 0.3087661466401837 validation loss: 0.31577041303166237
epoch 92 time used: 24  seconds  train loss: 0.30846303892827476 validation loss: 0.31448811110740243
epoch 93 time used: 24  seconds  train loss: 0.3082712804567631 validation loss: 0.3143685936111759
epoch 94 time used: 24  seconds  train loss: 0.30840343495397876 validation loss: 0.3144394074993275
epoch 95 time used: 25  seconds  train loss: 0.3078317702360716 validation loss: 0.3129409484297496
epoch 96 time used: 25  seconds  train loss: 0.3077457255772204 validation loss: 0.3146415948867798
epoch 97 time used: 24  seconds  train loss: 0.3076386356979541 validation loss: 0.3157541062140968
epoch 98 time used: 24  seconds  train loss: 0.3077443872906698 validation loss: 0.312992842620397
epoch 99 time used: 24  seconds  train loss: 0.3075439104689501 validation loss: 0.3130103865828571
epoch 100 time used: 24  seconds  train loss: 0.30733043700699547 validation loss: 0.3120257044205717
epoch 101 time used: 24  seconds  train loss: 0.3068566033534674 validation loss: 0.3121150940809669
epoch 102 time used: 25  seconds  train loss: 0.3066834973558215 validation loss: 0.31645078228598517
epoch 103 time used: 25  seconds  train loss: 0.3069985911789413 validation loss: 0.31237386298805253
epoch 104 time used: 24  seconds  train loss: 0.3066122610113463 validation loss: 0.31397425375254034
epoch 105 time used: 24  seconds  train loss: 0.30644223048316177 validation loss: 0.31213394536743555
epoch 106 time used: 25  seconds  train loss: 0.3063874871928256 validation loss: 0.31223750830172675
epoch 107 time used: 25  seconds  train loss: 0.30602185144889305 validation loss: 0.31235946426715294
epoch 108 time used: 24  seconds  train loss: 0.30602022023087494 validation loss: 0.31278180294015107
epoch 109 time used: 23  seconds  train loss: 0.3058708304297003 validation loss: 0.3119859240664391
epoch 110 time used: 24  seconds  train loss: 0.3058160175941338 validation loss: 0.3124023391835974
epoch 111 time used: 24  seconds  train loss: 0.30584024345210137 validation loss: 0.3125739230371106
epoch 112 time used: 24  seconds  train loss: 0.30583139395029724 validation loss: 0.3159113672720794
epoch 113 time used: 20  seconds  train loss: 0.3050926156781728 validation loss: 0.3135427617543912
epoch 114 time used: 22  seconds  train loss: 0.30523131794093056 validation loss: 0.3132867725726474
epoch 115 time used: 24  seconds  train loss: 0.30496778802409946 validation loss: 0.3124687574247054
epoch 116 time used: 24  seconds  train loss: 0.30499244073450194 validation loss: 0.3118247782340814
epoch 117 time used: 24  seconds  train loss: 0.30486286968177406 validation loss: 0.31176213356541416
epoch 118 time used: 24  seconds  train loss: 0.3045615937292362 validation loss: 0.313687123388001
epoch 119 time used: 24  seconds  train loss: 0.3046281577361536 validation loss: 0.3123697073066568
epoch 120 time used: 24  seconds  train loss: 0.30451065722645243 validation loss: 0.3123072665790388
epoch 121 time used: 24  seconds  train loss: 0.3044723072151505 validation loss: 0.3123416759188489
epoch 122 time used: 24  seconds  train loss: 0.30403176614699473 validation loss: 0.3126798534114498
epoch 123 time used: 24  seconds  train loss: 0.30450611991761056 validation loss: 0.3113022039974341
epoch 124 time used: 24  seconds  train loss: 0.3039761025994229 validation loss: 0.3113192795891117
epoch 125 time used: 24  seconds  train loss: 0.30389830008523255 validation loss: 0.31114137087695204
epoch 126 time used: 24  seconds  train loss: 0.303686802778642 validation loss: 0.3102795584026365
epoch 127 time used: 24  seconds  train loss: 0.3042498691135639 validation loss: 0.31105028768641163
epoch 128 time used: 24  seconds  train loss: 0.30379037964721045 validation loss: 0.31143043016408145
epoch 129 time used: 25  seconds  train loss: 0.3038091845336705 validation loss: 0.3117065677558499
epoch 130 time used: 24  seconds  train loss: 0.3036836306532626 validation loss: 0.3117622815739816
epoch 131 time used: 24  seconds  train loss: 0.303627991641349 validation loss: 0.31118396137077603
epoch 132 time used: 24  seconds  train loss: 0.3033422822764925 validation loss: 0.3110029710678801
epoch 133 time used: 24  seconds  train loss: 0.30328178588443055 validation loss: 0.3117720724444218
epoch 134 time used: 24  seconds  train loss: 0.30346473102115595 validation loss: 0.3101411228749797
epoch 135 time used: 24  seconds  train loss: 0.3033537805313624 validation loss: 0.3103068057496549
epoch 136 time used: 24  seconds  train loss: 0.3029763173174695 validation loss: 0.3120446843177471
epoch 137 time used: 24  seconds  train loss: 0.30307147890222474 validation loss: 0.312426655855576
epoch 138 time used: 24  seconds  train loss: 0.30287665715620266 validation loss: 0.3108152628998993
epoch 139 time used: 24  seconds  train loss: 0.3025854967940231 validation loss: 0.3110710711936167
epoch 140 time used: 24  seconds  train loss: 0.3030236413842659 validation loss: 0.3115455554644176
epoch 141 time used: 24  seconds  train loss: 0.30281923069485944 validation loss: 0.3105535374766272
epoch 142 time used: 22  seconds  train loss: 0.30276698113109685 validation loss: 0.3104172983104273
epoch 143 time used: 24  seconds  train loss: 0.30284691991889984 validation loss: 0.3134275129435746
Early stopping at epoch: 144
YS.shape, YS_pred.shape, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
DCRNN, train, Torch MSE, 2.9988875389e-01, 0.2998887539
DCRNN, train, MSE, RMSE, MAE, MAPE, 1616.0946719342, 40.2006799934, 22.0192745849, 32.2545443129
Model Training Ended ... Mon Jan  3 20:39:19 2022
pred_NYC-Taxi_DCRNN_2201031939 testing started Mon Jan  3 20:39:19 2022
TEST XS.shape, YS.shape (3507, 12, 69, 1) (3507, 3, 69, 1)
Model Testing Started ... Mon Jan  3 20:39:19 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
YS.shape, YS_pred.shape, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
DCRNN, test, Torch MSE, 3.0252024017e-01, 0.3025202402
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 1756.4539713252, 41.9100700468, 22.7544229518, 36.4769533003
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 1058.7263312636, 32.5380751008, 18.3141261991, 28.9385758311
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 1781.8931800644, 42.2124765924, 23.1701425450, 36.5667102485
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 2428.7385013395, 49.2822331205, 26.7789704822, 43.9255297248
Model Testing Ended ... Mon Jan  3 20:39:23 2022
