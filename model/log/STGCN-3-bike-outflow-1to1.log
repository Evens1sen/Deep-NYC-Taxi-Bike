nohup: ignoring input
../data-NYCBike/30min/201901-202012-NYCbike-outflow.npz
Namespace(adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=1, cpu=1, dataname='METR-LA', epoch=200, ex='typhoon-inflow', flowpath='../data-NYCBike/30min/201901-202012-NYCbike-outflow.npz', gpu=1, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (35088, 69)
pred_METR-LA_STGCN3_2112241833 training started Fri Dec 24 18:33:13 2021
getXSYS data.shape(35088, 69)
getXSYS XS.shape(28056, 1, 12, 69)
getXSYS YS.shape(28056, 1, 1, 69)
TRAIN XS.shape YS,shape (28056, 1, 12, 69) (28056, 1, 1, 69)
Model Training Started ... Fri Dec 24 18:33:13 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 16, 10, 69]          --
|    |    └─align: 3-1                   [-1, 16, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 32, 10, 69]          128
|    └─spatio_conv_layer: 2-2            [-1, 16, 10, 69]          784
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-3                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 64, 8, 69]           3,136
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 16, 6, 69]           --
|    |    └─align: 3-5                   [-1, 16, 8, 69]           1,040
|    |    └─Conv2d: 3-6                  [-1, 32, 6, 69]           6,176
|    └─spatio_conv_layer: 2-7            [-1, 16, 6, 69]           784
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-7                   [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-8                  [-1, 64, 4, 69]           3,136
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-9                   [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-11                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 78,801
Trainable params: 78,801
Non-trainable params: 0
Total mult-adds (M): 8.39
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 1.42
Params size (MB): 0.30
Estimated Total Size (MB): 1.72
==========================================================================================
epoch 0 time used: 8  seconds  train loss: 0.2903219376443297 validation loss: 0.3428157240126865
epoch 1 time used: 8  seconds  train loss: 0.24465517896567496 validation loss: 0.3562945889158741
epoch 2 time used: 8  seconds  train loss: 0.2304703382753715 validation loss: 0.3358020033291136
epoch 3 time used: 8  seconds  train loss: 0.221005816231595 validation loss: 0.33295842224218447
epoch 4 time used: 8  seconds  train loss: 0.21433437395991267 validation loss: 0.3380367071294771
epoch 5 time used: 8  seconds  train loss: 0.21179481296899813 validation loss: 0.33853617942771713
epoch 6 time used: 8  seconds  train loss: 0.2090815124988721 validation loss: 0.3433561435886554
epoch 7 time used: 8  seconds  train loss: 0.2051772557551363 validation loss: 0.34251567963558555
epoch 8 time used: 8  seconds  train loss: 0.20346216650022558 validation loss: 0.32269964986014715
epoch 9 time used: 8  seconds  train loss: 0.203195679743905 validation loss: 0.32759955917153905
epoch 10 time used: 9  seconds  train loss: 0.2010775497628208 validation loss: 0.33795035604333346
epoch 11 time used: 9  seconds  train loss: 0.19942623139874815 validation loss: 0.3338692889089152
epoch 12 time used: 8  seconds  train loss: 0.19849553468140077 validation loss: 0.3449724870918482
epoch 13 time used: 9  seconds  train loss: 0.19690444678659375 validation loss: 0.3240050865283609
epoch 14 time used: 9  seconds  train loss: 0.19589065917616555 validation loss: 0.33338055114036347
epoch 15 time used: 8  seconds  train loss: 0.19611039702188382 validation loss: 0.33289693076283566
epoch 16 time used: 7  seconds  train loss: 0.19470552472535246 validation loss: 0.31858528887474336
epoch 17 time used: 8  seconds  train loss: 0.19422350073024364 validation loss: 0.3281344895965189
epoch 18 time used: 7  seconds  train loss: 0.1942306118285303 validation loss: 0.33066556951344983
epoch 19 time used: 7  seconds  train loss: 0.1927501484287349 validation loss: 0.3203272951067361
epoch 20 time used: 8  seconds  train loss: 0.1926401954189309 validation loss: 0.332761852905082
epoch 21 time used: 7  seconds  train loss: 0.19191288774943632 validation loss: 0.3352604823589053
epoch 22 time used: 7  seconds  train loss: 0.1914564186551672 validation loss: 0.34132528334796547
epoch 23 time used: 7  seconds  train loss: 0.19154389815357892 validation loss: 0.32460903614920905
epoch 24 time used: 7  seconds  train loss: 0.19016621475164078 validation loss: 0.3323457690515102
epoch 25 time used: 7  seconds  train loss: 0.18950118037745192 validation loss: 0.3320103582660799
Early stopping at epoch: 26
YS.shape, YS_pred.shape, (28056, 1, 1, 69) (28056, 1, 1, 69)
YS.shape, YS_pred.shape, (28056, 69) (28056, 69)
****************************************
STGCN3, train, Torch MSE, 1.8712642519e-01, 0.1871264252

STGCN3, train, MSE, RMSE, MAE, MAPE, 49.0555166110, 7.0039643496, 4.1899822689, 44.2465668079

Model Training Ended ... Fri Dec 24 18:37:06 2021
pred_METR-LA_STGCN3_2112241833 testing started Fri Dec 24 18:37:06 2021
getXSYS data.shape(35088, 69)
getXSYS XS.shape(7016, 1, 12, 69)
getXSYS YS.shape(7016, 1, 1, 69)
TEST XS.shape, YS.shape (7016, 1, 12, 69) (7016, 1, 1, 69)
Model Testing Started ... Fri Dec 24 18:37:06 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
Traceback (most recent call last):
  File "pred_STGCN.py", line 284, in <module>
    main()
  File "pred_STGCN.py", line 280, in main
    testModel(MODELNAME, 'test', testXS, testYS)
  File "pred_STGCN.py", line 211, in testModel
    model.load_state_dict(torch.load(PATH + '/' + name + '.pt'))
  File "/home/cseadmin/mhy/anaconda3/lib/python3.8/site-packages/torch/serialization.py", line 607, in load
    return _load(opened_zipfile, map_location, pickle_module, **pickle_load_args)
  File "/home/cseadmin/mhy/anaconda3/lib/python3.8/site-packages/torch/serialization.py", line 882, in _load
    result = unpickler.load()
  File "/home/cseadmin/mhy/anaconda3/lib/python3.8/site-packages/torch/serialization.py", line 857, in persistent_load
    load_tensor(data_type, size, key, _maybe_decode_ascii(location))
  File "/home/cseadmin/mhy/anaconda3/lib/python3.8/site-packages/torch/serialization.py", line 845, in load_tensor
    storage = zip_file.get_storage_from_record(name, size, dtype).storage()
RuntimeError: PytorchStreamReader failed reading file data/2: invalid header or archive is corrupted
