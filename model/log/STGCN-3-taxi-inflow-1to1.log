nohup: ignoring input
../data-NYCTaxi/30min/201901-202012-NYCtaxi-inflow.npz
Namespace(adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=1, cpu=1, dataname='METR-LA', epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/30min/201901-202012-NYCtaxi-inflow.npz', gpu=2, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (35088, 69)
pred_METR-LA_STGCN3_2112241833 training started Fri Dec 24 18:33:16 2021
getXSYS data.shape(35088, 69)
getXSYS XS.shape(28056, 1, 12, 69)
getXSYS YS.shape(28056, 1, 1, 69)
TRAIN XS.shape YS,shape (28056, 1, 12, 69) (28056, 1, 1, 69)
Model Training Started ... Fri Dec 24 18:33:16 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 16, 10, 69]          --
|    |    └─align: 3-1                   [-1, 16, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 32, 10, 69]          128
|    └─spatio_conv_layer: 2-2            [-1, 16, 10, 69]          784
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-3                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 64, 8, 69]           3,136
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 16, 6, 69]           --
|    |    └─align: 3-5                   [-1, 16, 8, 69]           1,040
|    |    └─Conv2d: 3-6                  [-1, 32, 6, 69]           6,176
|    └─spatio_conv_layer: 2-7            [-1, 16, 6, 69]           784
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-7                   [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-8                  [-1, 64, 4, 69]           3,136
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-9                   [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-11                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 78,801
Trainable params: 78,801
Non-trainable params: 0
Total mult-adds (M): 8.39
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 1.42
Params size (MB): 0.30
Estimated Total Size (MB): 1.72
==========================================================================================
epoch 0 time used: 8  seconds  train loss: 0.33482374393108144 validation loss: 0.09291757632812817
epoch 1 time used: 8  seconds  train loss: 0.27885615422850085 validation loss: 0.09510998454423994
epoch 2 time used: 8  seconds  train loss: 0.263157465852197 validation loss: 0.08339218787226474
epoch 3 time used: 8  seconds  train loss: 0.2541738815235069 validation loss: 0.08432095544372897
epoch 4 time used: 8  seconds  train loss: 0.2496648332970347 validation loss: 0.08791400167144599
epoch 5 time used: 7  seconds  train loss: 0.24471305219494566 validation loss: 0.08022214849815432
epoch 6 time used: 8  seconds  train loss: 0.24254449585765203 validation loss: 0.08083423770728328
epoch 7 time used: 7  seconds  train loss: 0.23949355817048962 validation loss: 0.08016104333364016
epoch 8 time used: 8  seconds  train loss: 0.2377010191429938 validation loss: 0.07797291428955457
epoch 9 time used: 7  seconds  train loss: 0.23684986045372317 validation loss: 0.0818039505743287
epoch 10 time used: 8  seconds  train loss: 0.23455382842940659 validation loss: 0.07717237344512512
epoch 11 time used: 8  seconds  train loss: 0.23342694180735968 validation loss: 0.08091220350382095
epoch 12 time used: 8  seconds  train loss: 0.23219652029058688 validation loss: 0.07688036441828472
epoch 13 time used: 8  seconds  train loss: 0.23153835285816607 validation loss: 0.078111186861516
epoch 14 time used: 7  seconds  train loss: 0.23045200897849083 validation loss: 0.07650821405936416
epoch 15 time used: 7  seconds  train loss: 0.2293497181248532 validation loss: 0.07629412868983527
epoch 16 time used: 7  seconds  train loss: 0.2286494252900154 validation loss: 0.07621551234947503
epoch 17 time used: 7  seconds  train loss: 0.22808334982352926 validation loss: 0.07632245480087975
epoch 18 time used: 7  seconds  train loss: 0.22746104902781955 validation loss: 0.07744417561997298
epoch 19 time used: 7  seconds  train loss: 0.22660780534991334 validation loss: 0.07891715349406982
epoch 20 time used: 7  seconds  train loss: 0.22640066769337808 validation loss: 0.08164896237517069
epoch 21 time used: 7  seconds  train loss: 0.224987610344212 validation loss: 0.0766141926856472
epoch 22 time used: 8  seconds  train loss: 0.22483128231311506 validation loss: 0.07869585656800228
epoch 23 time used: 8  seconds  train loss: 0.22425447046499378 validation loss: 0.07819021831627479
epoch 24 time used: 7  seconds  train loss: 0.22374965380692882 validation loss: 0.07626914316036779
epoch 25 time used: 7  seconds  train loss: 0.22319756314729625 validation loss: 0.07609272692357845
epoch 26 time used: 8  seconds  train loss: 0.22295282052546014 validation loss: 0.07622787853719368
epoch 27 time used: 7  seconds  train loss: 0.22256185222064906 validation loss: 0.0781553638034102
epoch 28 time used: 8  seconds  train loss: 0.2223210549885311 validation loss: 0.07592342920561003
epoch 29 time used: 8  seconds  train loss: 0.2213663850221679 validation loss: 0.0763388418483367
epoch 30 time used: 8  seconds  train loss: 0.2209284164755353 validation loss: 0.07678965540320777
epoch 31 time used: 8  seconds  train loss: 0.22038917488768037 validation loss: 0.0747703611574555
epoch 32 time used: 8  seconds  train loss: 0.22023702566444212 validation loss: 0.0754708276919772
epoch 33 time used: 8  seconds  train loss: 0.21978093181490593 validation loss: 0.07542626331564298
epoch 34 time used: 7  seconds  train loss: 0.2194360681957099 validation loss: 0.07559553360434247
epoch 35 time used: 8  seconds  train loss: 0.21906616210711696 validation loss: 0.075432670600383
epoch 36 time used: 7  seconds  train loss: 0.21880179726364626 validation loss: 0.0774784094423251
epoch 37 time used: 7  seconds  train loss: 0.21813343676987954 validation loss: 0.07635972701971233
epoch 38 time used: 7  seconds  train loss: 0.21855652068808654 validation loss: 0.07572709988045291
epoch 39 time used: 7  seconds  train loss: 0.2180595111950599 validation loss: 0.075307873655817
epoch 40 time used: 7  seconds  train loss: 0.21752344435516785 validation loss: 0.07597584584804896
Early stopping at epoch: 41
YS.shape, YS_pred.shape, (28056, 1, 1, 69) (28056, 1, 1, 69)
YS.shape, YS_pred.shape, (28056, 69) (28056, 69)
****************************************
STGCN3, train, Torch MSE, 2.1770871471e-01, 0.2177087147

STGCN3, train, MSE, RMSE, MAE, MAPE, 146.2553171020, 12.0936064556, 6.9748157511, 35.6235922059

Model Training Ended ... Fri Dec 24 18:38:59 2021
pred_METR-LA_STGCN3_2112241833 testing started Fri Dec 24 18:38:59 2021
getXSYS data.shape(35088, 69)
getXSYS XS.shape(7016, 1, 12, 69)
getXSYS YS.shape(7016, 1, 1, 69)
TEST XS.shape, YS.shape (7016, 1, 12, 69) (7016, 1, 1, 69)
Model Testing Started ... Fri Dec 24 18:38:59 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
Traceback (most recent call last):
  File "pred_STGCN.py", line 284, in <module>
    main()
  File "pred_STGCN.py", line 280, in main
    testModel(MODELNAME, 'test', testXS, testYS)
  File "pred_STGCN.py", line 211, in testModel
    model.load_state_dict(torch.load(PATH + '/' + name + '.pt'))
  File "/home/cseadmin/mhy/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1482, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for STGCN:
	size mismatch for st_conv1.tconv1.conv.weight: copying a param with shape torch.Size([32, 4, 3, 1]) from checkpoint, the shape in current model is torch.Size([32, 1, 3, 1]).
