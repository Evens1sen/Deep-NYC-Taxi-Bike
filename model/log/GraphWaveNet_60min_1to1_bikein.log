data.shape (17544, 69)
pred_METR-LA_GraphWaveNet_2112261651 training started Sun Dec 26 16:51:17 2021
TRAIN XS.shape YS,shape (14021, 1, 69, 12) (14021, 3, 69, 1)
Model Training Started ... Sun Dec 26 16:51:17 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv2d: 1-1                            [-1, 32, 69, 13]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-1                       [-1, 32, 69, 12]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-2                       [-1, 32, 69, 12]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-3                       [-1, 256, 69, 12]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-4                          [-1, 32, 69, 12]          --
|    |    └─nconv: 3-1                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-2                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-3                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-4                   [-1, 32, 69, 12]          --
|    |    └─linear: 3-5                  [-1, 32, 69, 12]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-5                  [-1, 32, 69, 12]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-6                       [-1, 32, 69, 10]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-7                       [-1, 32, 69, 10]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-8                       [-1, 256, 69, 10]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-9                          [-1, 32, 69, 10]          --
|    |    └─nconv: 3-6                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-7                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-8                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-9                   [-1, 32, 69, 10]          --
|    |    └─linear: 3-10                 [-1, 32, 69, 10]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-10                 [-1, 32, 69, 10]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-11                      [-1, 32, 69, 9]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-12                      [-1, 32, 69, 9]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-13                      [-1, 256, 69, 9]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-14                         [-1, 32, 69, 9]           --
|    |    └─nconv: 3-11                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-12                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-13                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-14                  [-1, 32, 69, 9]           --
|    |    └─linear: 3-15                 [-1, 32, 69, 9]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-15                 [-1, 32, 69, 9]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-16                      [-1, 32, 69, 7]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-17                      [-1, 32, 69, 7]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-18                      [-1, 256, 69, 7]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-19                         [-1, 32, 69, 7]           --
|    |    └─nconv: 3-16                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-17                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-18                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-19                  [-1, 32, 69, 7]           --
|    |    └─linear: 3-20                 [-1, 32, 69, 7]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-20                 [-1, 32, 69, 7]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-21                      [-1, 32, 69, 6]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-22                      [-1, 32, 69, 6]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-23                      [-1, 256, 69, 6]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-24                         [-1, 32, 69, 6]           --
|    |    └─nconv: 3-21                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-22                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-23                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-24                  [-1, 32, 69, 6]           --
|    |    └─linear: 3-25                 [-1, 32, 69, 6]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-25                 [-1, 32, 69, 6]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-26                      [-1, 32, 69, 4]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-27                      [-1, 32, 69, 4]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-28                      [-1, 256, 69, 4]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-29                         [-1, 32, 69, 4]           --
|    |    └─nconv: 3-26                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-27                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-28                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-29                  [-1, 32, 69, 4]           --
|    |    └─linear: 3-30                 [-1, 32, 69, 4]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-30                 [-1, 32, 69, 4]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-31                      [-1, 32, 69, 3]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-32                      [-1, 32, 69, 3]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-33                      [-1, 256, 69, 3]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-34                         [-1, 32, 69, 3]           --
|    |    └─nconv: 3-31                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-32                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-33                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-34                  [-1, 32, 69, 3]           --
|    |    └─linear: 3-35                 [-1, 32, 69, 3]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-35                 [-1, 32, 69, 3]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-36                      [-1, 32, 69, 1]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-37                      [-1, 32, 69, 1]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-38                      [-1, 256, 69, 1]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-39                         [-1, 32, 69, 1]           --
|    |    └─nconv: 3-36                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-37                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-38                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-39                  [-1, 32, 69, 1]           --
|    |    └─linear: 3-40                 [-1, 32, 69, 1]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-40                 [-1, 32, 69, 1]           64
├─Conv2d: 1-2                            [-1, 512, 69, 1]          131,584
├─Conv2d: 1-3                            [-1, 3, 69, 1]            1,539
==========================================================================================
Total params: 275,779
Trainable params: 275,779
Non-trainable params: 0
Total mult-adds (M): 71.72
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 11.00
Params size (MB): 1.05
Estimated Total Size (MB): 12.06
==========================================================================================
XS_torch.shape:   torch.Size([14021, 1, 69, 12])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 8  seconds  train loss: 0.31574619123435854 validation loss: 0.37907670481641564
epoch 1 time used: 8  seconds  train loss: 0.24213735698526442 validation loss: 0.38361908552378704
epoch 2 time used: 8  seconds  train loss: 0.2198397486935542 validation loss: 0.34771589651763335
epoch 3 time used: 8  seconds  train loss: 0.21159362344524935 validation loss: 0.3266920954312043
epoch 4 time used: 9  seconds  train loss: 0.2061103172418074 validation loss: 0.3802147331029704
epoch 5 time used: 12  seconds  train loss: 0.2012316577007765 validation loss: 0.34376989089959836
epoch 6 time used: 12  seconds  train loss: 0.19851356955141286 validation loss: 0.32836562204687375
epoch 7 time used: 12  seconds  train loss: 0.19384792708479934 validation loss: 0.33132648911737267
epoch 8 time used: 12  seconds  train loss: 0.1915313606498138 validation loss: 0.33197926740543
epoch 9 time used: 12  seconds  train loss: 0.18904131098022126 validation loss: 0.3174601112238965
epoch 10 time used: 12  seconds  train loss: 0.18744952208081636 validation loss: 0.311629819822393
epoch 11 time used: 12  seconds  train loss: 0.18604062397529764 validation loss: 0.31701845217961555
epoch 12 time used: 12  seconds  train loss: 0.1842087729283486 validation loss: 0.30386830277260685
epoch 13 time used: 12  seconds  train loss: 0.18170898132461036 validation loss: 0.3088095630670505
epoch 14 time used: 12  seconds  train loss: 0.18091478013899026 validation loss: 0.31625439660996624
epoch 15 time used: 12  seconds  train loss: 0.17780482421626398 validation loss: 0.31970558082180167
epoch 16 time used: 12  seconds  train loss: 0.1765692376151783 validation loss: 0.32335299131058315
epoch 17 time used: 12  seconds  train loss: 0.17619347152548268 validation loss: 0.3087800066435738
epoch 18 time used: 12  seconds  train loss: 0.1737629534281307 validation loss: 0.32146383999622147
epoch 19 time used: 12  seconds  train loss: 0.17260311921450538 validation loss: 0.3158565427974096
epoch 20 time used: 12  seconds  train loss: 0.1709455205780464 validation loss: 0.3030717372214257
epoch 21 time used: 12  seconds  train loss: 0.1704853900751074 validation loss: 0.3123191599837726
epoch 22 time used: 12  seconds  train loss: 0.1693441935119234 validation loss: 0.316992346518256
epoch 23 time used: 12  seconds  train loss: 0.16888685565761297 validation loss: 0.3117714545860062
epoch 24 time used: 12  seconds  train loss: 0.1678810449086924 validation loss: 0.3054857317781149
epoch 25 time used: 12  seconds  train loss: 0.16745634984320992 validation loss: 0.3041539690831832
epoch 26 time used: 10  seconds  train loss: 0.16558000474517182 validation loss: 0.30179908757745644
epoch 27 time used: 7  seconds  train loss: 0.1656881975047084 validation loss: 0.30993109972083904
epoch 28 time used: 8  seconds  train loss: 0.16553889828626908 validation loss: 0.2973312135600935
epoch 29 time used: 8  seconds  train loss: 0.16365508373704063 validation loss: 0.3136755249463553
epoch 30 time used: 8  seconds  train loss: 0.1627743784052796 validation loss: 0.2962043628785111
epoch 31 time used: 7  seconds  train loss: 0.1618454458297057 validation loss: 0.3007347860883048
epoch 32 time used: 8  seconds  train loss: 0.1614055394115765 validation loss: 0.30133002124306
epoch 33 time used: 7  seconds  train loss: 0.16154257340018432 validation loss: 0.3017836230792662
epoch 34 time used: 8  seconds  train loss: 0.16075301220878002 validation loss: 0.30375886595868
epoch 35 time used: 7  seconds  train loss: 0.1598173814932298 validation loss: 0.3009905904378472
epoch 36 time used: 7  seconds  train loss: 0.15904607817914457 validation loss: 0.3016458536071636
epoch 37 time used: 7  seconds  train loss: 0.1584532643845387 validation loss: 0.2938539965861332
epoch 38 time used: 8  seconds  train loss: 0.15845533690916663 validation loss: 0.2966018866214219
epoch 39 time used: 7  seconds  train loss: 0.15766179181676676 validation loss: 0.29165777303937224
epoch 40 time used: 7  seconds  train loss: 0.1568716229864235 validation loss: 0.2932006060159077
epoch 41 time used: 7  seconds  train loss: 0.15727167903774525 validation loss: 0.30212132430423416
epoch 42 time used: 8  seconds  train loss: 0.15578336794601033 validation loss: 0.3091300540628667
epoch 43 time used: 8  seconds  train loss: 0.15538244527580297 validation loss: 0.29985231949952557
epoch 44 time used: 8  seconds  train loss: 0.1554600380902808 validation loss: 0.30722198607713513
epoch 45 time used: 7  seconds  train loss: 0.15530176930564368 validation loss: 0.29809762387022726
epoch 46 time used: 7  seconds  train loss: 0.15394977801080087 validation loss: 0.3010642374847116
epoch 47 time used: 8  seconds  train loss: 0.15390041337403482 validation loss: 0.3003442097546642
epoch 48 time used: 8  seconds  train loss: 0.15353163792580163 validation loss: 0.2910169588791868
epoch 49 time used: 8  seconds  train loss: 0.15305552608052644 validation loss: 0.2975296534202606
epoch 50 time used: 8  seconds  train loss: 0.15240083724736467 validation loss: 0.2903298788660945
epoch 51 time used: 7  seconds  train loss: 0.15204373380533057 validation loss: 0.30749866065473064
epoch 52 time used: 7  seconds  train loss: 0.1513720680991407 validation loss: 0.29767739182870456
epoch 53 time used: 8  seconds  train loss: 0.15150706547749404 validation loss: 0.3046813148875544
epoch 54 time used: 7  seconds  train loss: 0.1513912358121138 validation loss: 0.2908794669443991
epoch 55 time used: 7  seconds  train loss: 0.1504931391247484 validation loss: 0.3050316156520887
epoch 56 time used: 7  seconds  train loss: 0.15012039061979474 validation loss: 0.30173930291169315
epoch 57 time used: 7  seconds  train loss: 0.15017265463773224 validation loss: 0.2922883580496701
epoch 58 time used: 7  seconds  train loss: 0.14924486880295432 validation loss: 0.29933831792726423
epoch 59 time used: 7  seconds  train loss: 0.14874045966714766 validation loss: 0.3075525995941075
Early stopping at epoch: 60
YS.shape, YS_pred.shape before, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape after, (14021, 3, 69) (14021, 3, 69)
YS_pred.shape before (14021, 3, 69)
YS_pred.shape after (14021, 3, 69)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
GraphWaveNet, train, Torch MSE, 1.5078823774e-01, 0.1507882377
GraphWaveNet, train, MSE, RMSE, MAE, MAPE, 123.4698421439, 11.1116984365, 6.3270278015, 41.3962537465
Model Training Ended ... Sun Dec 26 17:01:09 2021
pred_METR-LA_GraphWaveNet_2112261651 testing started Sun Dec 26 17:01:09 2021
TEST XS.shape, YS.shape (3507, 1, 69, 12) (3507, 3, 69, 1)
Model Testing Started ... Sun Dec 26 17:01:09 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape before, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape after, (3507, 3, 69) (3507, 3, 69)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
GraphWaveNet, test, Torch MSE, 3.4721103534e-01, 0.3472110353
all pred steps, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 283.7365566672, 16.8444814900, 9.9952954430, 56.4018960328
1 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 156.8345547692, 12.5233603625, 7.6686522924, 42.2509325740
2 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 284.4030162606, 16.8642526149, 10.0711771662, 55.3963528163
3 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 409.9733880238, 20.2477995847, 12.2460806565, 71.5585543262
Model Testing Ended ... Sun Dec 26 17:01:11 2021
