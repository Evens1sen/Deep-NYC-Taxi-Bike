nohup: ignoring input
../data-NYCTaxi/60min/2019-2020-taxi-inoutflow.npz
Namespace(addtime=False, adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=2, dataname='NYC-Taxi-inflow-final-test', datatype=0, epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/60min/2019-2020-taxi-inoutflow.npz', gpu=0, graphnum=1, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (17544, 69, 2)
pred_NYC-Taxi-inflow-final-test_STGCN1_2_2201090429 training started Sun Jan  9 04:29:33 2022
getXSYS data.shape(17544, 69, 2)
getXSYS XS.shape(14023, 2, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
TRAIN XS.shape YS,shape (14023, 2, 12, 69) (14023, 1, 1, 69)
Model Training Started ... Sun Jan  9 04:29:33 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          448
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 99,233
Trainable params: 99,233
Non-trainable params: 0
Total mult-adds (M): 15.41
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 2.16
Params size (MB): 0.38
Estimated Total Size (MB): 2.54
==========================================================================================
epoch 0 time used: 6  seconds  train loss: 0.3327707682621605 validation loss: 0.26804542748913107
epoch 1 time used: 5  seconds  train loss: 0.26887982177753805 validation loss: 0.25599342924625074
epoch 2 time used: 5  seconds  train loss: 0.25482038871340373 validation loss: 0.2430522179542374
epoch 3 time used: 6  seconds  train loss: 0.24767708748020384 validation loss: 0.2338938098666468
epoch 4 time used: 6  seconds  train loss: 0.24375134351638245 validation loss: 0.23475687578107993
epoch 5 time used: 6  seconds  train loss: 0.23949269906670073 validation loss: 0.23117077388018115
epoch 6 time used: 5  seconds  train loss: 0.23685719810954517 validation loss: 0.23288008807831606
epoch 7 time used: 5  seconds  train loss: 0.2350078871848628 validation loss: 0.22870143329117956
epoch 8 time used: 6  seconds  train loss: 0.234470657320555 validation loss: 0.22925413599268613
epoch 9 time used: 5  seconds  train loss: 0.23072718042567578 validation loss: 0.22555712950923276
epoch 10 time used: 5  seconds  train loss: 0.22976640389523276 validation loss: 0.22610210420333243
epoch 11 time used: 5  seconds  train loss: 0.22804038959882467 validation loss: 0.22611260241565878
epoch 12 time used: 5  seconds  train loss: 0.22806610964183993 validation loss: 0.23104183641897225
epoch 13 time used: 5  seconds  train loss: 0.22744897953989843 validation loss: 0.22234817244499258
epoch 14 time used: 5  seconds  train loss: 0.22577338906789857 validation loss: 0.219852984546595
epoch 15 time used: 5  seconds  train loss: 0.22435985120118102 validation loss: 0.22045902198066863
epoch 16 time used: 5  seconds  train loss: 0.22262896054045592 validation loss: 0.22486430852840236
epoch 17 time used: 5  seconds  train loss: 0.2228476670085655 validation loss: 0.22043744763237236
epoch 18 time used: 5  seconds  train loss: 0.22182796146195402 validation loss: 0.22003260385765733
epoch 19 time used: 5  seconds  train loss: 0.22051304736658142 validation loss: 0.22079204257494778
epoch 20 time used: 5  seconds  train loss: 0.2206996806773502 validation loss: 0.2187885864251556
epoch 21 time used: 5  seconds  train loss: 0.2185833014553897 validation loss: 0.21662650029963926
epoch 22 time used: 6  seconds  train loss: 0.21920027206997222 validation loss: 0.21693592918510785
epoch 23 time used: 6  seconds  train loss: 0.21919103386009622 validation loss: 0.21683403684694427
epoch 24 time used: 6  seconds  train loss: 0.21745723716447096 validation loss: 0.21553257108584717
epoch 25 time used: 6  seconds  train loss: 0.21664998293554483 validation loss: 0.21377221203775182
epoch 26 time used: 6  seconds  train loss: 0.21655903482884048 validation loss: 0.21529537974020038
epoch 27 time used: 5  seconds  train loss: 0.21534726981137375 validation loss: 0.21383803895862186
epoch 28 time used: 5  seconds  train loss: 0.21522021616923684 validation loss: 0.21403688917449726
epoch 29 time used: 5  seconds  train loss: 0.2146975722925976 validation loss: 0.21378565666781651
epoch 30 time used: 5  seconds  train loss: 0.21455173338197941 validation loss: 0.21592859208107812
epoch 31 time used: 5  seconds  train loss: 0.21321185596269035 validation loss: 0.21247286910134863
epoch 32 time used: 5  seconds  train loss: 0.21272591415370687 validation loss: 0.21425720449182148
epoch 33 time used: 5  seconds  train loss: 0.211982780507938 validation loss: 0.21236818121014087
epoch 34 time used: 5  seconds  train loss: 0.2116097996850857 validation loss: 0.212563927657796
epoch 35 time used: 5  seconds  train loss: 0.2107983025357115 validation loss: 0.21271561363290123
epoch 36 time used: 5  seconds  train loss: 0.21047707276317096 validation loss: 0.21062383452654565
epoch 37 time used: 6  seconds  train loss: 0.209867898377832 validation loss: 0.2087275481740883
epoch 38 time used: 6  seconds  train loss: 0.20894577039045925 validation loss: 0.2099716641939645
epoch 39 time used: 6  seconds  train loss: 0.20867517979385994 validation loss: 0.2099142123377126
epoch 40 time used: 6  seconds  train loss: 0.20819387343372867 validation loss: 0.20891624451091612
epoch 41 time used: 6  seconds  train loss: 0.20766072889217635 validation loss: 0.2081366582506395
epoch 42 time used: 6  seconds  train loss: 0.20734835723938744 validation loss: 0.21004186691349735
epoch 43 time used: 5  seconds  train loss: 0.20645599100000991 validation loss: 0.2082346794830345
epoch 44 time used: 6  seconds  train loss: 0.20548747624190922 validation loss: 0.20755076536741926
epoch 45 time used: 5  seconds  train loss: 0.20560544330168276 validation loss: 0.21066773206386577
epoch 46 time used: 5  seconds  train loss: 0.20451106868969685 validation loss: 0.20597315724584217
epoch 47 time used: 5  seconds  train loss: 0.20425156034049505 validation loss: 0.205418079810964
epoch 48 time used: 5  seconds  train loss: 0.203402175467094 validation loss: 0.20590143707297695
epoch 49 time used: 5  seconds  train loss: 0.20342933367011795 validation loss: 0.2047513614653589
epoch 50 time used: 5  seconds  train loss: 0.2020574125581965 validation loss: 0.20472813317317387
epoch 51 time used: 5  seconds  train loss: 0.20255372507502223 validation loss: 0.2044660571263439
epoch 52 time used: 5  seconds  train loss: 0.20126781097591262 validation loss: 0.20392903759523046
epoch 53 time used: 5  seconds  train loss: 0.20086002649576953 validation loss: 0.20296964469257928
epoch 54 time used: 5  seconds  train loss: 0.20074132325791108 validation loss: 0.2047783835438817
epoch 55 time used: 5  seconds  train loss: 0.19929138283566333 validation loss: 0.208267984980865
epoch 56 time used: 5  seconds  train loss: 0.19880081361741095 validation loss: 0.2027202253503522
epoch 57 time used: 6  seconds  train loss: 0.19885019407635698 validation loss: 0.20227455094040153
epoch 58 time used: 5  seconds  train loss: 0.19817402966399453 validation loss: 0.20152751680652686
epoch 59 time used: 5  seconds  train loss: 0.19780271990375006 validation loss: 0.20242710764314267
epoch 60 time used: 5  seconds  train loss: 0.19662788211084908 validation loss: 0.19941440798422982
epoch 61 time used: 5  seconds  train loss: 0.19754629444570782 validation loss: 0.20111551352113027
epoch 62 time used: 5  seconds  train loss: 0.19567180157387848 validation loss: 0.20221843541144507
epoch 63 time used: 6  seconds  train loss: 0.19513005631768615 validation loss: 0.19983752926995396
epoch 64 time used: 5  seconds  train loss: 0.19514667614990847 validation loss: 0.20127140051014275
epoch 65 time used: 5  seconds  train loss: 0.19425741567442645 validation loss: 0.20122341244681793
epoch 66 time used: 5  seconds  train loss: 0.19388947149506408 validation loss: 0.1990764896681291
epoch 67 time used: 5  seconds  train loss: 0.19306589014518524 validation loss: 0.1996497646509683
epoch 68 time used: 5  seconds  train loss: 0.19374531178379215 validation loss: 0.19884244773772805
epoch 69 time used: 5  seconds  train loss: 0.19249275973053026 validation loss: 0.19808792872423453
epoch 70 time used: 5  seconds  train loss: 0.19172204252463002 validation loss: 0.19801530767289557
epoch 71 time used: 5  seconds  train loss: 0.1918586844604192 validation loss: 0.19786023699210428
epoch 72 time used: 5  seconds  train loss: 0.19097667256796758 validation loss: 0.19855566252250367
epoch 73 time used: 5  seconds  train loss: 0.19073375541209786 validation loss: 0.19806832988909565
epoch 74 time used: 5  seconds  train loss: 0.1903539845830751 validation loss: 0.19629869304482622
epoch 75 time used: 5  seconds  train loss: 0.1894932824101211 validation loss: 0.197428048379545
epoch 76 time used: 5  seconds  train loss: 0.18937698246360116 validation loss: 0.19637451143653747
epoch 77 time used: 5  seconds  train loss: 0.18916362670493883 validation loss: 0.19596267557456978
epoch 78 time used: 5  seconds  train loss: 0.18853132648980997 validation loss: 0.1958756948105621
epoch 79 time used: 5  seconds  train loss: 0.18771527563787227 validation loss: 0.19605429687298712
epoch 80 time used: 5  seconds  train loss: 0.1876128150689087 validation loss: 0.19500956014096227
epoch 81 time used: 5  seconds  train loss: 0.1872192771214242 validation loss: 0.19338920457459693
epoch 82 time used: 5  seconds  train loss: 0.18686061219753244 validation loss: 0.1978325815164764
epoch 83 time used: 5  seconds  train loss: 0.18633112602099813 validation loss: 0.1939315092152211
epoch 84 time used: 5  seconds  train loss: 0.18573385313116833 validation loss: 0.19309633957510056
epoch 85 time used: 5  seconds  train loss: 0.18523581773892786 validation loss: 0.19217044403229314
epoch 86 time used: 5  seconds  train loss: 0.184617840787115 validation loss: 0.19191686230187271
epoch 87 time used: 5  seconds  train loss: 0.185373303350046 validation loss: 0.19367554176894175
epoch 88 time used: 5  seconds  train loss: 0.18420294033820395 validation loss: 0.19233964843472548
epoch 89 time used: 5  seconds  train loss: 0.18360992077413185 validation loss: 0.19112255985711005
epoch 90 time used: 5  seconds  train loss: 0.18356291283265108 validation loss: 0.19193846535594275
epoch 91 time used: 5  seconds  train loss: 0.1830855710412199 validation loss: 0.19081320439789953
epoch 92 time used: 5  seconds  train loss: 0.18307866033928707 validation loss: 0.19147868190944636
epoch 93 time used: 5  seconds  train loss: 0.18244666682576005 validation loss: 0.19364065764056432
epoch 94 time used: 5  seconds  train loss: 0.18258032400188354 validation loss: 0.191609266981763
epoch 95 time used: 5  seconds  train loss: 0.1817997615222729 validation loss: 0.1919558494518093
epoch 96 time used: 5  seconds  train loss: 0.18149624867660782 validation loss: 0.1910416472148569
epoch 97 time used: 5  seconds  train loss: 0.18124737919785672 validation loss: 0.1901083223848974
epoch 98 time used: 5  seconds  train loss: 0.18121537801300303 validation loss: 0.19085085796616244
epoch 99 time used: 5  seconds  train loss: 0.1808672668322763 validation loss: 0.1891921297336264
epoch 100 time used: 5  seconds  train loss: 0.1804617496069214 validation loss: 0.1902982735389039
epoch 101 time used: 5  seconds  train loss: 0.17997205838160293 validation loss: 0.1911381069619657
epoch 102 time used: 5  seconds  train loss: 0.17922014711392828 validation loss: 0.18954307965496509
epoch 103 time used: 5  seconds  train loss: 0.17972139501435638 validation loss: 0.1901858872301022
epoch 104 time used: 5  seconds  train loss: 0.17885782475527848 validation loss: 0.1885212442141156
epoch 105 time used: 5  seconds  train loss: 0.17879881729123645 validation loss: 0.1878995953188307
epoch 106 time used: 5  seconds  train loss: 0.1785222030817831 validation loss: 0.19035417591240225
epoch 107 time used: 5  seconds  train loss: 0.17823378298471104 validation loss: 0.18746091599676587
epoch 108 time used: 5  seconds  train loss: 0.17785516215371425 validation loss: 0.18834450475433795
epoch 109 time used: 5  seconds  train loss: 0.17798619057069295 validation loss: 0.18799917205224634
epoch 110 time used: 5  seconds  train loss: 0.17720338606261196 validation loss: 0.18765103067252817
epoch 111 time used: 6  seconds  train loss: 0.17685751991973434 validation loss: 0.18789403560463525
epoch 112 time used: 6  seconds  train loss: 0.17677791862829778 validation loss: 0.1870342823041893
epoch 113 time used: 6  seconds  train loss: 0.1764803681027724 validation loss: 0.18759203205364333
epoch 114 time used: 5  seconds  train loss: 0.17595269094663804 validation loss: 0.18679932372711483
epoch 115 time used: 5  seconds  train loss: 0.17588240069495825 validation loss: 0.18659255240076417
epoch 116 time used: 6  seconds  train loss: 0.17594786701692053 validation loss: 0.18585965078997735
epoch 117 time used: 5  seconds  train loss: 0.17562895177483268 validation loss: 0.185345882765579
epoch 118 time used: 5  seconds  train loss: 0.1746921706534831 validation loss: 0.18612336567552581
epoch 119 time used: 6  seconds  train loss: 0.1749751444453618 validation loss: 0.18588063335051486
epoch 120 time used: 5  seconds  train loss: 0.17466680372791166 validation loss: 0.18668797858701186
epoch 121 time used: 5  seconds  train loss: 0.17430000482726699 validation loss: 0.1854408594093796
epoch 122 time used: 5  seconds  train loss: 0.17414386516046795 validation loss: 0.18578057362566794
epoch 123 time used: 5  seconds  train loss: 0.17355007745185905 validation loss: 0.18405525218025998
epoch 124 time used: 6  seconds  train loss: 0.17400835876602805 validation loss: 0.18457527191755912
epoch 125 time used: 6  seconds  train loss: 0.17330899856006993 validation loss: 0.18444262365069447
epoch 126 time used: 5  seconds  train loss: 0.17317276760729328 validation loss: 0.18592353173650067
epoch 127 time used: 6  seconds  train loss: 0.17331493596721687 validation loss: 0.1832658325051554
epoch 128 time used: 5  seconds  train loss: 0.1727347403740436 validation loss: 0.18553011397328026
epoch 129 time used: 5  seconds  train loss: 0.1724958311884794 validation loss: 0.18435023706331977
epoch 130 time used: 5  seconds  train loss: 0.17242261366622663 validation loss: 0.1839679359658677
epoch 131 time used: 6  seconds  train loss: 0.1719763341990543 validation loss: 0.18375037758437415
epoch 132 time used: 6  seconds  train loss: 0.17218124269953372 validation loss: 0.18545226467145354
epoch 133 time used: 6  seconds  train loss: 0.17196824915931783 validation loss: 0.1837309470992053
epoch 134 time used: 6  seconds  train loss: 0.17146699673389165 validation loss: 0.1836937077798234
epoch 135 time used: 5  seconds  train loss: 0.1708851922330763 validation loss: 0.18365842475424612
epoch 136 time used: 5  seconds  train loss: 0.17088680821360858 validation loss: 0.18266325377255116
epoch 137 time used: 5  seconds  train loss: 0.1709055885660425 validation loss: 0.1822131756742002
epoch 138 time used: 5  seconds  train loss: 0.17081807378889005 validation loss: 0.18289650224374487
epoch 139 time used: 5  seconds  train loss: 0.17032450915305908 validation loss: 0.18245146656913616
epoch 140 time used: 5  seconds  train loss: 0.17012825107904792 validation loss: 0.18211847631270314
epoch 141 time used: 5  seconds  train loss: 0.17021295871546138 validation loss: 0.18338937625603477
epoch 142 time used: 5  seconds  train loss: 0.17000680537416182 validation loss: 0.18236326913764256
epoch 143 time used: 5  seconds  train loss: 0.1697476371381957 validation loss: 0.1818421882302572
epoch 144 time used: 5  seconds  train loss: 0.1696345686111007 validation loss: 0.18191902372609936
epoch 145 time used: 5  seconds  train loss: 0.1690765109383778 validation loss: 0.18103963373833498
epoch 146 time used: 5  seconds  train loss: 0.1690617854870133 validation loss: 0.1810661920362789
epoch 147 time used: 5  seconds  train loss: 0.16910378423131572 validation loss: 0.18168550171276807
epoch 148 time used: 5  seconds  train loss: 0.16862455589944206 validation loss: 0.18248768792584905
epoch 149 time used: 5  seconds  train loss: 0.168548340681324 validation loss: 0.18030123055593258
epoch 150 time used: 5  seconds  train loss: 0.16819690116897482 validation loss: 0.1814632633466144
epoch 151 time used: 6  seconds  train loss: 0.1685225068745617 validation loss: 0.18097497244018593
epoch 152 time used: 5  seconds  train loss: 0.1680883630345095 validation loss: 0.18026144276396996
epoch 153 time used: 5  seconds  train loss: 0.16783078545317381 validation loss: 0.18097840285240005
epoch 154 time used: 5  seconds  train loss: 0.16812702224520812 validation loss: 0.17993805415958114
epoch 155 time used: 5  seconds  train loss: 0.1674083308782049 validation loss: 0.17949691617992083
epoch 156 time used: 5  seconds  train loss: 0.16750237566966203 validation loss: 0.18076652801859672
epoch 157 time used: 5  seconds  train loss: 0.1673412213698576 validation loss: 0.18123826543501426
epoch 158 time used: 5  seconds  train loss: 0.16726266512466623 validation loss: 0.18045429031099514
epoch 159 time used: 5  seconds  train loss: 0.16733026090635938 validation loss: 0.1804484078799801
epoch 160 time used: 5  seconds  train loss: 0.16644796620274135 validation loss: 0.17935846254646065
epoch 161 time used: 5  seconds  train loss: 0.16675471611739953 validation loss: 0.17925080077279587
epoch 162 time used: 5  seconds  train loss: 0.16652186713329445 validation loss: 0.17947825445186325
epoch 163 time used: 5  seconds  train loss: 0.16640571129448353 validation loss: 0.17961771465748702
epoch 164 time used: 5  seconds  train loss: 0.16620204936904254 validation loss: 0.17965212623289634
epoch 165 time used: 5  seconds  train loss: 0.16687976781585495 validation loss: 0.17978843527219668
epoch 166 time used: 5  seconds  train loss: 0.1665492042061169 validation loss: 0.18328903625675153
epoch 167 time used: 5  seconds  train loss: 0.16567516728397685 validation loss: 0.1801780047191597
epoch 168 time used: 5  seconds  train loss: 0.16569423306590672 validation loss: 0.17880006284116678
epoch 169 time used: 5  seconds  train loss: 0.1654785551112555 validation loss: 0.17896187262948554
epoch 170 time used: 5  seconds  train loss: 0.16529437985814677 validation loss: 0.17857727945632956
epoch 171 time used: 5  seconds  train loss: 0.16520133039381996 validation loss: 0.1792544400307769
epoch 172 time used: 5  seconds  train loss: 0.16511606182037764 validation loss: 0.17833899219955504
epoch 173 time used: 5  seconds  train loss: 0.16493260561448342 validation loss: 0.17800513825379843
epoch 174 time used: 5  seconds  train loss: 0.16522256695068066 validation loss: 0.1787414722148854
epoch 175 time used: 5  seconds  train loss: 0.16508449093782523 validation loss: 0.1783354356672447
epoch 176 time used: 5  seconds  train loss: 0.1644731624639413 validation loss: 0.17862494532985818
epoch 177 time used: 6  seconds  train loss: 0.1642039195516776 validation loss: 0.17890002850934023
epoch 178 time used: 6  seconds  train loss: 0.16431935568261943 validation loss: 0.17792116396269386
epoch 179 time used: 5  seconds  train loss: 0.16435696724088772 validation loss: 0.1777919645708626
epoch 180 time used: 5  seconds  train loss: 0.16426722787703163 validation loss: 0.17761185670062193
epoch 181 time used: 6  seconds  train loss: 0.16407305341769549 validation loss: 0.17974319642636005
epoch 182 time used: 5  seconds  train loss: 0.164380249823121 validation loss: 0.17914969640259598
epoch 183 time used: 5  seconds  train loss: 0.16402296712462652 validation loss: 0.1765596730261616
epoch 184 time used: 5  seconds  train loss: 0.16358666430184193 validation loss: 0.177520544186906
epoch 185 time used: 5  seconds  train loss: 0.16345457294265137 validation loss: 0.17719477561291327
epoch 186 time used: 5  seconds  train loss: 0.1632796317290366 validation loss: 0.17691940521418675
epoch 187 time used: 5  seconds  train loss: 0.16323652761975438 validation loss: 0.17796188719566386
epoch 188 time used: 5  seconds  train loss: 0.16311882419273344 validation loss: 0.17815190529014066
epoch 189 time used: 5  seconds  train loss: 0.16356348677583119 validation loss: 0.17690621156625863
epoch 190 time used: 5  seconds  train loss: 0.16282514685912158 validation loss: 0.176391724409951
epoch 191 time used: 5  seconds  train loss: 0.16321678567243575 validation loss: 0.17660177341373864
epoch 192 time used: 6  seconds  train loss: 0.1625550016700104 validation loss: 0.17677275873869402
epoch 193 time used: 5  seconds  train loss: 0.16268025976229997 validation loss: 0.17651984869957787
epoch 194 time used: 5  seconds  train loss: 0.16242315003613486 validation loss: 0.1762537386712522
epoch 195 time used: 5  seconds  train loss: 0.16225680043858634 validation loss: 0.17699124289626608
epoch 196 time used: 5  seconds  train loss: 0.16214045218170028 validation loss: 0.1770707946196326
epoch 197 time used: 5  seconds  train loss: 0.1620435156152806 validation loss: 0.17652292076139128
epoch 198 time used: 5  seconds  train loss: 0.1620457378435446 validation loss: 0.17655146264785096
epoch 199 time used: 5  seconds  train loss: 0.16175826801064544 validation loss: 0.1756598218229928
YS.shape, YS_pred.shape, (14023, 1, 1, 69) (14023, 1, 1, 69)
YS.shape, YS_pred.shape, (14023, 69) (14023, 69)
****************************************
STGCN1, train, Torch MSE, 1.5990979921e-01, 0.1599097992

STGCN1, train, MSE, RMSE, MAE, MAPE, 391.6105136206, 19.7891514123, 11.0527740254, 16.1663445876

Model Training Ended ... Sun Jan  9 04:49:32 2022
pred_NYC-Taxi-inflow-final-test_STGCN1_2_2201090429 testing started Sun Jan  9 04:49:32 2022
getXSYS data.shape(17544, 69, 2)
getXSYS XS.shape(3509, 2, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
TEST XS.shape, YS.shape (3509, 2, 12, 69) (3509, 1, 1, 69)
Model Testing Started ... Sun Jan  9 04:49:32 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3509, 1, 1, 69) (3509, 1, 1, 69)
YS.shape, YS_pred.shape, (3509, 69) (3509, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
****************************************
STGCN1, test, Torch MSE, 1.7089564959e-01, 0.1708956496

STGCN1, test, MSE, RMSE, MAE, MAPE, 443.8770444608, 21.0683896979, 11.7477632707, 18.3362613671

Model Testing Ended ... Sun Jan  9 04:49:32 2022
pred_NYC-Taxi-inflow-final-test_STGCN2_2_2201090449 training started Sun Jan  9 04:49:32 2022
getXSYS data.shape(17544, 69, 2)
getXSYS XS.shape(14022, 2, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
TRAIN XS.shape YS,shape (14022, 2, 12, 69) (14022, 1, 1, 69)
Model Training Started ... Sun Jan  9 04:49:32 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          448
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 99,233
Trainable params: 99,233
Non-trainable params: 0
Total mult-adds (M): 15.41
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 2.16
Params size (MB): 0.38
Estimated Total Size (MB): 2.54
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.3849147617263096 validation loss: 0.3116910427519749
epoch 1 time used: 6  seconds  train loss: 0.299453231626972 validation loss: 0.27914171926443465
epoch 2 time used: 5  seconds  train loss: 0.28059104567139975 validation loss: 0.269633543997986
epoch 3 time used: 6  seconds  train loss: 0.2708841533899521 validation loss: 0.265695237902594
epoch 4 time used: 6  seconds  train loss: 0.2652465871855045 validation loss: 0.25249862109873544
epoch 5 time used: 6  seconds  train loss: 0.26159950930129366 validation loss: 0.2517341107589071
epoch 6 time used: 6  seconds  train loss: 0.2561405022017617 validation loss: 0.25168727881488157
epoch 7 time used: 6  seconds  train loss: 0.25307078119672516 validation loss: 0.24871770262344184
epoch 8 time used: 6  seconds  train loss: 0.25003487278710895 validation loss: 0.24927607374196725
epoch 9 time used: 6  seconds  train loss: 0.24735970351241096 validation loss: 0.24080552255944124
epoch 10 time used: 5  seconds  train loss: 0.24509692942418934 validation loss: 0.2451051251162683
epoch 11 time used: 5  seconds  train loss: 0.2429319190769132 validation loss: 0.23879421087958375
epoch 12 time used: 5  seconds  train loss: 0.2408475131488719 validation loss: 0.2349380955176563
epoch 13 time used: 5  seconds  train loss: 0.23960501297231077 validation loss: 0.23866185132802994
epoch 14 time used: 5  seconds  train loss: 0.2378690290863021 validation loss: 0.23393781683782272
epoch 15 time used: 5  seconds  train loss: 0.237547748447271 validation loss: 0.23518470817984544
epoch 16 time used: 5  seconds  train loss: 0.23477334770793698 validation loss: 0.231481098246384
epoch 17 time used: 5  seconds  train loss: 0.2342254447610544 validation loss: 0.2308402547598973
epoch 18 time used: 5  seconds  train loss: 0.23383275398522876 validation loss: 0.23423523235273444
epoch 19 time used: 5  seconds  train loss: 0.23194935025533572 validation loss: 0.2310411201686908
epoch 20 time used: 5  seconds  train loss: 0.23085177316016794 validation loss: 0.22749123534881519
epoch 21 time used: 5  seconds  train loss: 0.2304344326585631 validation loss: 0.22785140107307716
epoch 22 time used: 5  seconds  train loss: 0.22889662360258892 validation loss: 0.22576774399211186
epoch 23 time used: 5  seconds  train loss: 0.22770671576822638 validation loss: 0.22971799777564633
epoch 24 time used: 6  seconds  train loss: 0.22771787231097118 validation loss: 0.2251731580961655
epoch 25 time used: 6  seconds  train loss: 0.22586916817877614 validation loss: 0.22402978671052698
epoch 26 time used: 5  seconds  train loss: 0.2248777844098623 validation loss: 0.22653479772129537
epoch 27 time used: 5  seconds  train loss: 0.22500306873121767 validation loss: 0.22512322708462826
epoch 28 time used: 5  seconds  train loss: 0.22441948694630526 validation loss: 0.22148854497563003
epoch 29 time used: 5  seconds  train loss: 0.22263450343312122 validation loss: 0.22526712968086965
epoch 30 time used: 5  seconds  train loss: 0.2232155575370602 validation loss: 0.22123968371716624
epoch 31 time used: 5  seconds  train loss: 0.22106286768216027 validation loss: 0.22443841203103662
epoch 32 time used: 5  seconds  train loss: 0.22046326278756015 validation loss: 0.221003001331603
epoch 33 time used: 5  seconds  train loss: 0.22113575851633552 validation loss: 0.21931479271146412
epoch 34 time used: 5  seconds  train loss: 0.2195943372617268 validation loss: 0.21822432040556186
epoch 35 time used: 5  seconds  train loss: 0.21838605221112245 validation loss: 0.21907709073965984
epoch 36 time used: 5  seconds  train loss: 0.21776682650492024 validation loss: 0.22133927606577472
epoch 37 time used: 5  seconds  train loss: 0.2168863591012283 validation loss: 0.218352156974422
epoch 38 time used: 5  seconds  train loss: 0.21607998952091018 validation loss: 0.21709428379111337
epoch 39 time used: 5  seconds  train loss: 0.21588154601938073 validation loss: 0.21848413388999746
epoch 40 time used: 5  seconds  train loss: 0.21487105323405728 validation loss: 0.21667862734961904
epoch 41 time used: 5  seconds  train loss: 0.21468042136356022 validation loss: 0.2159708101478768
epoch 42 time used: 5  seconds  train loss: 0.2132062403764067 validation loss: 0.21553330787303987
epoch 43 time used: 5  seconds  train loss: 0.21231694766070927 validation loss: 0.21507427519685665
epoch 44 time used: 5  seconds  train loss: 0.21284297071363906 validation loss: 0.21517208058767434
epoch 45 time used: 5  seconds  train loss: 0.211335743832184 validation loss: 0.21512661042107356
epoch 46 time used: 5  seconds  train loss: 0.21089979917556714 validation loss: 0.21412736759720294
epoch 47 time used: 5  seconds  train loss: 0.2102007512572498 validation loss: 0.2173745270735593
epoch 48 time used: 5  seconds  train loss: 0.20889373320157958 validation loss: 0.21191635922541022
epoch 49 time used: 5  seconds  train loss: 0.2089219996562184 validation loss: 0.2127658093801853
epoch 50 time used: 5  seconds  train loss: 0.2090333384242401 validation loss: 0.21127947817274453
epoch 51 time used: 5  seconds  train loss: 0.20754920128374327 validation loss: 0.2103015448764196
epoch 52 time used: 5  seconds  train loss: 0.20648326265247402 validation loss: 0.20934046266831063
epoch 53 time used: 5  seconds  train loss: 0.20645445063485524 validation loss: 0.2108143554013318
epoch 54 time used: 5  seconds  train loss: 0.20572175564922557 validation loss: 0.21207646898079516
epoch 55 time used: 5  seconds  train loss: 0.20501583087234435 validation loss: 0.20961851821718255
epoch 56 time used: 5  seconds  train loss: 0.20457543873225323 validation loss: 0.2085631743744993
epoch 57 time used: 5  seconds  train loss: 0.20422531111999814 validation loss: 0.20960720095101318
epoch 58 time used: 5  seconds  train loss: 0.20278544759694983 validation loss: 0.20959670463427094
epoch 59 time used: 5  seconds  train loss: 0.20305803432612482 validation loss: 0.20866476506827833
epoch 60 time used: 5  seconds  train loss: 0.20199108363286103 validation loss: 0.21013569588737357
epoch 61 time used: 5  seconds  train loss: 0.201194369940626 validation loss: 0.20676039650619743
epoch 62 time used: 6  seconds  train loss: 0.20122586744894014 validation loss: 0.20697926165067462
epoch 63 time used: 5  seconds  train loss: 0.20006138280159164 validation loss: 0.20691230196104143
epoch 64 time used: 6  seconds  train loss: 0.20036813612987558 validation loss: 0.20539656955551164
epoch 65 time used: 6  seconds  train loss: 0.19908824994187257 validation loss: 0.20661847109768774
epoch 66 time used: 6  seconds  train loss: 0.19911791115442964 validation loss: 0.20494095499149678
epoch 67 time used: 5  seconds  train loss: 0.19864870434052612 validation loss: 0.2050292562975995
epoch 68 time used: 5  seconds  train loss: 0.19716135397090706 validation loss: 0.20518258285400057
epoch 69 time used: 6  seconds  train loss: 0.1975716837646229 validation loss: 0.2065043512899673
epoch 70 time used: 5  seconds  train loss: 0.19751560752024927 validation loss: 0.2046101313537009
epoch 71 time used: 5  seconds  train loss: 0.19639025474441926 validation loss: 0.2024638698533543
epoch 72 time used: 5  seconds  train loss: 0.1960765504209849 validation loss: 0.204048845455841
epoch 73 time used: 5  seconds  train loss: 0.19557733656345888 validation loss: 0.20197669004822758
epoch 74 time used: 5  seconds  train loss: 0.19546385096307586 validation loss: 0.20285994466447313
epoch 75 time used: 5  seconds  train loss: 0.19385535960743894 validation loss: 0.20351222796706697
epoch 76 time used: 5  seconds  train loss: 0.1942601726096731 validation loss: 0.2018408443304857
epoch 77 time used: 5  seconds  train loss: 0.19370991667604007 validation loss: 0.202034884794943
epoch 78 time used: 5  seconds  train loss: 0.19293857234737305 validation loss: 0.20216033113424395
epoch 79 time used: 5  seconds  train loss: 0.19260823363871687 validation loss: 0.2003244604475486
epoch 80 time used: 5  seconds  train loss: 0.19235318117478295 validation loss: 0.20070004203934297
epoch 81 time used: 5  seconds  train loss: 0.19245056541160943 validation loss: 0.20169587447788806
epoch 82 time used: 5  seconds  train loss: 0.19131846085515056 validation loss: 0.1987344357230224
epoch 83 time used: 5  seconds  train loss: 0.19061705641213486 validation loss: 0.20012381190887807
epoch 84 time used: 5  seconds  train loss: 0.19061622111393522 validation loss: 0.2000102564326981
epoch 85 time used: 5  seconds  train loss: 0.18999893926050643 validation loss: 0.1992647836311028
epoch 86 time used: 6  seconds  train loss: 0.19002095299528265 validation loss: 0.20049512269866854
epoch 87 time used: 5  seconds  train loss: 0.18955675225010496 validation loss: 0.19884930915718274
epoch 88 time used: 5  seconds  train loss: 0.1893933636300847 validation loss: 0.19939290708769272
epoch 89 time used: 5  seconds  train loss: 0.18938323017733538 validation loss: 0.1984681893146453
epoch 90 time used: 5  seconds  train loss: 0.18781306025174285 validation loss: 0.19871550316444753
epoch 91 time used: 5  seconds  train loss: 0.1876377539795898 validation loss: 0.19767902323979347
epoch 92 time used: 5  seconds  train loss: 0.18762681127925676 validation loss: 0.1986929644313596
epoch 93 time used: 5  seconds  train loss: 0.1875944264553143 validation loss: 0.1971883708180799
epoch 94 time used: 5  seconds  train loss: 0.18761082115883795 validation loss: 0.19676315099323946
epoch 95 time used: 5  seconds  train loss: 0.18659619257559704 validation loss: 0.19562169581362676
epoch 96 time used: 5  seconds  train loss: 0.18623736607254995 validation loss: 0.19759090071362356
epoch 97 time used: 5  seconds  train loss: 0.1857668141012272 validation loss: 0.1954988759208664
epoch 98 time used: 5  seconds  train loss: 0.1853880043855768 validation loss: 0.19550442561311715
epoch 99 time used: 5  seconds  train loss: 0.1852945531116098 validation loss: 0.1968819357484528
epoch 100 time used: 5  seconds  train loss: 0.18513808370350684 validation loss: 0.1958388766933698
epoch 101 time used: 5  seconds  train loss: 0.1848903731263464 validation loss: 0.19631039949226434
epoch 102 time used: 5  seconds  train loss: 0.1848516998593484 validation loss: 0.19473633766004309
epoch 103 time used: 5  seconds  train loss: 0.1835376567970386 validation loss: 0.1947652459722618
epoch 104 time used: 5  seconds  train loss: 0.18371584361461743 validation loss: 0.19587086183611352
epoch 105 time used: 5  seconds  train loss: 0.18359584173000726 validation loss: 0.19394296098285857
epoch 106 time used: 5  seconds  train loss: 0.18312835793437268 validation loss: 0.19473017860125352
epoch 107 time used: 6  seconds  train loss: 0.18304957350329923 validation loss: 0.19543866033698243
epoch 108 time used: 6  seconds  train loss: 0.1826287038737846 validation loss: 0.19352076129952772
epoch 109 time used: 5  seconds  train loss: 0.18201879216091627 validation loss: 0.19360310973198974
epoch 110 time used: 5  seconds  train loss: 0.18220878717164576 validation loss: 0.19405241429601747
epoch 111 time used: 5  seconds  train loss: 0.1819719765066605 validation loss: 0.1925887402404191
epoch 112 time used: 5  seconds  train loss: 0.1807936951961365 validation loss: 0.1938044760510096
epoch 113 time used: 5  seconds  train loss: 0.18123075417273687 validation loss: 0.19152808517506648
epoch 114 time used: 5  seconds  train loss: 0.18080074069202456 validation loss: 0.19245394565381801
epoch 115 time used: 5  seconds  train loss: 0.18036708020403155 validation loss: 0.19243555737439388
epoch 116 time used: 5  seconds  train loss: 0.18047220976907102 validation loss: 0.19261508660695925
epoch 117 time used: 5  seconds  train loss: 0.17991538324316436 validation loss: 0.19285763767842762
epoch 118 time used: 6  seconds  train loss: 0.1801613488347152 validation loss: 0.19185665454683615
epoch 119 time used: 5  seconds  train loss: 0.17932110380180036 validation loss: 0.19194473605018578
epoch 120 time used: 6  seconds  train loss: 0.17935167466411672 validation loss: 0.19282426289402277
epoch 121 time used: 6  seconds  train loss: 0.17926599415685177 validation loss: 0.19249411144055303
epoch 122 time used: 6  seconds  train loss: 0.17889851418671704 validation loss: 0.19127549527715562
epoch 123 time used: 5  seconds  train loss: 0.1785330700159209 validation loss: 0.1915389052116728
epoch 124 time used: 5  seconds  train loss: 0.1784280725257672 validation loss: 0.190415791924926
epoch 125 time used: 6  seconds  train loss: 0.17805543225035417 validation loss: 0.19136370043549208
epoch 126 time used: 5  seconds  train loss: 0.17757963616216044 validation loss: 0.19236186842917036
epoch 127 time used: 5  seconds  train loss: 0.17824035712793118 validation loss: 0.19292329783889817
epoch 128 time used: 5  seconds  train loss: 0.17810852853454542 validation loss: 0.19059109483796124
epoch 129 time used: 5  seconds  train loss: 0.17701168036716416 validation loss: 0.19042031415958643
epoch 130 time used: 6  seconds  train loss: 0.1768020076279594 validation loss: 0.19033449494661905
epoch 131 time used: 6  seconds  train loss: 0.17678218612252902 validation loss: 0.1905961669110191
epoch 132 time used: 5  seconds  train loss: 0.1766710839767854 validation loss: 0.18958511711424986
epoch 133 time used: 6  seconds  train loss: 0.17617488328732744 validation loss: 0.1895536996776964
epoch 134 time used: 6  seconds  train loss: 0.17641695306629335 validation loss: 0.1896864551258169
epoch 135 time used: 6  seconds  train loss: 0.17621685618200533 validation loss: 0.1887119013584483
epoch 136 time used: 5  seconds  train loss: 0.175776216384348 validation loss: 0.1905593121061989
epoch 137 time used: 6  seconds  train loss: 0.1756262473512448 validation loss: 0.1888260405555291
epoch 138 time used: 5  seconds  train loss: 0.17505541477710365 validation loss: 0.18915472807404116
epoch 139 time used: 6  seconds  train loss: 0.175213156246898 validation loss: 0.19004026238944147
epoch 140 time used: 5  seconds  train loss: 0.17524598924248344 validation loss: 0.1885766871167263
epoch 141 time used: 6  seconds  train loss: 0.1750661290885087 validation loss: 0.18820974084559808
epoch 142 time used: 6  seconds  train loss: 0.17444879515935335 validation loss: 0.18870302251047633
epoch 143 time used: 6  seconds  train loss: 0.17449821574767244 validation loss: 0.18792887702711772
epoch 144 time used: 5  seconds  train loss: 0.17417148896923798 validation loss: 0.18780922122125412
epoch 145 time used: 6  seconds  train loss: 0.17388719298678473 validation loss: 0.18744883804884355
epoch 146 time used: 6  seconds  train loss: 0.17410270635811972 validation loss: 0.1870781167177085
epoch 147 time used: 6  seconds  train loss: 0.17409206739905334 validation loss: 0.1876657336474281
epoch 148 time used: 5  seconds  train loss: 0.1736102343936724 validation loss: 0.1879666409047753
epoch 149 time used: 5  seconds  train loss: 0.17357239198573926 validation loss: 0.18887016600496212
epoch 150 time used: 5  seconds  train loss: 0.17309951677897786 validation loss: 0.18640887448261345
epoch 151 time used: 5  seconds  train loss: 0.17296440747554906 validation loss: 0.18741335486488483
epoch 152 time used: 6  seconds  train loss: 0.1727468430672874 validation loss: 0.1868931964949343
epoch 153 time used: 6  seconds  train loss: 0.1722679682818667 validation loss: 0.18704857346981646
epoch 154 time used: 5  seconds  train loss: 0.17291834107922385 validation loss: 0.1868786504624982
epoch 155 time used: 6  seconds  train loss: 0.17216267266525345 validation loss: 0.18679904792387692
epoch 156 time used: 6  seconds  train loss: 0.17192880141554354 validation loss: 0.18813840242467195
epoch 157 time used: 5  seconds  train loss: 0.17206682503097107 validation loss: 0.18763619058654435
epoch 158 time used: 5  seconds  train loss: 0.17215883584518638 validation loss: 0.1861116597041088
epoch 159 time used: 5  seconds  train loss: 0.1715959245116624 validation loss: 0.1855972973163374
epoch 160 time used: 5  seconds  train loss: 0.17156726964670072 validation loss: 0.1863037082581811
epoch 161 time used: 6  seconds  train loss: 0.1708949336235404 validation loss: 0.18550557669101275
epoch 162 time used: 6  seconds  train loss: 0.1712324589148391 validation loss: 0.1863434070086928
epoch 163 time used: 6  seconds  train loss: 0.1711070704869686 validation loss: 0.18688410645509135
epoch 164 time used: 6  seconds  train loss: 0.17123417694621684 validation loss: 0.1866452873467175
epoch 165 time used: 5  seconds  train loss: 0.1705154153758326 validation loss: 0.1856155072323472
epoch 166 time used: 5  seconds  train loss: 0.17125641252113463 validation loss: 0.18536448569652766
epoch 167 time used: 6  seconds  train loss: 0.1706711472305034 validation loss: 0.18634307814610052
epoch 168 time used: 6  seconds  train loss: 0.17055255700774508 validation loss: 0.1864018125052596
epoch 169 time used: 6  seconds  train loss: 0.17050980039263366 validation loss: 0.18703507628191965
epoch 170 time used: 6  seconds  train loss: 0.1700457287661574 validation loss: 0.1846854960279198
epoch 171 time used: 6  seconds  train loss: 0.1697894967955806 validation loss: 0.18578888671403604
epoch 172 time used: 5  seconds  train loss: 0.1696084265249731 validation loss: 0.18499908093479928
epoch 173 time used: 5  seconds  train loss: 0.16990216533647443 validation loss: 0.184558798654108
epoch 174 time used: 6  seconds  train loss: 0.1697494622263157 validation loss: 0.18454820844219946
epoch 175 time used: 6  seconds  train loss: 0.16963687698569427 validation loss: 0.18445996631572265
epoch 176 time used: 6  seconds  train loss: 0.16955609237645403 validation loss: 0.1830700769620967
epoch 177 time used: 5  seconds  train loss: 0.16948095546276706 validation loss: 0.1840298297452165
epoch 178 time used: 6  seconds  train loss: 0.1690153884539366 validation loss: 0.1840436624174994
epoch 179 time used: 6  seconds  train loss: 0.1686277698310394 validation loss: 0.18336058029330124
epoch 180 time used: 5  seconds  train loss: 0.16855706484624425 validation loss: 0.18619404775682885
epoch 181 time used: 5  seconds  train loss: 0.16971677172877733 validation loss: 0.18459294408270788
epoch 182 time used: 5  seconds  train loss: 0.16890976380452674 validation loss: 0.184171410089415
epoch 183 time used: 5  seconds  train loss: 0.16867789883117668 validation loss: 0.18346142616703112
epoch 184 time used: 5  seconds  train loss: 0.16835942523011524 validation loss: 0.18348482579281855
epoch 185 time used: 5  seconds  train loss: 0.168236837890195 validation loss: 0.18446600523018117
Early stopping at epoch: 186
YS.shape, YS_pred.shape, (14022, 1, 1, 69) (14022, 1, 1, 69)
YS.shape, YS_pred.shape, (14022, 69) (14022, 69)
****************************************
STGCN2, train, Torch MSE, 1.6614677514e-01, 0.1661467751

STGCN2, train, MSE, RMSE, MAE, MAPE, 442.5265907335, 21.0363159972, 11.5866581243, 16.7334067782

Model Training Ended ... Sun Jan  9 05:08:12 2022
pred_NYC-Taxi-inflow-final-test_STGCN2_2_2201090449 testing started Sun Jan  9 05:08:12 2022
getXSYS data.shape(17544, 69, 2)
getXSYS XS.shape(3508, 2, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
TEST XS.shape, YS.shape (3508, 2, 12, 69) (3508, 1, 1, 69)
Model Testing Started ... Sun Jan  9 05:08:12 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3508, 1, 1, 69) (3508, 1, 1, 69)
YS.shape, YS_pred.shape, (3508, 69) (3508, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
****************************************
STGCN2, test, Torch MSE, 1.7773384603e-01, 0.1777338460

STGCN2, test, MSE, RMSE, MAE, MAPE, 510.7488446444, 22.5997531987, 12.3800357167, 18.7446590080

Model Testing Ended ... Sun Jan  9 05:08:13 2022
pred_NYC-Taxi-inflow-final-test_STGCN3_2_2201090508 training started Sun Jan  9 05:08:13 2022
getXSYS data.shape(17544, 69, 2)
getXSYS XS.shape(14021, 2, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
TRAIN XS.shape YS,shape (14021, 2, 12, 69) (14021, 1, 1, 69)
Model Training Started ... Sun Jan  9 05:08:13 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          448
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 99,233
Trainable params: 99,233
Non-trainable params: 0
Total mult-adds (M): 15.41
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 2.16
Params size (MB): 0.38
Estimated Total Size (MB): 2.54
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.398777582715768 validation loss: 0.3152279766606931
epoch 1 time used: 6  seconds  train loss: 0.31372812007474016 validation loss: 0.2942034081602124
epoch 2 time used: 5  seconds  train loss: 0.2973004514536719 validation loss: 0.29829898209688804
epoch 3 time used: 5  seconds  train loss: 0.2864455697122132 validation loss: 0.27520831768266557
epoch 4 time used: 6  seconds  train loss: 0.27725059309027505 validation loss: 0.2728549509016501
epoch 5 time used: 6  seconds  train loss: 0.272720207083991 validation loss: 0.26023719797662104
epoch 6 time used: 6  seconds  train loss: 0.26720096043608343 validation loss: 0.25630464714660145
epoch 7 time used: 5  seconds  train loss: 0.26352723479698487 validation loss: 0.2541367968728185
epoch 8 time used: 5  seconds  train loss: 0.262430697086777 validation loss: 0.2551986971754247
epoch 9 time used: 6  seconds  train loss: 0.2577749541363966 validation loss: 0.2519802063601532
epoch 10 time used: 5  seconds  train loss: 0.2563850548899364 validation loss: 0.24582794164156002
epoch 11 time used: 6  seconds  train loss: 0.2538234143914794 validation loss: 0.2496606518694556
epoch 12 time used: 6  seconds  train loss: 0.25249707766841667 validation loss: 0.2510012449772101
epoch 13 time used: 6  seconds  train loss: 0.249972257293083 validation loss: 0.24445567621344236
epoch 14 time used: 5  seconds  train loss: 0.2490357532392778 validation loss: 0.2442509868504725
epoch 15 time used: 6  seconds  train loss: 0.24685712901551676 validation loss: 0.24126163262744257
epoch 16 time used: 6  seconds  train loss: 0.24531575810512815 validation loss: 0.24047922557650195
epoch 17 time used: 5  seconds  train loss: 0.24397429019786032 validation loss: 0.23999492285153692
epoch 18 time used: 6  seconds  train loss: 0.2424358333657454 validation loss: 0.24506460846796488
epoch 19 time used: 6  seconds  train loss: 0.24103380906822863 validation loss: 0.24141007945732057
epoch 20 time used: 6  seconds  train loss: 0.24134302213617984 validation loss: 0.24042379353737328
epoch 21 time used: 5  seconds  train loss: 0.24025284265476832 validation loss: 0.23525629265268938
epoch 22 time used: 6  seconds  train loss: 0.2384572422072986 validation loss: 0.23908396954374592
epoch 23 time used: 6  seconds  train loss: 0.23724706593401704 validation loss: 0.23556768171663497
epoch 24 time used: 5  seconds  train loss: 0.23576079854601403 validation loss: 0.2389467472324219
epoch 25 time used: 6  seconds  train loss: 0.2361081696738239 validation loss: 0.23367392511892782
epoch 26 time used: 6  seconds  train loss: 0.23443100970927147 validation loss: 0.2314911182954933
epoch 27 time used: 6  seconds  train loss: 0.23356717136479915 validation loss: 0.2293848314168993
epoch 28 time used: 5  seconds  train loss: 0.23390993026498477 validation loss: 0.23226612629512344
epoch 29 time used: 6  seconds  train loss: 0.2319796925303133 validation loss: 0.2271781181241877
epoch 30 time used: 6  seconds  train loss: 0.23087820835851247 validation loss: 0.22878993764579195
epoch 31 time used: 5  seconds  train loss: 0.23107627586118165 validation loss: 0.24322767726571234
epoch 32 time used: 6  seconds  train loss: 0.22994872909203234 validation loss: 0.23105377532622506
epoch 33 time used: 6  seconds  train loss: 0.22935914914577685 validation loss: 0.22904060163874662
epoch 34 time used: 6  seconds  train loss: 0.22773149509965537 validation loss: 0.22796451735176906
epoch 35 time used: 6  seconds  train loss: 0.22722530559817938 validation loss: 0.22744579670161297
epoch 36 time used: 6  seconds  train loss: 0.2262881101052303 validation loss: 0.22512221263261503
epoch 37 time used: 6  seconds  train loss: 0.22719735331301352 validation loss: 0.22518282294001365
epoch 38 time used: 5  seconds  train loss: 0.22468911263427324 validation loss: 0.22677836799648785
epoch 39 time used: 5  seconds  train loss: 0.22526984201956152 validation loss: 0.22485744001963312
epoch 40 time used: 5  seconds  train loss: 0.22314553723628333 validation loss: 0.22496091007880326
epoch 41 time used: 5  seconds  train loss: 0.22272302296813085 validation loss: 0.2239449220304141
epoch 42 time used: 5  seconds  train loss: 0.22227453391599392 validation loss: 0.22385978291562403
epoch 43 time used: 5  seconds  train loss: 0.22196253938864605 validation loss: 0.22374648404883032
epoch 44 time used: 5  seconds  train loss: 0.220774882253506 validation loss: 0.221241979261024
epoch 45 time used: 5  seconds  train loss: 0.21963417849752154 validation loss: 0.22293762989337962
epoch 46 time used: 5  seconds  train loss: 0.22000246369900903 validation loss: 0.22140117532786682
epoch 47 time used: 5  seconds  train loss: 0.21899645051390254 validation loss: 0.22157787363731854
epoch 48 time used: 5  seconds  train loss: 0.21831415300167925 validation loss: 0.2238458744879797
epoch 49 time used: 5  seconds  train loss: 0.21790304911187156 validation loss: 0.22093294277846712
epoch 50 time used: 5  seconds  train loss: 0.21689590400210568 validation loss: 0.21998148488440789
epoch 51 time used: 5  seconds  train loss: 0.21621989777277065 validation loss: 0.2200149022897039
epoch 52 time used: 5  seconds  train loss: 0.21562207510854586 validation loss: 0.221518592210885
epoch 53 time used: 6  seconds  train loss: 0.2154827250849746 validation loss: 0.21743265916399457
epoch 54 time used: 5  seconds  train loss: 0.21389917912217354 validation loss: 0.21704445163896272
epoch 55 time used: 6  seconds  train loss: 0.21362834150487217 validation loss: 0.21652315145584766
epoch 56 time used: 6  seconds  train loss: 0.21380943127455057 validation loss: 0.21681504668981363
epoch 57 time used: 5  seconds  train loss: 0.21251844862287114 validation loss: 0.21644819853853922
epoch 58 time used: 6  seconds  train loss: 0.21219833984237407 validation loss: 0.2158638855184206
epoch 59 time used: 6  seconds  train loss: 0.21170299991668923 validation loss: 0.2150280654464391
epoch 60 time used: 6  seconds  train loss: 0.21105717043360475 validation loss: 0.21775479561182273
epoch 61 time used: 5  seconds  train loss: 0.21060545386866167 validation loss: 0.2156197550598717
epoch 62 time used: 6  seconds  train loss: 0.20983213212500187 validation loss: 0.21736181316141803
epoch 63 time used: 6  seconds  train loss: 0.2087888650554844 validation loss: 0.21235046741864508
epoch 64 time used: 5  seconds  train loss: 0.20827934223178313 validation loss: 0.21386728942802274
epoch 65 time used: 5  seconds  train loss: 0.20735133662066788 validation loss: 0.2135760894059047
epoch 66 time used: 6  seconds  train loss: 0.2071040280632138 validation loss: 0.21150643921245252
epoch 67 time used: 5  seconds  train loss: 0.20609764075061573 validation loss: 0.21048084272871817
epoch 68 time used: 5  seconds  train loss: 0.20613749240736717 validation loss: 0.21120407266985397
epoch 69 time used: 6  seconds  train loss: 0.20490003598991807 validation loss: 0.21155573260219723
epoch 70 time used: 6  seconds  train loss: 0.2048432375977006 validation loss: 0.2102618061996363
epoch 71 time used: 5  seconds  train loss: 0.20472215011565273 validation loss: 0.2099534459730862
epoch 72 time used: 5  seconds  train loss: 0.20404442957258395 validation loss: 0.21117460856897383
epoch 73 time used: 6  seconds  train loss: 0.2034262689319386 validation loss: 0.21070260825289092
epoch 74 time used: 6  seconds  train loss: 0.2030703186707035 validation loss: 0.20910031118531672
epoch 75 time used: 5  seconds  train loss: 0.20219341649230232 validation loss: 0.20926453916943555
epoch 76 time used: 6  seconds  train loss: 0.2025452994070109 validation loss: 0.20896538045667473
epoch 77 time used: 6  seconds  train loss: 0.2009772549127965 validation loss: 0.20882752675433466
epoch 78 time used: 6  seconds  train loss: 0.20089046992325107 validation loss: 0.2070368417776182
epoch 79 time used: 5  seconds  train loss: 0.20021898181635897 validation loss: 0.20738860857670333
epoch 80 time used: 6  seconds  train loss: 0.1999023889908388 validation loss: 0.20549870525097344
epoch 81 time used: 6  seconds  train loss: 0.19941672273672556 validation loss: 0.2078906178423424
epoch 82 time used: 6  seconds  train loss: 0.1984607909697059 validation loss: 0.20599304117513126
epoch 83 time used: 5  seconds  train loss: 0.19835012103666264 validation loss: 0.21250056192763384
epoch 84 time used: 6  seconds  train loss: 0.19897276000825753 validation loss: 0.20507683205862964
epoch 85 time used: 6  seconds  train loss: 0.19783621921498884 validation loss: 0.20692092409762258
epoch 86 time used: 5  seconds  train loss: 0.19699526153308078 validation loss: 0.20385528467616829
epoch 87 time used: 5  seconds  train loss: 0.19645782365525316 validation loss: 0.20461126351043693
epoch 88 time used: 6  seconds  train loss: 0.1970622138447275 validation loss: 0.20309880183753598
epoch 89 time used: 6  seconds  train loss: 0.19681222592050804 validation loss: 0.20349019889959388
epoch 90 time used: 5  seconds  train loss: 0.19593797521595852 validation loss: 0.20301940341847186
epoch 91 time used: 6  seconds  train loss: 0.19452170336775101 validation loss: 0.20253678430371194
epoch 92 time used: 6  seconds  train loss: 0.19446368827896007 validation loss: 0.202654290474692
epoch 93 time used: 6  seconds  train loss: 0.19431303272447098 validation loss: 0.2018460965605375
epoch 94 time used: 5  seconds  train loss: 0.19407857048869095 validation loss: 0.2025196721519121
epoch 95 time used: 6  seconds  train loss: 0.1938124290061067 validation loss: 0.2009154603148758
epoch 96 time used: 6  seconds  train loss: 0.19312157086666065 validation loss: 0.20259780545984074
epoch 97 time used: 6  seconds  train loss: 0.19342725336998653 validation loss: 0.2011381727895666
epoch 98 time used: 5  seconds  train loss: 0.19240435047902926 validation loss: 0.20234797835452042
epoch 99 time used: 6  seconds  train loss: 0.19207540261345107 validation loss: 0.20084461279073174
epoch 100 time used: 6  seconds  train loss: 0.19141364414372428 validation loss: 0.20030771376946555
epoch 101 time used: 5  seconds  train loss: 0.19122073033907766 validation loss: 0.20131727221756068
epoch 102 time used: 5  seconds  train loss: 0.19130257958012448 validation loss: 0.20045681288428668
epoch 103 time used: 6  seconds  train loss: 0.19202957133497445 validation loss: 0.20042674787474304
epoch 104 time used: 6  seconds  train loss: 0.19029770998504678 validation loss: 0.1993958533439239
epoch 105 time used: 5  seconds  train loss: 0.18998891460631234 validation loss: 0.1996678895802071
epoch 106 time used: 6  seconds  train loss: 0.18960109087303015 validation loss: 0.19990814402826976
epoch 107 time used: 6  seconds  train loss: 0.18963081337436233 validation loss: 0.20083147598482579
epoch 108 time used: 5  seconds  train loss: 0.18874580346783948 validation loss: 0.1982670849262478
epoch 109 time used: 6  seconds  train loss: 0.18929098689346233 validation loss: 0.19888438642263004
epoch 110 time used: 6  seconds  train loss: 0.18880413031010584 validation loss: 0.19691418165726723
epoch 111 time used: 6  seconds  train loss: 0.18825401675732237 validation loss: 0.1988272502023835
epoch 112 time used: 6  seconds  train loss: 0.18795254356724297 validation loss: 0.19931544458702913
epoch 113 time used: 6  seconds  train loss: 0.1885956226564752 validation loss: 0.19793214309371954
epoch 114 time used: 6  seconds  train loss: 0.18816473765251962 validation loss: 0.19834021741978047
epoch 115 time used: 6  seconds  train loss: 0.18664648787358082 validation loss: 0.19789682893976102
epoch 116 time used: 5  seconds  train loss: 0.1866994339779607 validation loss: 0.19946818421788715
epoch 117 time used: 6  seconds  train loss: 0.18668382749675655 validation loss: 0.1963939404851426
epoch 118 time used: 6  seconds  train loss: 0.18635169025310133 validation loss: 0.19641403761239168
epoch 119 time used: 5  seconds  train loss: 0.1858307165890825 validation loss: 0.1956134085579049
epoch 120 time used: 5  seconds  train loss: 0.18591006077342598 validation loss: 0.1967189703593578
epoch 121 time used: 6  seconds  train loss: 0.18526249232434433 validation loss: 0.19636250225666654
epoch 122 time used: 6  seconds  train loss: 0.18569824396883738 validation loss: 0.1967593541467659
epoch 123 time used: 5  seconds  train loss: 0.18534600970836038 validation loss: 0.19601521927053697
epoch 124 time used: 6  seconds  train loss: 0.18526397043499607 validation loss: 0.19615751294938755
epoch 125 time used: 6  seconds  train loss: 0.18418484482152633 validation loss: 0.1946592768617038
epoch 126 time used: 5  seconds  train loss: 0.18433586407220826 validation loss: 0.19443837485684712
epoch 127 time used: 5  seconds  train loss: 0.183974819314336 validation loss: 0.19578244624243962
epoch 128 time used: 5  seconds  train loss: 0.18366438390903922 validation loss: 0.1945740024039083
epoch 129 time used: 5  seconds  train loss: 0.1833741822351957 validation loss: 0.19445114503298497
epoch 130 time used: 5  seconds  train loss: 0.1834339132604748 validation loss: 0.1938960098975465
epoch 131 time used: 5  seconds  train loss: 0.18323403242204178 validation loss: 0.19487331449747494
epoch 132 time used: 5  seconds  train loss: 0.18279159951859122 validation loss: 0.19709010769045154
epoch 133 time used: 5  seconds  train loss: 0.1842143142654797 validation loss: 0.19313979755791677
epoch 134 time used: 5  seconds  train loss: 0.18230044028931577 validation loss: 0.19529142962206586
epoch 135 time used: 5  seconds  train loss: 0.1824582487364176 validation loss: 0.195601208357558
epoch 136 time used: 6  seconds  train loss: 0.18205666649427094 validation loss: 0.193709758872722
epoch 137 time used: 6  seconds  train loss: 0.1821540942604471 validation loss: 0.19370830357414753
epoch 138 time used: 5  seconds  train loss: 0.18104825772036548 validation loss: 0.19390043342582716
epoch 139 time used: 6  seconds  train loss: 0.1815897284781929 validation loss: 0.19356125065312002
epoch 140 time used: 6  seconds  train loss: 0.18104830560133828 validation loss: 0.19282258696815863
epoch 141 time used: 5  seconds  train loss: 0.18095378242955365 validation loss: 0.1924910912650419
epoch 142 time used: 5  seconds  train loss: 0.18065846550336365 validation loss: 0.19496460008199598
epoch 143 time used: 5  seconds  train loss: 0.1807997332922908 validation loss: 0.19337723119831465
epoch 144 time used: 6  seconds  train loss: 0.18118642539242638 validation loss: 0.19163900895147273
epoch 145 time used: 5  seconds  train loss: 0.17973026296565384 validation loss: 0.19166350113923933
epoch 146 time used: 5  seconds  train loss: 0.1796182504122367 validation loss: 0.19310576291473266
epoch 147 time used: 5  seconds  train loss: 0.17941463926462697 validation loss: 0.1927673983203297
epoch 148 time used: 6  seconds  train loss: 0.17999000697696407 validation loss: 0.1938217802263299
epoch 149 time used: 6  seconds  train loss: 0.17948395972886225 validation loss: 0.19142971632824718
epoch 150 time used: 6  seconds  train loss: 0.1794639716066364 validation loss: 0.19284871942270707
epoch 151 time used: 6  seconds  train loss: 0.17933030855026003 validation loss: 0.1908844610791987
epoch 152 time used: 6  seconds  train loss: 0.17883352345000816 validation loss: 0.19119289928820904
epoch 153 time used: 5  seconds  train loss: 0.17840719461091226 validation loss: 0.19162434644686857
epoch 154 time used: 6  seconds  train loss: 0.17862475060235028 validation loss: 0.19074120829429073
epoch 155 time used: 5  seconds  train loss: 0.17838971237134266 validation loss: 0.19164159551424362
epoch 156 time used: 5  seconds  train loss: 0.17789787796447748 validation loss: 0.1909327314060481
epoch 157 time used: 5  seconds  train loss: 0.17804470672392092 validation loss: 0.19087308856057766
epoch 158 time used: 5  seconds  train loss: 0.17773744024708016 validation loss: 0.19125691652127966
epoch 159 time used: 6  seconds  train loss: 0.1774159969842741 validation loss: 0.19032177430217903
epoch 160 time used: 5  seconds  train loss: 0.17825101555501516 validation loss: 0.1888118311295289
epoch 161 time used: 6  seconds  train loss: 0.17670094223045005 validation loss: 0.19077044648914696
epoch 162 time used: 6  seconds  train loss: 0.17672097560031663 validation loss: 0.19120692935625078
epoch 163 time used: 6  seconds  train loss: 0.17744571879083418 validation loss: 0.18989604517723993
epoch 164 time used: 5  seconds  train loss: 0.17676042718008125 validation loss: 0.19057626023472068
epoch 165 time used: 5  seconds  train loss: 0.1764858984183441 validation loss: 0.18938678921255056
epoch 166 time used: 5  seconds  train loss: 0.1771864758948375 validation loss: 0.19082404516692578
epoch 167 time used: 5  seconds  train loss: 0.1763077117854934 validation loss: 0.1899701765330941
epoch 168 time used: 5  seconds  train loss: 0.17611215114204823 validation loss: 0.18911816494266306
epoch 169 time used: 6  seconds  train loss: 0.17618309474453928 validation loss: 0.1908267180170254
Early stopping at epoch: 170
YS.shape, YS_pred.shape, (14021, 1, 1, 69) (14021, 1, 1, 69)
YS.shape, YS_pred.shape, (14021, 69) (14021, 69)
****************************************
STGCN3, train, Torch MSE, 1.7360754531e-01, 0.1736075453

STGCN3, train, MSE, RMSE, MAE, MAPE, 486.5164069396, 22.0571169227, 12.0674392532, 16.9405111569

Model Training Ended ... Sun Jan  9 05:25:19 2022
pred_NYC-Taxi-inflow-final-test_STGCN3_2_2201090508 testing started Sun Jan  9 05:25:19 2022
getXSYS data.shape(17544, 69, 2)
getXSYS XS.shape(3507, 2, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
TEST XS.shape, YS.shape (3507, 2, 12, 69) (3507, 1, 1, 69)
Model Testing Started ... Sun Jan  9 05:25:19 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3507, 1, 1, 69) (3507, 1, 1, 69)
YS.shape, YS_pred.shape, (3507, 69) (3507, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
****************************************
STGCN3, test, Torch MSE, 1.8473527967e-01, 0.1847352797

STGCN3, test, MSE, RMSE, MAE, MAPE, 578.1900571706, 24.0455829035, 13.0699985437, 19.6709630739

Model Testing Ended ... Sun Jan  9 05:25:19 2022
