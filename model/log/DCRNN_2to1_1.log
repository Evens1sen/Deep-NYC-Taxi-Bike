data.shape (17544, 69, 2)
pred_NYC-Taxi_DCRNN_2201081052 training started Sat Jan  8 10:52:47 2022
TRAIN XS.shape YS,shape (14021, 12, 69, 2) (14021, 3, 69, 1)
Model Training Started ... Sat Jan  8 10:52:47 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 69, 64]           --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 69, 64]              38,208
|    |    └─DCGRU_Cell: 3-2              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 69, 64]              73,920
|    |    └─DCGRU_Cell: 3-14             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 69, 64]              (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 69, 1]               --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 69, 64]              37,632
|    |    └─DCGRU_Cell: 3-26             [-1, 69, 64]              73,920
|    └─Linear: 2-1                       [-1, 69, 1]               65
├─DCGRU_Decoder: 1-3                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 69, 64]              (recursive)
|    └─Linear: 2-2                       [-1, 69, 1]               (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 69, 64]              (recursive)
|    └─Linear: 2-3                       [-1, 69, 1]               (recursive)
==========================================================================================
Total params: 223,745
Trainable params: 223,745
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.40
Params size (MB): 0.85
Estimated Total Size (MB): 1.26
==========================================================================================
XS_torch.shape:   torch.Size([14021, 12, 69, 2])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 22  seconds  train loss: 0.31635559827604315 validation loss: 0.3769550477343155
epoch 1 time used: 21  seconds  train loss: 0.2449064373260684 validation loss: 0.34591492187684425
epoch 2 time used: 21  seconds  train loss: 0.22800571902162833 validation loss: 0.36360918950232113
epoch 3 time used: 22  seconds  train loss: 0.21447757456389707 validation loss: 0.34911390581405716
epoch 4 time used: 22  seconds  train loss: 0.20788768770487176 validation loss: 0.36131986450346554
epoch 5 time used: 19  seconds  train loss: 0.2020762012861511 validation loss: 0.323072666824034
epoch 6 time used: 19  seconds  train loss: 0.19924228068260172 validation loss: 0.34826649777289465
epoch 7 time used: 19  seconds  train loss: 0.19569578490371536 validation loss: 0.32779581609346226
epoch 8 time used: 19  seconds  train loss: 0.19196967826260392 validation loss: 0.3260854255690686
epoch 9 time used: 19  seconds  train loss: 0.19058188106129836 validation loss: 0.33807107423688776
epoch 10 time used: 19  seconds  train loss: 0.18787936052962784 validation loss: 0.32523562322666627
epoch 11 time used: 19  seconds  train loss: 0.1867805568323409 validation loss: 0.32329223136254465
epoch 12 time used: 19  seconds  train loss: 0.1846587430159821 validation loss: 0.32627359149936125
epoch 13 time used: 19  seconds  train loss: 0.18357163098257218 validation loss: 0.32789952317714965
epoch 14 time used: 19  seconds  train loss: 0.18120045824881909 validation loss: 0.31141392129255036
epoch 15 time used: 19  seconds  train loss: 0.18027115395316326 validation loss: 0.32163370804860125
epoch 16 time used: 20  seconds  train loss: 0.17896207506799683 validation loss: 0.3232483794297481
epoch 17 time used: 19  seconds  train loss: 0.17878034616142444 validation loss: 0.31137009392584386
epoch 18 time used: 21  seconds  train loss: 0.17681453005086725 validation loss: 0.32413795024275577
epoch 19 time used: 21  seconds  train loss: 0.17503573053875068 validation loss: 0.31870852377641834
epoch 20 time used: 21  seconds  train loss: 0.17519500722393835 validation loss: 0.3239238861623112
epoch 21 time used: 21  seconds  train loss: 0.17392257906868203 validation loss: 0.3211690444675637
epoch 22 time used: 19  seconds  train loss: 0.17315161055701542 validation loss: 0.31936076652371265
epoch 23 time used: 19  seconds  train loss: 0.17184146829641794 validation loss: 0.31207651205900666
epoch 24 time used: 19  seconds  train loss: 0.17110850079696266 validation loss: 0.3262300477222382
epoch 25 time used: 19  seconds  train loss: 0.1700459917904618 validation loss: 0.31038840187323546
epoch 26 time used: 19  seconds  train loss: 0.16974715637313376 validation loss: 0.30871495341003385
epoch 27 time used: 19  seconds  train loss: 0.16886523539424525 validation loss: 0.3250777805728771
epoch 28 time used: 19  seconds  train loss: 0.16867562835501038 validation loss: 0.31797802738985603
epoch 29 time used: 19  seconds  train loss: 0.168102079011891 validation loss: 0.3232442666072541
epoch 30 time used: 19  seconds  train loss: 0.16707866909276944 validation loss: 0.3073232349197455
epoch 31 time used: 20  seconds  train loss: 0.1662848749610085 validation loss: 0.3129754824870937
epoch 32 time used: 19  seconds  train loss: 0.16579703855463998 validation loss: 0.32845673231961586
epoch 33 time used: 19  seconds  train loss: 0.16509011202714402 validation loss: 0.3133428801962531
epoch 34 time used: 19  seconds  train loss: 0.16420200263536594 validation loss: 0.31289600254941247
epoch 35 time used: 19  seconds  train loss: 0.16393928530066962 validation loss: 0.3091671661146015
epoch 36 time used: 19  seconds  train loss: 0.1636061026776385 validation loss: 0.33012940145123704
epoch 37 time used: 19  seconds  train loss:/home/cseadmin/mhy/model/DCRNN.py:309: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(rowsum, -0.5).flatten()
 0.16282645284274444 validation loss: 0.3174534274113226
epoch 38 time used: 19  seconds  train loss: 0.16251984739540687 validation loss: 0.31367917001009393
epoch 39 time used: 19  seconds  train loss: 0.16122820235868987 validation loss: 0.3250308490894348
Early stopping at epoch: 40
YS.shape, YS_pred.shape, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
DCRNN, train, Torch MSE, 1.5949047190e-01, 0.1594904719
DCRNN, train, MSE, RMSE, MAE, MAPE, 142.5862065591, 11.9409466358, 6.7393825166, 42.9287555996
Model Training Ended ... Sat Jan  8 11:06:54 2022
pred_NYC-Taxi_DCRNN_2201081052 testing started Sat Jan  8 11:06:54 2022
TEST XS.shape, YS.shape (3507, 12, 69, 2) (3507, 3, 69, 1)
Model Testing Started ... Sat Jan  8 11:06:54 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
DCRNN, test, Torch MSE, 3.3636220996e-01, 0.3363622100
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 247.0836370173, 15.7188942683, 9.2742552340, 51.5505105594
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 142.0537569428, 11.9186306656, 7.3706599996, 43.1966987223
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 262.7522421632, 16.2096342390, 9.5446833858, 51.8589297346
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 336.4479717238, 18.3425181402, 10.9074773678, 59.5961481342
Model Testing Ended ... Sat Jan  8 11:06:56 2022
