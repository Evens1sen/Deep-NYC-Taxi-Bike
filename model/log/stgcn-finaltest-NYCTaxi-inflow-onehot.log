nohup: ignoring input
../data-NYCTaxi/60min/taxi-timestamp-inflow.h5
Namespace(addtime=True, adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=4, dataname='finaltest-NYCTaxi-inflow-onehot', datatype=0, epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/60min/taxi-timestamp-inflow.h5', gpu=6, graphnum=1, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
timestamp shape is (17544, 69, 32)
data.shape (17544, 69)
pred_finaltest-NYCTaxi-inflow-onehot_STGCN1_1_2201090634 training started Sun Jan  9 06:34:38 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14023, 1, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape is (14023, 1, 12, 69)
YS shape is (14023, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14023, 32, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape after is (14023, 33, 12, 69)
YS shape after is (14023, 1, 1, 69)
TRAIN XS.shape YS,shape (14023, 33, 12, 69) (14023, 1, 1, 69)
Model Training Started ... Sun Jan  9 06:34:44 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 6  seconds  train loss: 0.3375461208208266 validation loss: 0.26384427380167413
epoch 1 time used: 6  seconds  train loss: 0.26808685646274755 validation loss: 0.2550670979231069
epoch 2 time used: 6  seconds  train loss: 0.25583889515738034 validation loss: 0.24673576696355617
epoch 3 time used: 7  seconds  train loss: 0.24946390912604702 validation loss: 0.2420912403772711
epoch 4 time used: 7  seconds  train loss: 0.24588447738781924 validation loss: 0.23750773317903637
epoch 5 time used: 7  seconds  train loss: 0.24174252912438587 validation loss: 0.2630709600462209
epoch 6 time used: 7  seconds  train loss: 0.23893536268061705 validation loss: 0.23877204004282007
epoch 7 time used: 7  seconds  train loss: 0.23621141471169105 validation loss: 0.23595430411683174
epoch 8 time used: 7  seconds  train loss: 0.23477909558413956 validation loss: 0.23707988566660024
epoch 9 time used: 7  seconds  train loss: 0.23381024642795106 validation loss: 0.24658402904264598
epoch 10 time used: 7  seconds  train loss: 0.23326827357382723 validation loss: 0.23534686592260362
epoch 11 time used: 7  seconds  train loss: 0.2309326560592496 validation loss: 0.23548769263186187
epoch 12 time used: 7  seconds  train loss: 0.2300600817704842 validation loss: 0.23660032752066154
epoch 13 time used: 7  seconds  train loss: 0.229864428535456 validation loss: 0.2290907481858476
epoch 14 time used: 7  seconds  train loss: 0.22803668603483215 validation loss: 0.22910417324804402
epoch 15 time used: 7  seconds  train loss: 0.2262243169371248 validation loss: 0.22993989480065402
epoch 16 time used: 7  seconds  train loss: 0.22698385131582557 validation loss: 0.22568877468908846
epoch 17 time used: 6  seconds  train loss: 0.22548188642213862 validation loss: 0.22936681464645975
epoch 18 time used: 6  seconds  train loss: 0.22543134385478525 validation loss: 0.22882230741360224
epoch 19 time used: 6  seconds  train loss: 0.22464400223337155 validation loss: 0.2252626131414619
epoch 20 time used: 6  seconds  train loss: 0.22462245363380817 validation loss: 0.23032376502523133
epoch 21 time used: 6  seconds  train loss: 0.22436483920397754 validation loss: 0.22424410440822498
epoch 22 time used: 6  seconds  train loss: 0.2229990883702268 validation loss: 0.22507299676631018
epoch 23 time used: 6  seconds  train loss: 0.2227072903681501 validation loss: 0.22802952105361124
epoch 24 time used: 6  seconds  train loss: 0.22140391571500384 validation loss: 0.22189698885558878
epoch 25 time used: 6  seconds  train loss: 0.22128888203200034 validation loss: 0.22252913092247636
epoch 26 time used: 6  seconds  train loss: 0.2214690608349678 validation loss: 0.22367000120813615
epoch 27 time used: 6  seconds  train loss: 0.22071654028346505 validation loss: 0.22400135773457736
epoch 28 time used: 6  seconds  train loss: 0.2197983743436179 validation loss: 0.2241191205404448
epoch 29 time used: 6  seconds  train loss: 0.21995007892935473 validation loss: 0.2209284630966948
epoch 30 time used: 6  seconds  train loss: 0.21868122036902032 validation loss: 0.22033844073024125
epoch 31 time used: 6  seconds  train loss: 0.21965974316231682 validation loss: 0.2216236716974686
epoch 32 time used: 6  seconds  train loss: 0.2180844712932613 validation loss: 0.22033835067724541
epoch 33 time used: 6  seconds  train loss: 0.2183057509186604 validation loss: 0.22188662770334408
epoch 34 time used: 6  seconds  train loss: 0.21757000183175032 validation loss: 0.22043304800715233
epoch 35 time used: 6  seconds  train loss: 0.2164516656425005 validation loss: 0.2217962184227064
epoch 36 time used: 6  seconds  train loss: 0.21618319724328944 validation loss: 0.22060295176111624
epoch 37 time used: 6  seconds  train loss: 0.21625574229204664 validation loss: 0.22089692393474014
epoch 38 time used: 6  seconds  train loss: 0.2157997896152487 validation loss: 0.21867696452977245
epoch 39 time used: 6  seconds  train loss: 0.21503277550942546 validation loss: 0.2197715403672565
epoch 40 time used: 6  seconds  train loss: 0.214757585578948 validation loss: 0.22063782481350222
epoch 41 time used: 6  seconds  train loss: 0.21440769299172538 validation loss: 0.2172492584261429
epoch 42 time used: 6  seconds  train loss: 0.21404159115209945 validation loss: 0.2197834165842276
epoch 43 time used: 6  seconds  train loss: 0.21353800910560697 validation loss: 0.21876546385216156
epoch 44 time used: 6  seconds  train loss: 0.21283762670185086 validation loss: 0.2232459276591582
epoch 45 time used: 6  seconds  train loss: 0.21280291491197975 validation loss: 0.21707064503271514
epoch 46 time used: 6  seconds  train loss: 0.21181720987314506 validation loss: 0.2193662611692209
epoch 47 time used: 6  seconds  train loss: 0.21212587503028674 validation loss: 0.21469510834997746
epoch 48 time used: 6  seconds  train loss: 0.21188432983052177 validation loss: 0.21739015442197554
epoch 49 time used: 6  seconds  train loss: 0.21076435234698224 validation loss: 0.21721627045140154
epoch 50 time used: 6  seconds  train loss: 0.2102135365803065 validation loss: 0.21528564963045627
epoch 51 time used: 6  seconds  train loss: 0.2095935520668193 validation loss: 0.21632401136861007
epoch 52 time used: 6  seconds  train loss: 0.20934305906344353 validation loss: 0.21559168857400648
epoch 53 time used: 6  seconds  train loss: 0.20900200468403785 validation loss: 0.21556346954037242
epoch 54 time used: 6  seconds  train loss: 0.2089139580046538 validation loss: 0.21660605299085192
epoch 55 time used: 6  seconds  train loss: 0.20809679330609732 validation loss: 0.21456920321981907
epoch 56 time used: 6  seconds  train loss: 0.20747658891122128 validation loss: 0.21610473120171753
epoch 57 time used: 6  seconds  train loss: 0.20667981117259415 validation loss: 0.21315009262958937
epoch 58 time used: 6  seconds  train loss: 0.20672207614368993 validation loss: 0.21714162648880203
epoch 59 time used: 6  seconds  train loss: 0.20652739599942188 validation loss: 0.2139090304111523
epoch 60 time used: 6  seconds  train loss: 0.20546481029085736 validation loss: 0.21372184589190682
epoch 61 time used: 6  seconds  train loss: 0.2047690602075597 validation loss: 0.21361400651986165
epoch 62 time used: 6  seconds  train loss: 0.20487933471228112 validation loss: 0.21477293442877374
epoch 63 time used: 6  seconds  train loss: 0.2047360092450082 validation loss: 0.21429781276569052
epoch 64 time used: 6  seconds  train loss: 0.20375384697121338 validation loss: 0.21151450388579796
epoch 65 time used: 6  seconds  train loss: 0.2035627800415664 validation loss: 0.21134401115770007
epoch 66 time used: 6  seconds  train loss: 0.2028388030371631 validation loss: 0.2118311308481594
epoch 67 time used: 6  seconds  train loss: 0.2018784065482669 validation loss: 0.211474150954759
epoch 68 time used: 6  seconds  train loss: 0.2017169311241882 validation loss: 0.21227742941530514
epoch 69 time used: 6  seconds  train loss: 0.2013329763599985 validation loss: 0.21090711795188874
epoch 70 time used: 6  seconds  train loss: 0.20068537853263507 validation loss: 0.20947972116848435
epoch 71 time used: 6  seconds  train loss: 0.2007209597002129 validation loss: 0.2111999346862435
epoch 72 time used: 6  seconds  train loss: 0.2000508922770826 validation loss: 0.21095048562669783
epoch 73 time used: 6  seconds  train loss: 0.19985823139924777 validation loss: 0.20870506039226117
epoch 74 time used: 6  seconds  train loss: 0.1987489069319393 validation loss: 0.20901653650856944
epoch 75 time used: 6  seconds  train loss: 0.1984647309940427 validation loss: 0.21000158368555125
epoch 76 time used: 6  seconds  train loss: 0.1985281188675516 validation loss: 0.21023794847152197
epoch 77 time used: 6  seconds  train loss: 0.19758554084959706 validation loss: 0.2125014106562936
epoch 78 time used: 6  seconds  train loss: 0.19693419911459198 validation loss: 0.2100305948183323
epoch 79 time used: 6  seconds  train loss: 0.19668213111312777 validation loss: 0.2086016067643201
epoch 80 time used: 6  seconds  train loss: 0.19612440908936435 validation loss: 0.20823948785739155
epoch 81 time used: 6  seconds  train loss: 0.19614888832835328 validation loss: 0.20783154056096717
epoch 82 time used: 6  seconds  train loss: 0.19500344898415078 validation loss: 0.20773280131871266
epoch 83 time used: 6  seconds  train loss: 0.19519114193142967 validation loss: 0.20757280340279025
epoch 84 time used: 6  seconds  train loss: 0.19524658723341903 validation loss: 0.20617014075338808
epoch 85 time used: 6  seconds  train loss: 0.19438750454100925 validation loss: 0.20803724433344836
epoch 86 time used: 6  seconds  train loss: 0.19376616437889835 validation loss: 0.20691569411305788
epoch 87 time used: 6  seconds  train loss: 0.19356830254646462 validation loss: 0.20749477433498695
epoch 88 time used: 6  seconds  train loss: 0.19293860263375606 validation loss: 0.20539058398091992
epoch 89 time used: 6  seconds  train loss: 0.1931861121380533 validation loss: 0.20766995581163383
epoch 90 time used: 6  seconds  train loss: 0.19249951060506126 validation loss: 0.20626623511178385
epoch 91 time used: 6  seconds  train loss: 0.19282760032328922 validation loss: 0.20531965669773677
epoch 92 time used: 6  seconds  train loss: 0.19121918913398997 validation loss: 0.2060342195012946
epoch 93 time used: 6  seconds  train loss: 0.19106105844616988 validation loss: 0.20485081908298913
epoch 94 time used: 6  seconds  train loss: 0.1907785033757063 validation loss: 0.2062882545398292
epoch 95 time used: 6  seconds  train loss: 0.19040105458722428 validation loss: 0.20396816235777315
epoch 96 time used: 6  seconds  train loss: 0.19035474451314946 validation loss: 0.2046445262173687
epoch 97 time used: 6  seconds  train loss: 0.18984520640816258 validation loss: 0.20385771394795985
epoch 98 time used: 6  seconds  train loss: 0.18949738066421842 validation loss: 0.20420924574561752
epoch 99 time used: 6  seconds  train loss: 0.188893671320431 validation loss: 0.20334362856197954
epoch 100 time used: 6  seconds  train loss: 0.1889044757941533 validation loss: 0.20379945013567985
epoch 101 time used: 6  seconds  train loss: 0.18877727033990907 validation loss: 0.20428886105180535
epoch 102 time used: 6  seconds  train loss: 0.1884322445229388 validation loss: 0.20519326003326802
epoch 103 time used: 6  seconds  train loss: 0.18815646970184624 validation loss: 0.20191224114900308
epoch 104 time used: 6  seconds  train loss: 0.18739394954092248 validation loss: 0.20300819298504286
epoch 105 time used: 6  seconds  train loss: 0.18744704143099408 validation loss: 0.2033146518047238
epoch 106 time used: 6  seconds  train loss: 0.18672845712889474 validation loss: 0.2013548728964768
epoch 107 time used: 6  seconds  train loss: 0.18695442195140743 validation loss: 0.20396936556066164
epoch 108 time used: 6  seconds  train loss: 0.18613295945192412 validation loss: 0.2011160980240658
epoch 109 time used: 6  seconds  train loss: 0.18640912889025515 validation loss: 0.20446223777087158
epoch 110 time used: 6  seconds  train loss: 0.18583316211546935 validation loss: 0.20267832765426896
epoch 111 time used: 6  seconds  train loss: 0.18589021967209346 validation loss: 0.2023266207233403
epoch 112 time used: 6  seconds  train loss: 0.18483120461207828 validation loss: 0.20185634323820276
epoch 113 time used: 6  seconds  train loss: 0.1851745790354877 validation loss: 0.20144501166111117
epoch 114 time used: 6  seconds  train loss: 0.18521109504629754 validation loss: 0.20181413168269297
epoch 115 time used: 6  seconds  train loss: 0.18439953485541744 validation loss: 0.20127626173984509
epoch 116 time used: 6  seconds  train loss: 0.18440287431858376 validation loss: 0.2012342435339146
epoch 117 time used: 6  seconds  train loss: 0.1836570465938775 validation loss: 0.20014443232784662
epoch 118 time used: 6  seconds  train loss: 0.184010328190931 validation loss: 0.20074844658714802
epoch 119 time used: 6  seconds  train loss: 0.18330175902606416 validation loss: 0.20073792408924407
epoch 120 time used: 6  seconds  train loss: 0.18313672069669645 validation loss: 0.19981001496859027
epoch 121 time used: 6  seconds  train loss: 0.18255411435796073 validation loss: 0.19911581496306985
epoch 122 time used: 6  seconds  train loss: 0.18224112757260758 validation loss: 0.19985857036408872
epoch 123 time used: 6  seconds  train loss: 0.18238833936473267 validation loss: 0.20112070748109648
epoch 124 time used: 6  seconds  train loss: 0.18229306582862415 validation loss: 0.1996900939849602
epoch 125 time used: 6  seconds  train loss: 0.1821506602281269 validation loss: 0.19826060748583102
epoch 126 time used: 6  seconds  train loss: 0.181744540833125 validation loss: 0.20072639904835532
epoch 127 time used: 6  seconds  train loss: 0.18142004886728627 validation loss: 0.19939910318262566
epoch 128 time used: 6  seconds  train loss: 0.1810069438832119 validation loss: 0.19873643594677626
epoch 129 time used: 6  seconds  train loss: 0.18072297248834504 validation loss: 0.1980985244018856
epoch 130 time used: 6  seconds  train loss: 0.1806033332219625 validation loss: 0.19856817817184766
epoch 131 time used: 6  seconds  train loss: 0.18061510452237087 validation loss: 0.19710736683927396
epoch 132 time used: 6  seconds  train loss: 0.18055295832485518 validation loss: 0.1985618472864338
epoch 133 time used: 6  seconds  train loss: 0.17977251603580047 validation loss: 0.19807263216799623
epoch 134 time used: 6  seconds  train loss: 0.1798711659200034 validation loss: 0.19779884196388606
epoch 135 time used: 6  seconds  train loss: 0.17995493508687133 validation loss: 0.19725325828576457
epoch 136 time used: 6  seconds  train loss: 0.179603912027366 validation loss: 0.19786538437850396
epoch 137 time used: 6  seconds  train loss: 0.1790756335031141 validation loss: 0.19831913387476208
epoch 138 time used: 6  seconds  train loss: 0.1787831820432209 validation loss: 0.19924722137583098
epoch 139 time used: 6  seconds  train loss: 0.17927818358090222 validation loss: 0.1982946691772153
epoch 140 time used: 6  seconds  train loss: 0.1788968788431054 validation loss: 0.19646096151349754
epoch 141 time used: 6  seconds  train loss: 0.17833844650151193 validation loss: 0.19591193844676358
epoch 142 time used: 6  seconds  train loss: 0.1781728004257953 validation loss: 0.1966735520025559
epoch 143 time used: 6  seconds  train loss: 0.17804308100842614 validation loss: 0.19686948855264624
epoch 144 time used: 6  seconds  train loss: 0.17806982591371762 validation loss: 0.19566963497428166
epoch 145 time used: 6  seconds  train loss: 0.17742214117141497 validation loss: 0.19596204688667368
epoch 146 time used: 6  seconds  train loss: 0.17782192249655626 validation loss: 0.19595047091152487
epoch 147 time used: 6  seconds  train loss: 0.1772202860172337 validation loss: 0.1978905167041747
epoch 148 time used: 6  seconds  train loss: 0.17691801494957474 validation loss: 0.1954995850733329
epoch 149 time used: 6  seconds  train loss: 0.1767902468483722 validation loss: 0.19596594759925595
epoch 150 time used: 6  seconds  train loss: 0.1766708631314392 validation loss: 0.1956377526435999
epoch 151 time used: 6  seconds  train loss: 0.17665589635898743 validation loss: 0.19552232914153195
epoch 152 time used: 6  seconds  train loss: 0.17607703504760575 validation loss: 0.1949845116970135
epoch 153 time used: 6  seconds  train loss: 0.17606258551425435 validation loss: 0.1948181076078366
epoch 154 time used: 6  seconds  train loss: 0.17599874714233085 validation loss: 0.1962950214939123
epoch 155 time used: 6  seconds  train loss: 0.1757434807614573 validation loss: 0.19395677993553267
epoch 156 time used: 6  seconds  train loss: 0.17562641492925626 validation loss: 0.19384954172716234
epoch 157 time used: 6  seconds  train loss: 0.175390902205318 validation loss: 0.19461414240049893
epoch 158 time used: 6  seconds  train loss: 0.1752805615549857 validation loss: 0.1937392924896867
epoch 159 time used: 6  seconds  train loss: 0.17539229215211566 validation loss: 0.19604479004265035
epoch 160 time used: 6  seconds  train loss: 0.17538787068490974 validation loss: 0.19417145698667593
epoch 161 time used: 6  seconds  train loss: 0.17484348974484396 validation loss: 0.19338242594881597
epoch 162 time used: 6  seconds  train loss: 0.17449516044852204 validation loss: 0.1941961443941048
epoch 163 time used: 6  seconds  train loss: 0.1741379673585915 validation loss: 0.19325210232260018
epoch 164 time used: 6  seconds  train loss: 0.17424340937909016 validation loss: 0.19445244294707598
epoch 165 time used: 6  seconds  train loss: 0.17463455390619279 validation loss: 0.1934670029081621
epoch 166 time used: 6  seconds  train loss: 0.17369061675417588 validation loss: 0.19275998061919172
epoch 167 time used: 6  seconds  train loss: 0.1738093453252228 validation loss: 0.19341225222526653
epoch 168 time used: 6  seconds  train loss: 0.17372737941988717 validation loss: 0.19341207525591406
epoch 169 time used: 6  seconds  train loss: 0.17396284886366387 validation loss: 0.19232409140142928
epoch 170 time used: 6  seconds  train loss: 0.17336431964685398 validation loss: 0.1950126547712771
epoch 171 time used: 6  seconds  train loss: 0.1734690765564094 validation loss: 0.19358275264620578
epoch 172 time used: 6  seconds  train loss: 0.17317182181711205 validation loss: 0.19348675028739218
epoch 173 time used: 6  seconds  train loss: 0.17255148278471893 validation loss: 0.19187553896777507
epoch 174 time used: 6  seconds  train loss: 0.1728998617710092 validation loss: 0.1918387754740065
epoch 175 time used: 6  seconds  train loss: 0.17240307287365417 validation loss: 0.19257869787781973
epoch 176 time used: 6  seconds  train loss: 0.17250964470335206 validation loss: 0.19227970778704098
epoch 177 time used: 6  seconds  train loss: 0.1722161648835996 validation loss: 0.19350780847578544
epoch 178 time used: 6  seconds  train loss: 0.1722615137344079 validation loss: 0.19174478364990427
epoch 179 time used: 6  seconds  train loss: 0.17223571109499694 validation loss: 0.19222616706483375
epoch 180 time used: 6  seconds  train loss: 0.17198911207715184 validation loss: 0.1926125063174667
epoch 181 time used: 6  seconds  train loss: 0.1718521330423635 validation loss: 0.19226263549350972
epoch 182 time used: 6  seconds  train loss: 0.171533204825214 validation loss: 0.19281140053979479
epoch 183 time used: 6  seconds  train loss: 0.17148367092195524 validation loss: 0.19146343852306733
epoch 184 time used: 6  seconds  train loss: 0.1715552412307447 validation loss: 0.19250489125337453
epoch 185 time used: 6  seconds  train loss: 0.17166567752540063 validation loss: 0.1926558915030528
epoch 186 time used: 6  seconds  train loss: 0.1709499100576889 validation loss: 0.19164861672378852
epoch 187 time used: 6  seconds  train loss: 0.17081894368151873 validation loss: 0.19128531192923978
epoch 188 time used: 6  seconds  train loss: 0.1706883372479371 validation loss: 0.19190907728243609
epoch 189 time used: 6  seconds  train loss: 0.17112357467048617 validation loss: 0.19158601550054905
epoch 190 time used: 6  seconds  train loss: 0.17065350135701793 validation loss: 0.19057020505054026
epoch 191 time used: 6  seconds  train loss: 0.1703034207382723 validation loss: 0.19082663273274117
epoch 192 time used: 6  seconds  train loss: 0.17032228469265703 validation loss: 0.191247872485478
epoch 193 time used: 6  seconds  train loss: 0.17015834156341833 validation loss: 0.19127355391001333
epoch 194 time used: 6  seconds  train loss: 0.1703519725590677 validation loss: 0.19041811535002093
epoch 195 time used: 6  seconds  train loss: 0.1700192701481374 validation loss: 0.19090487102032797
epoch 196 time used: 6  seconds  train loss: 0.16943661333004828 validation loss: 0.19079127747095861
epoch 197 time used: 6  seconds  train loss: 0.16968770854193307 validation loss: 0.19037140983210518
epoch 198 time used: 6  seconds  train loss: 0.16962158555360762 validation loss: 0.1899628761541619
epoch 199 time used: 6  seconds  train loss: 0.16981074408777574 validation loss: 0.19023389476779115
YS.shape, YS_pred.shape, (14023, 1, 1, 69) (14023, 1, 1, 69)
YS.shape, YS_pred.shape, (14023, 69) (14023, 69)
****************************************
STGCN1, train, Torch MSE, 1.6702224896e-01, 0.1670222490

STGCN1, train, MSE, RMSE, MAE, MAPE, 443.2786832539, 21.0541844595, 11.6315208297, 16.6165025106

Model Training Ended ... Sun Jan  9 06:57:44 2022
pred_finaltest-NYCTaxi-inflow-onehot_STGCN1_1_2201090634 testing started Sun Jan  9 06:57:44 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape is (3509, 1, 12, 69)
YS shape is (3509, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3509, 32, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape after is (3509, 33, 12, 69)
YS shape after is (3509, 1, 1, 69)
TEST XS.shape, YS.shape (3509, 33, 12, 69) (3509, 1, 1, 69)
Model Testing Started ... Sun Jan  9 06:57:44 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3509, 1, 1, 69) (3509, 1, 1, 69)
YS.shape, YS_pred.shape, (3509, 69) (3509, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
****************************************
STGCN1, test, Torch MSE, 1.8556074153e-01, 0.1855607415

STGCN1, test, MSE, RMSE, MAE, MAPE, 514.5769717444, 22.6842890950, 12.6720876380, 20.2612649845

Model Testing Ended ... Sun Jan  9 06:57:45 2022
pred_finaltest-NYCTaxi-inflow-onehot_STGCN2_33_2201090657 training started Sun Jan  9 06:57:45 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14022, 1, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape is (14022, 1, 12, 69)
YS shape is (14022, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14022, 32, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape after is (14022, 33, 12, 69)
YS shape after is (14022, 1, 1, 69)
TRAIN XS.shape YS,shape (14022, 33, 12, 69) (14022, 1, 1, 69)
Model Training Started ... Sun Jan  9 06:57:47 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 6  seconds  train loss: 0.3940123660886615 validation loss: 0.328314161205455
epoch 1 time used: 6  seconds  train loss: 0.30248460556672013 validation loss: 0.2969132407488173
epoch 2 time used: 6  seconds  train loss: 0.28282204116359494 validation loss: 0.2890961273221105
epoch 3 time used: 6  seconds  train loss: 0.2706659509705413 validation loss: 0.27199312957844185
epoch 4 time used: 6  seconds  train loss: 0.2656541029382271 validation loss: 0.27304845257820026
epoch 5 time used: 6  seconds  train loss: 0.2625848911110546 validation loss: 0.27241420441536107
epoch 6 time used: 6  seconds  train loss: 0.25837557226825103 validation loss: 0.27550821107452556
epoch 7 time used: 6  seconds  train loss: 0.2544887705754414 validation loss: 0.2545358518396727
epoch 8 time used: 6  seconds  train loss: 0.2521677393767136 validation loss: 0.2577648985168285
epoch 9 time used: 6  seconds  train loss: 0.2523559020996599 validation loss: 0.26226362198404224
epoch 10 time used: 6  seconds  train loss: 0.2485002873676293 validation loss: 0.25643938155903245
epoch 11 time used: 6  seconds  train loss: 0.2462625194476669 validation loss: 0.25486225018960984
epoch 12 time used: 6  seconds  train loss: 0.24480958952643544 validation loss: 0.2578880322775158
epoch 13 time used: 6  seconds  train loss: 0.24462485304913764 validation loss: 0.25163398333705633
epoch 14 time used: 6  seconds  train loss: 0.24368718385997618 validation loss: 0.24975312951287065
epoch 15 time used: 6  seconds  train loss: 0.24287157882439478 validation loss: 0.2468509227292441
epoch 16 time used: 6  seconds  train loss: 0.24107610659894096 validation loss: 0.2499091147322418
epoch 17 time used: 6  seconds  train loss: 0.24097829374938423 validation loss: 0.24933121326611646
epoch 18 time used: 6  seconds  train loss: 0.2397718688917778 validation loss: 0.24317858711998597
epoch 19 time used: 6  seconds  train loss: 0.23988303302751796 validation loss: 0.24495716421045172
epoch 20 time used: 6  seconds  train loss: 0.23932272196058949 validation loss: 0.24508460569878135
epoch 21 time used: 6  seconds  train loss: 0.2373516655658605 validation loss: 0.2446820556573438
epoch 22 time used: 6  seconds  train loss: 0.236935415395908 validation loss: 0.24630417413393293
epoch 23 time used: 6  seconds  train loss: 0.23660387350077033 validation loss: 0.2457100710594103
epoch 24 time used: 6  seconds  train loss: 0.2363468165166979 validation loss: 0.24001201502745043
epoch 25 time used: 6  seconds  train loss: 0.23543893691306883 validation loss: 0.24350038207366137
epoch 26 time used: 6  seconds  train loss: 0.2349830000331946 validation loss: 0.24332661760138977
epoch 27 time used: 6  seconds  train loss: 0.23409691070522168 validation loss: 0.24184017622056037
epoch 28 time used: 6  seconds  train loss: 0.2330533997947832 validation loss: 0.2423029794940524
epoch 29 time used: 6  seconds  train loss: 0.23362658996241573 validation loss: 0.24058429987785548
epoch 30 time used: 6  seconds  train loss: 0.2323808302306266 validation loss: 0.23919371691045255
epoch 31 time used: 6  seconds  train loss: 0.23188881947952647 validation loss: 0.23789063476013309
epoch 32 time used: 6  seconds  train loss: 0.23086721028585153 validation loss: 0.2410135800693624
epoch 33 time used: 6  seconds  train loss: 0.2308209334623941 validation loss: 0.23756134896807446
epoch 34 time used: 6  seconds  train loss: 0.23034484816851908 validation loss: 0.23500309590435137
epoch 35 time used: 6  seconds  train loss: 0.2286996721337191 validation loss: 0.23581993561163672
epoch 36 time used: 6  seconds  train loss: 0.2292603379804257 validation loss: 0.2393777572251835
epoch 37 time used: 6  seconds  train loss: 0.22826431730390323 validation loss: 0.23334023047023955
epoch 38 time used: 6  seconds  train loss: 0.22783148192899794 validation loss: 0.23385944146465318
epoch 39 time used: 6  seconds  train loss: 0.2274480352304376 validation loss: 0.2367431011733095
epoch 40 time used: 6  seconds  train loss: 0.22749112247181888 validation loss: 0.24028229908948617
epoch 41 time used: 6  seconds  train loss: 0.22662679874738628 validation loss: 0.2341343352472313
epoch 42 time used: 6  seconds  train loss: 0.2261188049432613 validation loss: 0.2395592921047434
epoch 43 time used: 6  seconds  train loss: 0.22555951282232622 validation loss: 0.23463660566145803
epoch 44 time used: 6  seconds  train loss: 0.2247230195165487 validation loss: 0.23245713515956268
epoch 45 time used: 6  seconds  train loss: 0.22477123392576576 validation loss: 0.23342148938385746
epoch 46 time used: 6  seconds  train loss: 0.22526235687420804 validation loss: 0.2335723372132725
epoch 47 time used: 6  seconds  train loss: 0.22317027248674756 validation loss: 0.23555172603264987
epoch 48 time used: 6  seconds  train loss: 0.22331768196576848 validation loss: 0.23359199488802224
epoch 49 time used: 6  seconds  train loss: 0.2226228789424185 validation loss: 0.2331690248920111
epoch 50 time used: 6  seconds  train loss: 0.2223030946403681 validation loss: 0.23271669233212522
epoch 51 time used: 6  seconds  train loss: 0.22249547883106702 validation loss: 0.2317475635224727
epoch 52 time used: 6  seconds  train loss: 0.22140296028600714 validation loss: 0.23136758500857824
epoch 53 time used: 6  seconds  train loss: 0.2211412832630381 validation loss: 0.23131726125411423
epoch 54 time used: 6  seconds  train loss: 0.221029526971014 validation loss: 0.238163284103121
epoch 55 time used: 6  seconds  train loss: 0.21955006474343478 validation loss: 0.23322855515848617
epoch 56 time used: 6  seconds  train loss: 0.21958623764319432 validation loss: 0.23337704550179494
epoch 57 time used: 6  seconds  train loss: 0.2191656693088677 validation loss: 0.23058438342738274
epoch 58 time used: 6  seconds  train loss: 0.21894346068633955 validation loss: 0.22892850819343985
epoch 59 time used: 6  seconds  train loss: 0.21850422379857648 validation loss: 0.23023982783827315
epoch 60 time used: 6  seconds  train loss: 0.21778141839505796 validation loss: 0.23187679839487832
epoch 61 time used: 6  seconds  train loss: 0.21736760799056384 validation loss: 0.23064799395140687
epoch 62 time used: 6  seconds  train loss: 0.21718345031935327 validation loss: 0.228861890303973
epoch 63 time used: 6  seconds  train loss: 0.2168698825986007 validation loss: 0.2305862579815604
epoch 64 time used: 6  seconds  train loss: 0.21667167423396988 validation loss: 0.23430967067420924
epoch 65 time used: 6  seconds  train loss: 0.21577064862887893 validation loss: 0.23054428763275342
epoch 66 time used: 6  seconds  train loss: 0.21495129623606635 validation loss: 0.2301037821151567
epoch 67 time used: 6  seconds  train loss: 0.2145408945903091 validation loss: 0.23160903636074992
epoch 68 time used: 6  seconds  train loss: 0.21412133879407577 validation loss: 0.23001534535554363
epoch 69 time used: 6  seconds  train loss: 0.21447191053477832 validation loss: 0.22839673263851193
epoch 70 time used: 6  seconds  train loss: 0.21431144500057606 validation loss: 0.22841692630454463
epoch 71 time used: 6  seconds  train loss: 0.21400353999920624 validation loss: 0.23000457565817095
epoch 72 time used: 6  seconds  train loss: 0.212969431766419 validation loss: 0.2300977974246042
epoch 73 time used: 6  seconds  train loss: 0.21282603508909792 validation loss: 0.2299932511326795
epoch 74 time used: 6  seconds  train loss: 0.2119722986779515 validation loss: 0.22774567835445209
epoch 75 time used: 6  seconds  train loss: 0.21180210152439174 validation loss: 0.22769539144062276
epoch 76 time used: 6  seconds  train loss: 0.21150507595323587 validation loss: 0.22825868421803183
epoch 77 time used: 6  seconds  train loss: 0.21066037009150818 validation loss: 0.22882534412234698
epoch 78 time used: 6  seconds  train loss: 0.21039849148688394 validation loss: 0.22618212587855166
epoch 79 time used: 6  seconds  train loss: 0.21064086920091465 validation loss: 0.22501800750332837
epoch 80 time used: 6  seconds  train loss: 0.20974790905427307 validation loss: 0.22622808364378813
epoch 81 time used: 6  seconds  train loss: 0.20915340863508916 validation loss: 0.22408687951934725
epoch 82 time used: 6  seconds  train loss: 0.20879912921974075 validation loss: 0.22675060509309317
epoch 83 time used: 6  seconds  train loss: 0.20875464215217607 validation loss: 0.22676411983426883
epoch 84 time used: 6  seconds  train loss: 0.2079899091477285 validation loss: 0.22414319479016664
epoch 85 time used: 6  seconds  train loss: 0.2079020482249244 validation loss: 0.22589292328356336
epoch 86 time used: 6  seconds  train loss: 0.20787226448981935 validation loss: 0.2254570993401973
epoch 87 time used: 6  seconds  train loss: 0.20663517808887952 validation loss: 0.22529684689748103
epoch 88 time used: 6  seconds  train loss: 0.2062829862036675 validation loss: 0.22319479469428793
epoch 89 time used: 6  seconds  train loss: 0.20570140920487737 validation loss: 0.2235588606211096
epoch 90 time used: 6  seconds  train loss: 0.20585352283680738 validation loss: 0.22398304594154705
epoch 91 time used: 6  seconds  train loss: 0.20499923231355116 validation loss: 0.22397053202628
epoch 92 time used: 6  seconds  train loss: 0.20443788842210872 validation loss: 0.2230235420749722
epoch 93 time used: 6  seconds  train loss: 0.20448922095365615 validation loss: 0.22485388094571
epoch 94 time used: 6  seconds  train loss: 0.20405985077097497 validation loss: 0.2227640168383267
epoch 95 time used: 6  seconds  train loss: 0.20424517185863494 validation loss: 0.22257628347522793
epoch 96 time used: 6  seconds  train loss: 0.20278418319291772 validation loss: 0.22240313132762637
epoch 97 time used: 6  seconds  train loss: 0.20295034836722972 validation loss: 0.2214273190794165
epoch 98 time used: 6  seconds  train loss: 0.20288209266015103 validation loss: 0.22155971109391076
epoch 99 time used: 6  seconds  train loss: 0.20272418541569748 validation loss: 0.22041161216400176
epoch 100 time used: 6  seconds  train loss: 0.20190612812556813 validation loss: 0.2213942242294329
epoch 101 time used: 6  seconds  train loss: 0.20177756970368307 validation loss: 0.22282846261791278
epoch 102 time used: 6  seconds  train loss: 0.20142699611081075 validation loss: 0.2215771797005272
epoch 103 time used: 6  seconds  train loss: 0.20066333869231515 validation loss: 0.2227186629313846
epoch 104 time used: 6  seconds  train loss: 0.20096660197164953 validation loss: 0.22015780194344278
epoch 105 time used: 6  seconds  train loss: 0.2001023263854127 validation loss: 0.21814843532839165
epoch 106 time used: 6  seconds  train loss: 0.20005391371994422 validation loss: 0.22211418521451867
epoch 107 time used: 7  seconds  train loss: 0.19908834479725518 validation loss: 0.2214784209074052
epoch 108 time used: 7  seconds  train loss: 0.19951917085581317 validation loss: 0.21970172376035624
epoch 109 time used: 6  seconds  train loss: 0.19898260158347525 validation loss: 0.22224977531741838
epoch 110 time used: 6  seconds  train loss: 0.19893395657090085 validation loss: 0.2176944848067136
epoch 111 time used: 6  seconds  train loss: 0.19865228160055898 validation loss: 0.22101337996912357
epoch 112 time used: 6  seconds  train loss: 0.19839891825836556 validation loss: 0.22073630697884972
epoch 113 time used: 6  seconds  train loss: 0.1977778076214646 validation loss: 0.21996795522507026
epoch 114 time used: 6  seconds  train loss: 0.19788083465197082 validation loss: 0.21890056191922866
epoch 115 time used: 6  seconds  train loss: 0.19742464886355665 validation loss: 0.21802701565176164
epoch 116 time used: 6  seconds  train loss: 0.19674701982988727 validation loss: 0.21650045273716084
epoch 117 time used: 6  seconds  train loss: 0.19670579626601215 validation loss: 0.21715847241728903
epoch 118 time used: 6  seconds  train loss: 0.19686598812968295 validation loss: 0.21939524906197072
epoch 119 time used: 6  seconds  train loss: 0.19657045453167435 validation loss: 0.21689283070024326
epoch 120 time used: 6  seconds  train loss: 0.19634695954141704 validation loss: 0.2165289282951774
epoch 121 time used: 6  seconds  train loss: 0.1956138739908749 validation loss: 0.21725100357907878
epoch 122 time used: 6  seconds  train loss: 0.19563022399212954 validation loss: 0.2174482895640462
epoch 123 time used: 6  seconds  train loss: 0.19476061474966996 validation loss: 0.21774662968198435
epoch 124 time used: 6  seconds  train loss: 0.19534244866566064 validation loss: 0.21716553919735596
epoch 125 time used: 6  seconds  train loss: 0.19446792210316308 validation loss: 0.2152426684677975
epoch 126 time used: 6  seconds  train loss: 0.1941260761431138 validation loss: 0.21639724953033146
epoch 127 time used: 6  seconds  train loss: 0.194042703718717 validation loss: 0.21651019775656652
epoch 128 time used: 6  seconds  train loss: 0.19340268048041898 validation loss: 0.2172350019675558
epoch 129 time used: 6  seconds  train loss: 0.19339598523408397 validation loss: 0.21578760100852676
epoch 130 time used: 6  seconds  train loss: 0.19310042191755608 validation loss: 0.2168013197367217
epoch 131 time used: 6  seconds  train loss: 0.19306313723255286 validation loss: 0.21656580007525084
epoch 132 time used: 6  seconds  train loss: 0.19276375649698071 validation loss: 0.21518920612756823
epoch 133 time used: 6  seconds  train loss: 0.19242465009640944 validation loss: 0.216096259377306
epoch 134 time used: 6  seconds  train loss: 0.19213142672249872 validation loss: 0.21534186266723934
epoch 135 time used: 6  seconds  train loss: 0.19153413370133845 validation loss: 0.216400225002359
epoch 136 time used: 6  seconds  train loss: 0.19162851247998125 validation loss: 0.2157726923585006
epoch 137 time used: 6  seconds  train loss: 0.19181564083109276 validation loss: 0.2174836504275773
epoch 138 time used: 6  seconds  train loss: 0.19124986254889084 validation loss: 0.2155790070908041
epoch 139 time used: 6  seconds  train loss: 0.19087433449183733 validation loss: 0.21438692596831868
epoch 140 time used: 6  seconds  train loss: 0.19125929468272124 validation loss: 0.21369526385240942
epoch 141 time used: 6  seconds  train loss: 0.19065209313023498 validation loss: 0.21430373215634552
epoch 142 time used: 6  seconds  train loss: 0.18987134626723218 validation loss: 0.21371634950552135
epoch 143 time used: 6  seconds  train loss: 0.19005509821124353 validation loss: 0.21379829502860545
epoch 144 time used: 6  seconds  train loss: 0.18988897825294995 validation loss: 0.21357345545353104
epoch 145 time used: 6  seconds  train loss: 0.18975058780103007 validation loss: 0.21327874521765788
epoch 146 time used: 6  seconds  train loss: 0.18949423924820843 validation loss: 0.2114140224317381
epoch 147 time used: 6  seconds  train loss: 0.18918361367422615 validation loss: 0.2143286195351475
epoch 148 time used: 6  seconds  train loss: 0.18947480083707008 validation loss: 0.21436625150395203
epoch 149 time used: 6  seconds  train loss: 0.18878065658131596 validation loss: 0.21429449660704603
epoch 150 time used: 6  seconds  train loss: 0.1887876595744625 validation loss: 0.21321806638871882
epoch 151 time used: 6  seconds  train loss: 0.18854487083784885 validation loss: 0.21287422975301062
epoch 152 time used: 6  seconds  train loss: 0.18832178645237355 validation loss: 0.21321493548729456
epoch 153 time used: 6  seconds  train loss: 0.187927128697765 validation loss: 0.21402273767006716
epoch 154 time used: 6  seconds  train loss: 0.1878835295142322 validation loss: 0.21436252855975765
epoch 155 time used: 6  seconds  train loss: 0.18736652380505442 validation loss: 0.21207889246382988
Early stopping at epoch: 156
YS.shape, YS_pred.shape, (14022, 1, 1, 69) (14022, 1, 1, 69)
YS.shape, YS_pred.shape, (14022, 69) (14022, 69)
****************************************
STGCN2, train, Torch MSE, 1.8496656206e-01, 0.1849665621

STGCN2, train, MSE, RMSE, MAE, MAPE, 533.1192765692, 23.0893758376, 12.7228544518, 18.0240216942

Model Training Ended ... Sun Jan  9 07:15:44 2022
pred_finaltest-NYCTaxi-inflow-onehot_STGCN2_33_2201090657 testing started Sun Jan  9 07:15:44 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape is (3508, 1, 12, 69)
YS shape is (3508, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3508, 32, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape after is (3508, 33, 12, 69)
YS shape after is (3508, 1, 1, 69)
TEST XS.shape, YS.shape (3508, 33, 12, 69) (3508, 1, 1, 69)
Model Testing Started ... Sun Jan  9 07:15:45 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3508, 1, 1, 69) (3508, 1, 1, 69)
YS.shape, YS_pred.shape, (3508, 69) (3508, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
****************************************
STGCN2, test, Torch MSE, 2.0610395932e-01, 0.2061039593

STGCN2, test, MSE, RMSE, MAE, MAPE, 689.0274734978, 26.2493328201, 14.2583107678, 20.6400262406

Model Testing Ended ... Sun Jan  9 07:15:46 2022
pred_finaltest-NYCTaxi-inflow-onehot_STGCN3_33_2201090715 training started Sun Jan  9 07:15:46 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14021, 1, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape is (14021, 1, 12, 69)
YS shape is (14021, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14021, 32, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape after is (14021, 33, 12, 69)
YS shape after is (14021, 1, 1, 69)
TRAIN XS.shape YS,shape (14021, 33, 12, 69) (14021, 1, 1, 69)
Model Training Started ... Sun Jan  9 07:15:48 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 6  seconds  train loss: 0.42177092049539305 validation loss: 0.36840962967529883
epoch 1 time used: 6  seconds  train loss: 0.3163778495722498 validation loss: 0.3159373970250708
epoch 2 time used: 6  seconds  train loss: 0.295845711604368 validation loss: 0.3098699447942746
epoch 3 time used: 6  seconds  train loss: 0.28701507547681404 validation loss: 0.29568832515990195
epoch 4 time used: 6  seconds  train loss: 0.2800359420252422 validation loss: 0.289951052994845
epoch 5 time used: 6  seconds  train loss: 0.2743099369752434 validation loss: 0.29256385080282576
epoch 6 time used: 6  seconds  train loss: 0.2710328170131463 validation loss: 0.29529113798092516
epoch 7 time used: 6  seconds  train loss: 0.2686104435542915 validation loss: 0.274621510634882
epoch 8 time used: 6  seconds  train loss: 0.26447349755177874 validation loss: 0.2838918608270641
epoch 9 time used: 6  seconds  train loss: 0.26206868908325237 validation loss: 0.27575434289587886
epoch 10 time used: 6  seconds  train loss: 0.2608036592160602 validation loss: 0.2766109938221663
epoch 11 time used: 6  seconds  train loss: 0.25857803704569926 validation loss: 0.2710964864091199
epoch 12 time used: 6  seconds  train loss: 0.2585735923650407 validation loss: 0.27117299445343235
epoch 13 time used: 6  seconds  train loss: 0.25621699430789396 validation loss: 0.2795851269553065
epoch 14 time used: 6  seconds  train loss: 0.2543815170606962 validation loss: 0.26911051624921545
epoch 15 time used: 6  seconds  train loss: 0.2527323476569366 validation loss: 0.2651173241534236
epoch 16 time used: 6  seconds  train loss: 0.251193328180879 validation loss: 0.26968303021878703
epoch 17 time used: 6  seconds  train loss: 0.25010126495365215 validation loss: 0.2681272372611917
epoch 18 time used: 6  seconds  train loss: 0.24991671981506797 validation loss: 0.26854019908312043
epoch 19 time used: 6  seconds  train loss: 0.2496608509559137 validation loss: 0.2710093032341308
epoch 20 time used: 6  seconds  train loss: 0.2466942009142256 validation loss: 0.262808254257448
epoch 21 time used: 6  seconds  train loss: 0.2458676322444394 validation loss: 0.2590455533910056
epoch 22 time used: 6  seconds  train loss: 0.24475451935122758 validation loss: 0.26182830889634384
epoch 23 time used: 6  seconds  train loss: 0.24385232122491693 validation loss: 0.25539063157793185
epoch 24 time used: 6  seconds  train loss: 0.2430300099339748 validation loss: 0.2567031934168838
epoch 25 time used: 6  seconds  train loss: 0.2431338992507908 validation loss: 0.2595738504895876
epoch 26 time used: 6  seconds  train loss: 0.24283290090100712 validation loss: 0.2596303136499691
epoch 27 time used: 6  seconds  train loss: 0.24088282522663138 validation loss: 0.2559518824627382
epoch 28 time used: 6  seconds  train loss: 0.24026343721032803 validation loss: 0.257919466587318
epoch 29 time used: 6  seconds  train loss: 0.24001605663950218 validation loss: 0.2533798433172995
epoch 30 time used: 6  seconds  train loss: 0.23942649981506803 validation loss: 0.25480988202643134
epoch 31 time used: 7  seconds  train loss: 0.23821455528847277 validation loss: 0.2591402306260209
epoch 32 time used: 7  seconds  train loss: 0.23897201701255352 validation loss: 0.2581020885036118
epoch 33 time used: 7  seconds  train loss: 0.2379902882066036 validation loss: 0.2526381582922753
epoch 34 time used: 6  seconds  train loss: 0.2366187928562099 validation loss: 0.2579407775769285
epoch 35 time used: 6  seconds  train loss: 0.23586505114604644 validation loss: 0.2485301474707506
epoch 36 time used: 6  seconds  train loss: 0.23552736376157443 validation loss: 0.25041385410652117
epoch 37 time used: 6  seconds  train loss: 0.23507282005718333 validation loss: 0.2530822917878526
epoch 38 time used: 6  seconds  train loss: 0.23431070982185528 validation loss: 0.25012647175680075
epoch 39 time used: 6  seconds  train loss: 0.23388986657778993 validation loss: 0.25175232540112663
epoch 40 time used: 6  seconds  train loss: 0.23339504890695317 validation loss: 0.253943940553404
epoch 41 time used: 6  seconds  train loss: 0.2324986883336183 validation loss: 0.24789601090086302
epoch 42 time used: 6  seconds  train loss: 0.2322203056758648 validation loss: 0.24900716501545783
epoch 43 time used: 6  seconds  train loss: 0.23242350384218902 validation loss: 0.24746879303686564
epoch 44 time used: 6  seconds  train loss: 0.23128167685348436 validation loss: 0.2457937402209757
epoch 45 time used: 6  seconds  train loss: 0.23061153013775393 validation loss: 0.24606230074653473
epoch 46 time used: 6  seconds  train loss: 0.23027682260655408 validation loss: 0.24778970231074166
epoch 47 time used: 6  seconds  train loss: 0.22916041468617812 validation loss: 0.24486573628711483
epoch 48 time used: 6  seconds  train loss: 0.2287622550469017 validation loss: 0.2464439696454349
epoch 49 time used: 6  seconds  train loss: 0.22828690238833854 validation loss: 0.24365011548662757
epoch 50 time used: 6  seconds  train loss: 0.2274694374340693 validation loss: 0.24726799672763822
epoch 51 time used: 6  seconds  train loss: 0.2271023313045735 validation loss: 0.2429329606205548
epoch 52 time used: 6  seconds  train loss: 0.22624554126764845 validation loss: 0.2480602031153947
epoch 53 time used: 6  seconds  train loss: 0.2259322881533418 validation loss: 0.24299714877070935
epoch 54 time used: 6  seconds  train loss: 0.2257477442051014 validation loss: 0.2422986976330578
epoch 55 time used: 6  seconds  train loss: 0.22520743515482158 validation loss: 0.2455550076549419
epoch 56 time used: 6  seconds  train loss: 0.22417087294707908 validation loss: 0.24152600549318692
epoch 57 time used: 6  seconds  train loss: 0.2230633298766547 validation loss: 0.23972056946343717
epoch 58 time used: 6  seconds  train loss: 0.22266767672735277 validation loss: 0.24301669766613232
epoch 59 time used: 6  seconds  train loss: 0.2230508550005547 validation loss: 0.24049988326112406
epoch 60 time used: 6  seconds  train loss: 0.22213696081338272 validation loss: 0.24118034179490835
epoch 61 time used: 6  seconds  train loss: 0.22179381045527127 validation loss: 0.2419835574546679
epoch 62 time used: 6  seconds  train loss: 0.221169256924961 validation loss: 0.23785576118072374
epoch 63 time used: 6  seconds  train loss: 0.2206787528026209 validation loss: 0.24006697463261625
epoch 64 time used: 6  seconds  train loss: 0.22025756780841585 validation loss: 0.23967658589379962
epoch 65 time used: 6  seconds  train loss: 0.21941654785452117 validation loss: 0.24158460304727572
epoch 66 time used: 6  seconds  train loss: 0.21949445990949412 validation loss: 0.2371649467224267
epoch 67 time used: 6  seconds  train loss: 0.21831927547868393 validation loss: 0.24030545593600103
epoch 68 time used: 6  seconds  train loss: 0.21819792491121792 validation loss: 0.23973050839344706
epoch 69 time used: 6  seconds  train loss: 0.21714263501445594 validation loss: 0.23790682914320974
epoch 70 time used: 6  seconds  train loss: 0.21706144653569226 validation loss: 0.23617666216829608
epoch 71 time used: 6  seconds  train loss: 0.21722406342766515 validation loss: 0.23840625421768313
epoch 72 time used: 6  seconds  train loss: 0.21606298279288075 validation loss: 0.23794100476514932
epoch 73 time used: 6  seconds  train loss: 0.21568002464583147 validation loss: 0.2392812928963714
epoch 74 time used: 6  seconds  train loss: 0.2152307159472336 validation loss: 0.2414009768624205
epoch 75 time used: 6  seconds  train loss: 0.21470396604023348 validation loss: 0.23609854979679643
epoch 76 time used: 6  seconds  train loss: 0.21369795148987547 validation loss: 0.2382918333351034
epoch 77 time used: 6  seconds  train loss: 0.21285078225868084 validation loss: 0.23682238835643785
epoch 78 time used: 6  seconds  train loss: 0.2127239068196968 validation loss: 0.2351581279084265
epoch 79 time used: 6  seconds  train loss: 0.2125050024650833 validation loss: 0.23243210800905875
epoch 80 time used: 6  seconds  train loss: 0.21186372040633392 validation loss: 0.23643674455366337
epoch 81 time used: 6  seconds  train loss: 0.21157003943524455 validation loss: 0.2382404177411923
epoch 82 time used: 6  seconds  train loss: 0.21104632301014956 validation loss: 0.23507265628438231
epoch 83 time used: 6  seconds  train loss: 0.21128599131908019 validation loss: 0.23339704235009445
epoch 84 time used: 6  seconds  train loss: 0.21084201426761795 validation loss: 0.23224856085221018
epoch 85 time used: 6  seconds  train loss: 0.20962444464255514 validation loss: 0.23536742762946702
epoch 86 time used: 6  seconds  train loss: 0.20875060370779208 validation loss: 0.23259719028108405
epoch 87 time used: 6  seconds  train loss: 0.20899730534051347 validation loss: 0.23280417135424158
epoch 88 time used: 6  seconds  train loss: 0.20932482346226736 validation loss: 0.23203714969698117
epoch 89 time used: 6  seconds  train loss: 0.2078637352761672 validation loss: 0.23346708906220492
epoch 90 time used: 6  seconds  train loss: 0.2079760086120516 validation loss: 0.2337832588402802
epoch 91 time used: 6  seconds  train loss: 0.2071691014438644 validation loss: 0.23578023518655072
epoch 92 time used: 6  seconds  train loss: 0.20717486995204015 validation loss: 0.23093191199790936
epoch 93 time used: 6  seconds  train loss: 0.2064150787202473 validation loss: 0.23413603365659305
epoch 94 time used: 6  seconds  train loss: 0.20566768062437324 validation loss: 0.23177456005736208
epoch 95 time used: 6  seconds  train loss: 0.20550662342775983 validation loss: 0.23078683506606038
epoch 96 time used: 6  seconds  train loss: 0.20493546845880284 validation loss: 0.23211223047696314
epoch 97 time used: 6  seconds  train loss: 0.20477697549112697 validation loss: 0.23308411873855797
epoch 98 time used: 6  seconds  train loss: 0.20413020638464172 validation loss: 0.23095371595839398
epoch 99 time used: 6  seconds  train loss: 0.20467802976450317 validation loss: 0.23430943530726556
epoch 100 time used: 6  seconds  train loss: 0.20376665985444334 validation loss: 0.2306935696586907
epoch 101 time used: 6  seconds  train loss: 0.20337280648556136 validation loss: 0.23199686644353393
epoch 102 time used: 6  seconds  train loss: 0.20290540054289882 validation loss: 0.2306122504348967
epoch 103 time used: 6  seconds  train loss: 0.2027025982995044 validation loss: 0.22765954456802648
epoch 104 time used: 6  seconds  train loss: 0.20251034882331384 validation loss: 0.2315113548374285
epoch 105 time used: 6  seconds  train loss: 0.20196930950438893 validation loss: 0.22746458749939766
epoch 106 time used: 6  seconds  train loss: 0.20148699667716516 validation loss: 0.2291974149648625
epoch 107 time used: 6  seconds  train loss: 0.2013751945959694 validation loss: 0.2313027565420116
epoch 108 time used: 6  seconds  train loss: 0.2012729671740322 validation loss: 0.22846641283135924
epoch 109 time used: 6  seconds  train loss: 0.2006423252051375 validation loss: 0.23085046121377775
epoch 110 time used: 6  seconds  train loss: 0.20052123691171242 validation loss: 0.23088103443537178
epoch 111 time used: 6  seconds  train loss: 0.1997373350180824 validation loss: 0.23272150603621874
epoch 112 time used: 6  seconds  train loss: 0.19986399532549926 validation loss: 0.22780066544133734
epoch 113 time used: 6  seconds  train loss: 0.19994029737972538 validation loss: 0.22737922543671493
epoch 114 time used: 6  seconds  train loss: 0.19926446332755057 validation loss: 0.22917253827953502
epoch 115 time used: 6  seconds  train loss: 0.199039785382722 validation loss: 0.22954406628796392
epoch 116 time used: 6  seconds  train loss: 0.19843883857126146 validation loss: 0.22849679194684036
epoch 117 time used: 6  seconds  train loss: 0.19808225355554102 validation loss: 0.2265973601913153
epoch 118 time used: 6  seconds  train loss: 0.19740418539806728 validation loss: 0.22807444647354055
epoch 119 time used: 6  seconds  train loss: 0.1982362929902871 validation loss: 0.22833978115696263
epoch 120 time used: 6  seconds  train loss: 0.1974364983353352 validation loss: 0.22651273757644333
epoch 121 time used: 6  seconds  train loss: 0.1969186654007703 validation loss: 0.22461309828420944
epoch 122 time used: 6  seconds  train loss: 0.19689408368344488 validation loss: 0.230262087563481
epoch 123 time used: 6  seconds  train loss: 0.19704440013084343 validation loss: 0.22694836767720822
epoch 124 time used: 6  seconds  train loss: 0.1963301545678889 validation loss: 0.22517553143547525
epoch 125 time used: 6  seconds  train loss: 0.19569429499651347 validation loss: 0.2242463890716
epoch 126 time used: 6  seconds  train loss: 0.19617659020664874 validation loss: 0.22439418806223208
epoch 127 time used: 6  seconds  train loss: 0.19530425437662008 validation loss: 0.22711566241040476
epoch 128 time used: 6  seconds  train loss: 0.1951086756982514 validation loss: 0.22607190369777658
epoch 129 time used: 6  seconds  train loss: 0.19520492232755376 validation loss: 0.22459068447266453
epoch 130 time used: 6  seconds  train loss: 0.1943577571969721 validation loss: 0.22487407283516386
epoch 131 time used: 6  seconds  train loss: 0.19411709788065606 validation loss: 0.22845836924744958
epoch 132 time used: 6  seconds  train loss: 0.1943299820349665 validation loss: 0.223837727751993
epoch 133 time used: 6  seconds  train loss: 0.19391103632527062 validation loss: 0.22663796350946444
epoch 134 time used: 6  seconds  train loss: 0.19390700336267555 validation loss: 0.22253774562972786
epoch 135 time used: 6  seconds  train loss: 0.19338129047349334 validation loss: 0.22730565649131604
epoch 136 time used: 6  seconds  train loss: 0.19341807408950054 validation loss: 0.2254230534765153
epoch 137 time used: 6  seconds  train loss: 0.1928073085837229 validation loss: 0.22372659813045298
epoch 138 time used: 6  seconds  train loss: 0.19329692813970772 validation loss: 0.22357553224936255
epoch 139 time used: 6  seconds  train loss: 0.19255953888221483 validation loss: 0.2245262034420143
epoch 140 time used: 6  seconds  train loss: 0.1918086963637395 validation loss: 0.22640587608778878
epoch 141 time used: 6  seconds  train loss: 0.1921173880125126 validation loss: 0.2226777497404858
epoch 142 time used: 6  seconds  train loss: 0.19172250119684417 validation loss: 0.22463720315228988
epoch 143 time used: 6  seconds  train loss: 0.19176825369885273 validation loss: 0.2235770272531988
epoch 144 time used: 6  seconds  train loss: 0.1917504838722165 validation loss: 0.22214616779864887
epoch 145 time used: 6  seconds  train loss: 0.1915364851139639 validation loss: 0.2245638727784769
epoch 146 time used: 6  seconds  train loss: 0.1906242863116297 validation loss: 0.2238810425629564
epoch 147 time used: 6  seconds  train loss: 0.19084295033825543 validation loss: 0.22437265049506785
epoch 148 time used: 6  seconds  train loss: 0.19044175257716228 validation loss: 0.22418492146716143
epoch 149 time used: 6  seconds  train loss: 0.19036407627342655 validation loss: 0.22417256957758377
epoch 150 time used: 7  seconds  train loss: 0.18995446330625693 validation loss: 0.2221400347510135
epoch 151 time used: 6  seconds  train loss: 0.1901962882801186 validation loss: 0.22563422971532063
epoch 152 time used: 7  seconds  train loss: 0.18962885249426747 validation loss: 0.2211627185905721
epoch 153 time used: 6  seconds  train loss: 0.1896686538796414 validation loss: 0.22262974931761256
epoch 154 time used: 6  seconds  train loss: 0.18952887530314405 validation loss: 0.22201206344267468
epoch 155 time used: 6  seconds  train loss: 0.1893340278019686 validation loss: 0.2229288901795813
epoch 156 time used: 6  seconds  train loss: 0.18876816134111554 validation loss: 0.2231932631728313
epoch 157 time used: 6  seconds  train loss: 0.18867119646807 validation loss: 0.22097301697363803
epoch 158 time used: 6  seconds  train loss: 0.18849404523028276 validation loss: 0.22182368080376627
epoch 159 time used: 6  seconds  train loss: 0.18881006273591328 validation loss: 0.2237659439878061
epoch 160 time used: 6  seconds  train loss: 0.18801235498202754 validation loss: 0.22215657700352578
epoch 161 time used: 6  seconds  train loss: 0.1882511568469802 validation loss: 0.22218245422574906
epoch 162 time used: 6  seconds  train loss: 0.1883172399161264 validation loss: 0.22194498326869536
epoch 163 time used: 6  seconds  train loss: 0.1875441399748177 validation loss: 0.21916204212361992
epoch 164 time used: 6  seconds  train loss: 0.18747694353094155 validation loss: 0.21975021779163184
epoch 165 time used: 6  seconds  train loss: 0.1868863082452904 validation loss: 0.22020080977178477
epoch 166 time used: 6  seconds  train loss: 0.18705923576424166 validation loss: 0.2194424142717839
epoch 167 time used: 6  seconds  train loss: 0.18737907000286866 validation loss: 0.22033033626663026
epoch 168 time used: 6  seconds  train loss: 0.18671554595688714 validation loss: 0.22057747967536967
epoch 169 time used: 6  seconds  train loss: 0.18662670084172364 validation loss: 0.21935329838303655
epoch 170 time used: 6  seconds  train loss: 0.18685130502896236 validation loss: 0.220993501888094
epoch 171 time used: 6  seconds  train loss: 0.1865428960018217 validation loss: 0.2207480677096965
epoch 172 time used: 6  seconds  train loss: 0.18650824472886326 validation loss: 0.2199132027655959
Early stopping at epoch: 173
YS.shape, YS_pred.shape, (14021, 1, 1, 69) (14021, 1, 1, 69)
YS.shape, YS_pred.shape, (14021, 69) (14021, 69)
****************************************
STGCN3, train, Torch MSE, 1.8365738830e-01, 0.1836573883

STGCN3, train, MSE, RMSE, MAE, MAPE, 567.0168026504, 23.8121146195, 12.9169741244, 18.0624107161

Model Training Ended ... Sun Jan  9 07:35:33 2022
pred_finaltest-NYCTaxi-inflow-onehot_STGCN3_33_2201090715 testing started Sun Jan  9 07:35:33 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape is (3507, 1, 12, 69)
YS shape is (3507, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3507, 32, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape after is (3507, 33, 12, 69)
YS shape after is (3507, 1, 1, 69)
TEST XS.shape, YS.shape (3507, 33, 12, 69) (3507, 1, 1, 69)
Model Testing Started ... Sun Jan  9 07:35:33 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3507, 1, 1, 69) (3507, 1, 1, 69)
YS.shape, YS_pred.shape, (3507, 69) (3507, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
****************************************
STGCN3, test, Torch MSE, 2.1537969135e-01, 0.2153796914

STGCN3, test, MSE, RMSE, MAE, MAPE, 800.9741531010, 28.3014867649, 15.2071350962, 21.8714205933

Model Testing Ended ... Sun Jan  9 07:35:34 2022
