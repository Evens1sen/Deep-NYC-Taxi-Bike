nohup: ignoring input
../data-NYCBike/60min/bike-timestamp-outflow.h5
Namespace(addtime=True, adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=4, dataname='NYC-Bike-outflow-timestamp', datatype=0, epoch=200, ex='typhoon-inflow', flowpath='../data-NYCBike/60min/bike-timestamp-outflow.h5', gpu=6, graphnum=1, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (17544, 69)
pred_NYC-Bike-outflow-timestamp_STGCN1_1_2201041649 training started Tue Jan  4 16:49:02 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14023, 1, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape is (14023, 1, 12, 69)
YS shape is (14023, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14023, 1, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14023, 1, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape after is (14023, 2, 12, 69)
YS shape after is (14023, 1, 1, 69)
TRAIN XS.shape YS,shape (14023, 2, 12, 69) (14023, 1, 1, 69)
Model Training Started ... Tue Jan  4 16:49:03 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          448
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 99,233
Trainable params: 99,233
Non-trainable params: 0
Total mult-adds (M): 15.41
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 2.16
Params size (MB): 0.38
Estimated Total Size (MB): 2.54
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.2482349986041962 validation loss: 0.2755558306294989
epoch 1 time used: 5  seconds  train loss: 0.19301554741369775 validation loss: 0.2643408286642906
epoch 2 time used: 5  seconds  train loss: 0.17889137426672083 validation loss: 0.2682168650511531
epoch 3 time used: 5  seconds  train loss: 0.1733059149426761 validation loss: 0.26203612109388
epoch 4 time used: 5  seconds  train loss: 0.1672969489876779 validation loss: 0.26620760798046267
epoch 5 time used: 5  seconds  train loss: 0.16712334956837166 validation loss: 0.2593749242633394
epoch 6 time used: 5  seconds  train loss: 0.16278380781727878 validation loss: 0.2631077226814514
epoch 7 time used: 5  seconds  train loss: 0.15950067897783418 validation loss: 0.26275709455039115
epoch 8 time used: 5  seconds  train loss: 0.15948471408747228 validation loss: 0.25496409157651256
epoch 9 time used: 5  seconds  train loss: 0.1592746224457788 validation loss: 0.2542232947558998
epoch 10 time used: 5  seconds  train loss: 0.15916913258368734 validation loss: 0.2646518851339783
epoch 11 time used: 5  seconds  train loss: 0.15668184450465483 validation loss: 0.2588123706702294
epoch 12 time used: 5  seconds  train loss: 0.15628253572484585 validation loss: 0.2604904349827454
epoch 13 time used: 5  seconds  train loss: 0.15442456898887466 validation loss: 0.2675058379454811
epoch 14 time used: 5  seconds  train loss: 0.15471575266963208 validation loss: 0.2621512262058204
epoch 15 time used: 5  seconds  train loss: 0.15342578385404776 validation loss: 0.25800084445521415
epoch 16 time used: 5  seconds  train loss: 0.15418537374473532 validation loss: 0.2643588603188906
epoch 17 time used: 5  seconds  train loss: 0.1528581005412578 validation loss: 0.26453750644727086
epoch 18 time used: 5  seconds  train loss: 0.15237553802659673 validation loss: 0.25574568339027953
Early stopping at epoch: 19
YS.shape, YS_pred.shape, (14023, 1, 1, 69) (14023, 1, 1, 69)
YS.shape, YS_pred.shape, (14023, 69) (14023, 69)
****************************************
STGCN1, train, Torch MSE, 1.5426915007e-01, 0.1542691501

STGCN1, train, MSE, RMSE, MAE, MAPE, 115.9914351824, 10.7699319953, 6.2257046015, 38.3917725893

Model Training Ended ... Tue Jan  4 16:50:56 2022
pred_NYC-Bike-outflow-timestamp_STGCN1_1_2201041649 testing started Tue Jan  4 16:50:56 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape is (3509, 1, 12, 69)
YS shape is (3509, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape after is (3509, 2, 12, 69)
YS shape after is (3509, 1, 1, 69)
TEST XS.shape, YS.shape (3509, 2, 12, 69) (3509, 1, 1, 69)
Model Testing Started ... Tue Jan  4 16:50:56 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3509, 1, 1, 69) (3509, 1, 1, 69)
YS.shape, YS_pred.shape, (3509, 69) (3509, 69)
****************************************
STGCN1, test, Torch MSE, 2.8392175916e-01, 0.2839217592

STGCN1, test, MSE, RMSE, MAE, MAPE, 154.8538516606, 12.4440287552, 7.5261244508, 37.9817335507

Model Testing Ended ... Tue Jan  4 16:50:56 2022
pred_NYC-Bike-outflow-timestamp_STGCN2_2_2201041650 training started Tue Jan  4 16:50:56 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14022, 1, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape is (14022, 1, 12, 69)
YS shape is (14022, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14022, 1, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14022, 1, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape after is (14022, 2, 12, 69)
YS shape after is (14022, 1, 1, 69)
TRAIN XS.shape YS,shape (14022, 2, 12, 69) (14022, 1, 1, 69)
Model Training Started ... Tue Jan  4 16:50:57 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          448
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 99,233
Trainable params: 99,233
Non-trainable params: 0
Total mult-adds (M): 15.41
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 2.16
Params size (MB): 0.38
Estimated Total Size (MB): 2.54
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.31144005958224985 validation loss: 0.33877182204044687
epoch 1 time used: 5  seconds  train loss: 0.2267713721039068 validation loss: 0.33982705270910835
epoch 2 time used: 5  seconds  train loss: 0.2101103792950658 validation loss: 0.31414363296522935
epoch 3 time used: 5  seconds  train loss: 0.19903480822984237 validation loss: 0.33365279308605794
epoch 4 time used: 5  seconds  train loss: 0.19366890196647102 validation loss: 0.3165879278984059
epoch 5 time used: 5  seconds  train loss: 0.19122740393508295 validation loss: 0.32429055474311774
epoch 6 time used: 5  seconds  train loss: 0.1886280544247329 validation loss: 0.3499562885342362
epoch 7 time used: 5  seconds  train loss: 0.18509015315964944 validation loss: 0.31461931908735874
epoch 8 time used: 5  seconds  train loss: 0.1833263725268247 validation loss: 0.32685712241677645
epoch 9 time used: 5  seconds  train loss: 0.18058630779636975 validation loss: 0.3202203965261876
epoch 10 time used: 5  seconds  train loss: 0.17883189572605102 validation loss: 0.33344321773178703
epoch 11 time used: 5  seconds  train loss: 0.17798912965811226 validation loss: 0.315761955904403
Early stopping at epoch: 12
YS.shape, YS_pred.shape, (14022, 1, 1, 69) (14022, 1, 1, 69)
YS.shape, YS_pred.shape, (14022, 69) (14022, 69)
****************************************
STGCN2, train, Torch MSE, 1.7670162366e-01, 0.1767016237

STGCN2, train, MSE, RMSE, MAE, MAPE, 181.2800595007, 13.4640283534, 7.4407559656, 46.5336949198

Model Training Ended ... Tue Jan  4 16:52:09 2022
pred_NYC-Bike-outflow-timestamp_STGCN2_2_2201041650 testing started Tue Jan  4 16:52:09 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape is (3508, 1, 12, 69)
YS shape is (3508, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape after is (3508, 2, 12, 69)
YS shape after is (3508, 1, 1, 69)
TEST XS.shape, YS.shape (3508, 2, 12, 69) (3508, 1, 1, 69)
Model Testing Started ... Tue Jan  4 16:52:09 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3508, 1, 1, 69) (3508, 1, 1, 69)
YS.shape, YS_pred.shape, (3508, 69) (3508, 69)
****************************************
STGCN2, test, Torch MSE, 3.4994288102e-01, 0.3499428810

STGCN2, test, MSE, RMSE, MAE, MAPE, 252.7817921881, 15.8991129371, 9.5251835276, 44.8393315005

Model Testing Ended ... Tue Jan  4 16:52:10 2022
pred_NYC-Bike-outflow-timestamp_STGCN3_2_2201041652 training started Tue Jan  4 16:52:10 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14021, 1, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape is (14021, 1, 12, 69)
YS shape is (14021, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14021, 1, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14021, 1, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape after is (14021, 2, 12, 69)
YS shape after is (14021, 1, 1, 69)
TRAIN XS.shape YS,shape (14021, 2, 12, 69) (14021, 1, 1, 69)
Model Training Started ... Tue Jan  4 16:52:10 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          448
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 99,233
Trainable params: 99,233
Non-trainable params: 0
Total mult-adds (M): 15.41
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 2.16
Params size (MB): 0.38
Estimated Total Size (MB): 2.54
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.3176596614993431 validation loss: 0.40500931077117724
epoch 1 time used: 5  seconds  train loss: 0.24172155460920325 validation loss: 0.40171992578169174
epoch 2 time used: 5  seconds  train loss: 0.22493694268378367 validation loss: 0.3647489113020203
epoch 3 time used: 5  seconds  train loss: 0.21789632818774288 validation loss: 0.37032844035270485
epoch 4 time used: 5  seconds  train loss: 0.2112702496876964 validation loss: 0.3816924414427975
epoch 5 time used: 5  seconds  train loss: 0.20822155191391503 validation loss: 0.37435570797849504
epoch 6 time used: 5  seconds  train loss: 0.20222085495219777 validation loss: 0.34825680225968564
epoch 7 time used: 5  seconds  train loss: 0.2021964814138599 validation loss: 0.3812322764993734
epoch 8 time used: 5  seconds  train loss: 0.19932390418101648 validation loss: 0.36483856576616536
epoch 9 time used: 5  seconds  train loss: 0.19626802545651809 validation loss: 0.3677518156617965
epoch 10 time used: 5  seconds  train loss: 0.1941636772440667 validation loss: 0.3740325034242729
epoch 11 time used: 5  seconds  train loss: 0.19258293919058783 validation loss: 0.3640842303438181
epoch 12 time used: 5  seconds  train loss: 0.1914751182939161 validation loss: 0.3665677759386238
epoch 13 time used: 5  seconds  train loss: 0.1877786266685193 validation loss: 0.3662531036549953
epoch 14 time used: 5  seconds  train loss: 0.19071698594470346 validation loss: 0.3766911997838627
epoch 15 time used: 5  seconds  train loss: 0.18615704910410005 validation loss: 0.37474942158034236
Early stopping at epoch: 16
YS.shape, YS_pred.shape, (14021, 1, 1, 69) (14021, 1, 1, 69)
YS.shape, YS_pred.shape, (14021, 69) (14021, 69)
****************************************
STGCN3, train, Torch MSE, 1.8647760995e-01, 0.1864776099

STGCN3, train, MSE, RMSE, MAE, MAPE, 213.5817071433, 14.6144348896, 8.0554630695, 52.3449073355

Model Training Ended ... Tue Jan  4 16:53:43 2022
pred_NYC-Bike-outflow-timestamp_STGCN3_2_2201041652 testing started Tue Jan  4 16:53:43 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape is (3507, 1, 12, 69)
YS shape is (3507, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape after is (3507, 2, 12, 69)
YS shape after is (3507, 1, 1, 69)
TEST XS.shape, YS.shape (3507, 2, 12, 69) (3507, 1, 1, 69)
Model Testing Started ... Tue Jan  4 16:53:43 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3507, 1, 1, 69) (3507, 1, 1, 69)
YS.shape, YS_pred.shape, (3507, 69) (3507, 69)
****************************************
STGCN3, test, Torch MSE, 3.8294232515e-01, 0.3829423251

STGCN3, test, MSE, RMSE, MAE, MAPE, 339.0159913971, 18.4123869011, 10.9452421847, 52.5250502607

Model Testing Ended ... Tue Jan  4 16:53:44 2022
