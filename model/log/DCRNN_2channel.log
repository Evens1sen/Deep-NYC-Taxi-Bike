nohup: ignoring input
data.shape (35088, 69, 2)
pred_NYC-Taxi_DCRNN_2112191129 training started Sun Dec 19 11:29:38 2021
TRAIN XS.shape YS,shape (28056, 12, 69, 2) (28056, 3, 69, 2)
Model Training Started ... Sun Dec 19 11:29:38 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 69, 64]           --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 69, 64]              38,208
|    |    └─DCGRU_Cell: 3-2              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 69, 64]              73,920
|    |    └─DCGRU_Cell: 3-14             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 69, 64]              (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 69, 2]               --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 69, 64]              38,208
|    |    └─DCGRU_Cell: 3-26             [-1, 69, 64]              73,920
|    └─Linear: 2-1                       [-1, 69, 2]               130
├─DCGRU_Decoder: 1-3                     [-1, 69, 2]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 69, 64]              (recursive)
|    └─Linear: 2-2                       [-1, 69, 2]               (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 69, 2]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 69, 64]              (recursive)
|    └─Linear: 2-3                       [-1, 69, 2]               (recursive)
==========================================================================================
Total params: 224,386
Trainable params: 224,386
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.41
Params size (MB): 0.86
Estimated Total Size (MB): 1.27
==========================================================================================
XS_torch.shape:   torch.Size([28056, 12, 69, 2])
YS_torch.shape:   torch.Size([28056, 3, 69, 2])
LOSS is : MAE
epoch 0 time used: 39  seconds  train loss: 0.32141957094389734 validation loss: 0.092753065428674
epoch 1 time used: 37  seconds  train loss: 0.2771520773195833 validation loss: 0.08672919404372416
epoch 2 time used: 37  seconds  train loss: 0.26386453371251145 validation loss: 0.08417838830357438
epoch 3 time used: 37  seconds  train loss: 0.25506395796861925 validation loss: 0.08300773439106181
epoch 4 time used: 37  seconds  train loss: 0.24962431173338376 validation loss: 0.08192387190526593
epoch 5 time used: 37  seconds  train loss: 0.2446155716082031 validation loss: 0.0814547301069569
epoch 6 time used: 37  seconds  train loss: 0.24109801697089545 validation loss: 0.08194320797835247
epoch 7 time used: 37  seconds  train loss: 0.23846368558176462 validation loss: 0.08085277119116596
epoch 8 time used: 37  seconds  train loss: 0.2360087063090224 validation loss: 0.08523842103254567
epoch 9 time used: 37  seconds  train loss: 0.2339700819053661 validation loss: 0.08099940658414469
epoch 10 time used: 37  seconds  train loss: 0.23223962426389558 validation loss: 0.07922668227331571
epoch 11 time used: 37  seconds  train loss: 0.2306083407541502 validation loss: 0.079481480655369
epoch 12 time used: 37  seconds  train loss: 0.22949685438598819 validation loss: 0.08416999909428745
epoch 13 time used: 37  seconds  train loss: 0.22808418811142112 validation loss: 0.07917909656651584
epoch 14 time used: 37  seconds  train loss: 0.22733747045971175 validation loss: 0.07775337381608675
epoch 15 time used: 37  seconds  train loss: 0.22616091761367035 validation loss: 0.07754854813307345
epoch 16 time used: 37  seconds  train loss: 0.22492850106820306 validation loss: 0.08174267209618051
epoch 17 time used: 30  seconds  train loss: 0.2244594733998355 validation loss: 0.07754095579174328
epoch 18 time used: 23  seconds  train loss: 0.2237758555841172 validation loss: 0.07687743743209714
epoch 19 time used: 23  seconds  train loss: 0.22300987226729277 validation loss: 0.07676361611477833
epoch 20 time used: 23  seconds  train loss: 0.2226633585774295 validation loss: 0.07816727632364046
epoch 21 time used: 25  seconds  train loss: 0.22196314305090128 validation loss: 0.07937287298751619
epoch 22 time used: 37  seconds  train loss: 0.2212331151992873 validation loss: 0.07674209579574712
epoch 23 time used: 37  seconds  train loss: 0.22051156710143915 validation loss: 0.0759758895742679
epoch 24 time used: 37  seconds  train loss: 0.22022937964184414 validation loss: 0.07693952532755469
epoch 25 time used: 37  seconds  train loss: 0.2194908880484294 validation loss: 0.07778700323425401
epoch 26 time used: 37  seconds  train loss: 0.2191002279310014 validation loss: 0.0760553957374476
epoch 27 time used: 37  seconds  train loss: 0.21874468112857218 validation loss: 0.07601511490108757
epoch 28 time used: 37  seconds  train loss: 0.2180330855520375 validation loss: 0.07584894831988898
epoch 29 time used: 37  seconds  train loss: 0.2177129876366448 validation loss: 0.07613527256435637
epoch 30 time used: 37  seconds  train loss: 0.21749116232453056 validation loss: 0.07522543029615877
epoch 31 time used: 37  seconds  train loss: 0.2170556421050268 validation loss: 0.07662610320673391
epoch 32 time used: 37  seconds  train loss: 0.2166528371630669 validation loss: 0.07543946593566467
epoch 33 time used: 37  seconds  train loss: 0.21628207558065457 validation loss: 0.07565743603196823
epoch 34 time used: 37  seconds  train loss: 0.21586000164966582 validation loss: 0.07696531613157928
epoch 35 time used: 37  seconds  train loss: 0.21559268852990293 validation loss: 0.07570339265561764
epoch 36 time used: 37  seconds  train loss: 0.2152832025393696 validation loss: 0.07541469513673132
epoch 37/home/cseadmin/mhy/model/DCRNN.py:264: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(rowsum, -0.5).flatten()
 time used: 37  seconds  train loss: 0.21484483842393465 validation loss: 0.07631813382317205
epoch 38 time used: 37  seconds  train loss: 0.21466714231888967 validation loss: 0.0762419555371291
epoch 39 time used: 37  seconds  train loss: 0.2142155232694252 validation loss: 0.07534683403132272
Early stopping at epoch: 40
YS.shape, YS_pred.shape, (28056, 3, 69, 2) (28056, 3, 69, 2)
YS.shape, YS_pred.shape, (28056, 3, 69, 2) (28056, 3, 69, 2)
****************************************
DCRNN, train, Torch MSE, 2.1402360412e-01, 0.2140236041
DCRNN, train, MSE, RMSE, MAE, MAPE, 152.5830407600, 12.3524507997, 6.7702704309, 41.2248073275
Model Training Ended ... Sun Dec 19 11:54:39 2021
pred_NYC-Taxi_DCRNN_2112191129 testing started Sun Dec 19 11:54:39 2021
TEST XS.shape, YS.shape (7016, 12, 69, 2) (7016, 3, 69, 2)
Model Testing Started ... Sun Dec 19 11:54:39 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
YS.shape, YS_pred.shape, (7016, 3, 69, 2) (7016, 3, 69, 2)
YS.shape, YS_pred.shape, (7016, 3, 69, 2) (7016, 3, 69, 2)
****************************************
DCRNN, test, Torch MSE, 1.1380352800e-01, 0.1138035280
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 50.1217944085, 7.0796747389, 4.2423139665, 70.8802100570
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 36.8114842114, 6.0672468395, 3.7712578310, 65.1618016740
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 48.7015825028, 6.9786519116, 4.2013918199, 69.4002955728
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 64.8530085923, 8.0531365686, 4.7543164322, 78.0788587200
Model Testing Ended ... Sun Dec 19 11:54:45 2021
