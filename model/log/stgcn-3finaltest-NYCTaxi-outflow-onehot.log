nohup: ignoring input
../data-NYCTaxi/60min/taxi-timestamp-outflow.h5
Namespace(addtime=True, adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=4, dataname='finaltest-NYCTaxi-outflow-onehot3', datatype=0, epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/60min/taxi-timestamp-outflow.h5', gpu=7, graphnum=1, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
timestamp shape is (17544, 69, 32)
data.shape (17544, 69)
pred_finaltest-NYCTaxi-outflow-onehot3_STGCN1_1_2201091649 training started Sun Jan  9 16:49:16 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14023, 1, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape is (14023, 1, 12, 69)
YS shape is (14023, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14023, 32, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape after is (14023, 33, 12, 69)
YS shape after is (14023, 1, 1, 69)
TRAIN XS.shape YS,shape (14023, 33, 12, 69) (14023, 1, 1, 69)
Model Training Started ... Sun Jan  9 16:49:18 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 6  seconds  train loss: 0.3271629496425172 validation loss: 0.264668851716819
epoch 1 time used: 6  seconds  train loss: 0.2520993904578754 validation loss: 0.24629628666795056
epoch 2 time used: 6  seconds  train loss: 0.23880854646850624 validation loss: 0.24228040167623022
epoch 3 time used: 6  seconds  train loss: 0.23133017607792278 validation loss: 0.23424869660166966
epoch 4 time used: 6  seconds  train loss: 0.22855404517032699 validation loss: 0.23616496343920043
epoch 5 time used: 6  seconds  train loss: 0.22409543070301546 validation loss: 0.23177820765421314
epoch 6 time used: 6  seconds  train loss: 0.22075250713244238 validation loss: 0.22744857774451332
epoch 7 time used: 6  seconds  train loss: 0.21848231624711698 validation loss: 0.222357369071065
epoch 8 time used: 6  seconds  train loss: 0.21640564122137834 validation loss: 0.22026470005172222
epoch 9 time used: 6  seconds  train loss: 0.21480497365670176 validation loss: 0.23868388835185606
epoch 10 time used: 6  seconds  train loss: 0.21546661977177242 validation loss: 0.22035139737065287
epoch 11 time used: 6  seconds  train loss: 0.21333144828616454 validation loss: 0.21852145777963192
epoch 12 time used: 6  seconds  train loss: 0.21270763246674992 validation loss: 0.21661220995854868
epoch 13 time used: 6  seconds  train loss: 0.21209499935794868 validation loss: 0.21913259846614688
epoch 14 time used: 6  seconds  train loss: 0.21140455077261874 validation loss: 0.21662963528974494
epoch 15 time used: 6  seconds  train loss: 0.20960064701122683 validation loss: 0.22048030086435458
epoch 16 time used: 6  seconds  train loss: 0.2100354612918044 validation loss: 0.21377138675313231
epoch 17 time used: 6  seconds  train loss: 0.20896113572464595 validation loss: 0.21983515240434776
epoch 18 time used: 6  seconds  train loss: 0.20861340232175254 validation loss: 0.2155211992217552
epoch 19 time used: 6  seconds  train loss: 0.20742691090996904 validation loss: 0.2143570175612238
epoch 20 time used: 6  seconds  train loss: 0.2068970958974756 validation loss: 0.2159352303061292
epoch 21 time used: 6  seconds  train loss: 0.20640638102189057 validation loss: 0.2121397504977206
epoch 22 time used: 6  seconds  train loss: 0.2069447667936824 validation loss: 0.2144940792324199
epoch 23 time used: 6  seconds  train loss: 0.20563253880081472 validation loss: 0.21460578368346622
epoch 24 time used: 6  seconds  train loss: 0.2048113033066169 validation loss: 0.22040018991817426
epoch 25 time used: 6  seconds  train loss: 0.20570258048849566 validation loss: 0.21217629408673158
epoch 26 time used: 6  seconds  train loss: 0.20448131837442626 validation loss: 0.20986249715650823
epoch 27 time used: 6  seconds  train loss: 0.20325660228049164 validation loss: 0.2106031084733899
epoch 28 time used: 6  seconds  train loss: 0.20368730013411318 validation loss: 0.21107619255356155
epoch 29 time used: 6  seconds  train loss: 0.20248667054430877 validation loss: 0.20866780610371508
epoch 30 time used: 6  seconds  train loss: 0.20187702358691986 validation loss: 0.21488288316091536
epoch 31 time used: 6  seconds  train loss: 0.20270336155689336 validation loss: 0.21166853258185434
epoch 32 time used: 6  seconds  train loss: 0.2014774913382705 validation loss: 0.20964314958162467
epoch 33 time used: 6  seconds  train loss: 0.20150322255897832 validation loss: 0.21027202402702141
epoch 34 time used: 6  seconds  train loss: 0.20094415936027005 validation loss: 0.21236970321967544
epoch 35 time used: 6  seconds  train loss: 0.20011646523889529 validation loss: 0.2125818396695872
epoch 36 time used: 6  seconds  train loss: 0.19994211067440262 validation loss: 0.2073273396260794
epoch 37 time used: 6  seconds  train loss: 0.20014550271030354 validation loss: 0.20982647962183934
epoch 38 time used: 6  seconds  train loss: 0.19928630874617467 validation loss: 0.2076086134177511
epoch 39 time used: 6  seconds  train loss: 0.19874730575541316 validation loss: 0.20787343517991386
epoch 40 time used: 6  seconds  train loss: 0.1989435175495995 validation loss: 0.20988852976562633
epoch 41 time used: 6  seconds  train loss: 0.19805581074666473 validation loss: 0.2113253611261615
epoch 42 time used: 6  seconds  train loss: 0.19770521234475022 validation loss: 0.21001541735237828
epoch 43 time used: 6  seconds  train loss: 0.19748334863512323 validation loss: 0.20540930435307966
epoch 44 time used: 6  seconds  train loss: 0.1968918622123 validation loss: 0.20882550267852243
epoch 45 time used: 6  seconds  train loss: 0.19661664487923075 validation loss: 0.2066281693565186
epoch 46 time used: 6  seconds  train loss: 0.19562844191271792 validation loss: 0.20568641198239052
epoch 47 time used: 6  seconds  train loss: 0.195709789212195 validation loss: 0.20439502570503995
epoch 48 time used: 6  seconds  train loss: 0.19568356502658482 validation loss: 0.2060321757216081
epoch 49 time used: 6  seconds  train loss: 0.19478844221083244 validation loss: 0.20699154937090494
epoch 50 time used: 6  seconds  train loss: 0.19465327684045713 validation loss: 0.20417341996245703
epoch 51 time used: 6  seconds  train loss: 0.1938609060322063 validation loss: 0.20719472227508656
epoch 52 time used: 6  seconds  train loss: 0.19323445176971377 validation loss: 0.20419137822480046
epoch 53 time used: 6  seconds  train loss: 0.19237803989245625 validation loss: 0.20412540338886717
epoch 54 time used: 6  seconds  train loss: 0.19294623950437112 validation loss: 0.20540779142194793
epoch 55 time used: 6  seconds  train loss: 0.1918776169965786 validation loss: 0.20420594944385415
epoch 56 time used: 6  seconds  train loss: 0.1919303116607977 validation loss: 0.20479945481435544
epoch 57 time used: 6  seconds  train loss: 0.19176093573820913 validation loss: 0.20348988044996366
epoch 58 time used: 6  seconds  train loss: 0.1909942504926338 validation loss: 0.20507467485841044
epoch 59 time used: 6  seconds  train loss: 0.19063821183343 validation loss: 0.20511355758971372
epoch 60 time used: 6  seconds  train loss: 0.19005066285603592 validation loss: 0.203187191607064
epoch 61 time used: 6  seconds  train loss: 0.1902153058103555 validation loss: 0.20412147392800925
epoch 62 time used: 6  seconds  train loss: 0.18945055888159643 validation loss: 0.2028429359452628
epoch 63 time used: 6  seconds  train loss: 0.18920783960391763 validation loss: 0.2014350287416494
epoch 64 time used: 6  seconds  train loss: 0.1888158177591089 validation loss: 0.20284787340634766
epoch 65 time used: 6  seconds  train loss: 0.1896450930746377 validation loss: 0.20227454720873597
epoch 66 time used: 6  seconds  train loss: 0.188062372191611 validation loss: 0.20041984894312387
epoch 67 time used: 6  seconds  train loss: 0.18710593015028387 validation loss: 0.200987911647684
epoch 68 time used: 6  seconds  train loss: 0.18698688524713727 validation loss: 0.20153439722432454
epoch 69 time used: 6  seconds  train loss: 0.18716073462461785 validation loss: 0.2003366603418819
epoch 70 time used: 6  seconds  train loss: 0.1865827799013405 validation loss: 0.2005126487763351
epoch 71 time used: 6  seconds  train loss: 0.18607711710381916 validation loss: 0.1992323215576967
epoch 72 time used: 6  seconds  train loss: 0.18572358849239037 validation loss: 0.19920650713626004
epoch 73 time used: 6  seconds  train loss: 0.18557618455665328 validation loss: 0.1983930415431908
epoch 74 time used: 6  seconds  train loss: 0.184383261339783 validation loss: 0.19917352211114955
epoch 75 time used: 6  seconds  train loss: 0.18476312444913456 validation loss: 0.19907236816674997
epoch 76 time used: 6  seconds  train loss: 0.18475147420396237 validation loss: 0.19912764535450758
epoch 77 time used: 6  seconds  train loss: 0.18382218205404166 validation loss: 0.20061952941633943
epoch 78 time used: 6  seconds  train loss: 0.18345872407631847 validation loss: 0.19837461946626697
epoch 79 time used: 6  seconds  train loss: 0.18384887612779255 validation loss: 0.1986103013659367
epoch 80 time used: 6  seconds  train loss: 0.18365984574603958 validation loss: 0.198282594722948
epoch 81 time used: 6  seconds  train loss: 0.1825856710485841 validation loss: 0.19898211234342147
epoch 82 time used: 6  seconds  train loss: 0.18185903464960876 validation loss: 0.19672395792166572
epoch 83 time used: 6  seconds  train loss: 0.18221988571350808 validation loss: 0.19744119720498426
epoch 84 time used: 6  seconds  train loss: 0.18208245723200894 validation loss: 0.19792177713876172
epoch 85 time used: 6  seconds  train loss: 0.18157656601073788 validation loss: 0.19685350180828293
epoch 86 time used: 6  seconds  train loss: 0.18088641096492464 validation loss: 0.1975378374066002
epoch 87 time used: 6  seconds  train loss: 0.1807477797253305 validation loss: 0.19601905753934853
epoch 88 time used: 6  seconds  train loss: 0.18087756514014902 validation loss: 0.19565551975796172
epoch 89 time used: 6  seconds  train loss: 0.18047895691408408 validation loss: 0.19645011218459146
epoch 90 time used: 6  seconds  train loss: 0.17958661841977003 validation loss: 0.1964756766099353
epoch 91 time used: 6  seconds  train loss: 0.1804302578256105 validation loss: 0.19675818271828732
epoch 92 time used: 6  seconds  train loss: 0.17898750392129584 validation loss: 0.194994806563317
epoch 93 time used: 6  seconds  train loss: 0.17864924009825606 validation loss: 0.19678115930580373
epoch 94 time used: 6  seconds  train loss: 0.17888580800171489 validation loss: 0.19740682346475377
epoch 95 time used: 6  seconds  train loss: 0.17785698610199305 validation loss: 0.1958323612987689
epoch 96 time used: 6  seconds  train loss: 0.17824023835719263 validation loss: 0.19491835663608326
epoch 97 time used: 6  seconds  train loss: 0.17773794431752468 validation loss: 0.194677589734282
epoch 98 time used: 6  seconds  train loss: 0.17759672819159336 validation loss: 0.19513890150609317
epoch 99 time used: 6  seconds  train loss: 0.17772804805925443 validation loss: 0.1942537368295945
epoch 100 time used: 6  seconds  train loss: 0.17706557617453705 validation loss: 0.19611601285844685
epoch 101 time used: 6  seconds  train loss: 0.17684768686813362 validation loss: 0.1956759383779761
epoch 102 time used: 6  seconds  train loss: 0.17655704334050343 validation loss: 0.19464599299927268
epoch 103 time used: 6  seconds  train loss: 0.17634215930806202 validation loss: 0.19380559161500938
epoch 104 time used: 6  seconds  train loss: 0.17558146155065119 validation loss: 0.19415384232657878
epoch 105 time used: 6  seconds  train loss: 0.17557033640685465 validation loss: 0.19297279182904392
epoch 106 time used: 6  seconds  train loss: 0.1751910342466763 validation loss: 0.19357414707685971
epoch 107 time used: 6  seconds  train loss: 0.17549484893133122 validation loss: 0.19370571521779706
epoch 108 time used: 6  seconds  train loss: 0.17471195348609048 validation loss: 0.1928829715820428
epoch 109 time used: 6  seconds  train loss: 0.1747162692145594 validation loss: 0.19313330393278183
epoch 110 time used: 6  seconds  train loss: 0.17446268988316294 validation loss: 0.19266927603545084
epoch 111 time used: 6  seconds  train loss: 0.17428003896176572 validation loss: 0.19196646919402816
epoch 112 time used: 6  seconds  train loss: 0.17375295448079767 validation loss: 0.19297079064474743
epoch 113 time used: 6  seconds  train loss: 0.17364077242341777 validation loss: 0.1916229099511284
epoch 114 time used: 6  seconds  train loss: 0.1734908489891447 validation loss: 0.192233840856835
epoch 115 time used: 6  seconds  train loss: 0.17345044079988878 validation loss: 0.19213974569364745
epoch 116 time used: 6  seconds  train loss: 0.17260678654632242 validation loss: 0.1915965557897424
epoch 117 time used: 6  seconds  train loss: 0.17229012327652785 validation loss: 0.1922507034375609
epoch 118 time used: 6  seconds  train loss: 0.17255216483770586 validation loss: 0.19116851798786277
epoch 119 time used: 6  seconds  train loss: 0.1722276920138478 validation loss: 0.19313877753815648
epoch 120 time used: 6  seconds  train loss: 0.17156233404502697 validation loss: 0.1912301593315105
epoch 121 time used: 6  seconds  train loss: 0.1713482691926886 validation loss: 0.1914308870341937
epoch 122 time used: 6  seconds  train loss: 0.17138581919106605 validation loss: 0.190080498525298
epoch 123 time used: 6  seconds  train loss: 0.171041615694737 validation loss: 0.19058991871727446
epoch 124 time used: 6  seconds  train loss: 0.17101505638723366 validation loss: 0.19018354308108773
epoch 125 time used: 6  seconds  train loss: 0.17073470708696262 validation loss: 0.19020212013688825
epoch 126 time used: 6  seconds  train loss: 0.17034206791388473 validation loss: 0.19102356108983992
epoch 127 time used: 6  seconds  train loss: 0.1702011049935365 validation loss: 0.19043024518424556
epoch 128 time used: 6  seconds  train loss: 0.16999019761345885 validation loss: 0.19049280070945732
epoch 129 time used: 6  seconds  train loss: 0.16980295119580935 validation loss: 0.19138762382902014
epoch 130 time used: 6  seconds  train loss: 0.16972261055903212 validation loss: 0.19016100915071288
epoch 131 time used: 6  seconds  train loss: 0.16945763957286716 validation loss: 0.1891821963968647
epoch 132 time used: 6  seconds  train loss: 0.16947051267995034 validation loss: 0.18963250953064464
epoch 133 time used: 6  seconds  train loss: 0.1686543715563652 validation loss: 0.18893365629115108
epoch 134 time used: 6  seconds  train loss: 0.1690871729511698 validation loss: 0.1896370403761872
epoch 135 time used: 6  seconds  train loss: 0.1682713755015542 validation loss: 0.1889060667784501
epoch 136 time used: 6  seconds  train loss: 0.16821024370271206 validation loss: 0.19071976967151683
epoch 137 time used: 6  seconds  train loss: 0.16838576226284957 validation loss: 0.19000832458529823
epoch 138 time used: 6  seconds  train loss: 0.16829360965168758 validation loss: 0.1900631664007375
epoch 139 time used: 6  seconds  train loss: 0.1678666788747666 validation loss: 0.1878343656854635
epoch 140 time used: 6  seconds  train loss: 0.16738933388207536 validation loss: 0.18818626628898583
epoch 141 time used: 6  seconds  train loss: 0.16730037984706175 validation loss: 0.18833349504881564
epoch 142 time used: 6  seconds  train loss: 0.16685850444176184 validation loss: 0.187256224177187
epoch 143 time used: 6  seconds  train loss: 0.16687255301607656 validation loss: 0.18748994871200458
epoch 144 time used: 6  seconds  train loss: 0.1672388022253935 validation loss: 0.18839029869180507
epoch 145 time used: 6  seconds  train loss: 0.16668472275708687 validation loss: 0.18829326928341925
epoch 146 time used: 6  seconds  train loss: 0.16702936642424498 validation loss: 0.18900426993591746
epoch 147 time used: 6  seconds  train loss: 0.1662946389934933 validation loss: 0.18706504067249863
epoch 148 time used: 6  seconds  train loss: 0.16634894899216335 validation loss: 0.1875894068481578
epoch 149 time used: 6  seconds  train loss: 0.16593540220748337 validation loss: 0.18767549625411417
epoch 150 time used: 6  seconds  train loss: 0.16575750835610292 validation loss: 0.1883755961334236
epoch 151 time used: 6  seconds  train loss: 0.16534759062718063 validation loss: 0.18763977267948886
epoch 152 time used: 6  seconds  train loss: 0.16555948837705037 validation loss: 0.1877637164326171
epoch 153 time used: 6  seconds  train loss: 0.16508075947575 validation loss: 0.18727526038086081
epoch 154 time used: 6  seconds  train loss: 0.16477836073659355 validation loss: 0.18706664987040192
epoch 155 time used: 6  seconds  train loss: 0.1648668449150418 validation loss: 0.18646862067566963
epoch 156 time used: 6  seconds  train loss: 0.1646602115984748 validation loss: 0.18697774325244032
epoch 157 time used: 6  seconds  train loss: 0.16460763676048004 validation loss: 0.18598924632488628
epoch 158 time used: 6  seconds  train loss: 0.1643365423224666 validation loss: 0.18630401770591193
epoch 159 time used: 6  seconds  train loss: 0.16421604955837604 validation loss: 0.1866412215908119
epoch 160 time used: 6  seconds  train loss: 0.16448351994897645 validation loss: 0.18717672606569932
epoch 161 time used: 6  seconds  train loss: 0.16408316158577982 validation loss: 0.1858804094760811
epoch 162 time used: 6  seconds  train loss: 0.16383291290801233 validation loss: 0.1875010960726349
epoch 163 time used: 6  seconds  train loss: 0.1635230002018525 validation loss: 0.18581863919871233
epoch 164 time used: 6  seconds  train loss: 0.16348189841272778 validation loss: 0.1858541664231252
epoch 165 time used: 6  seconds  train loss: 0.16329031043550107 validation loss: 0.18563696084128606
epoch 166 time used: 6  seconds  train loss: 0.1630634018776372 validation loss: 0.18570467621445044
epoch 167 time used: 6  seconds  train loss: 0.16303210501614487 validation loss: 0.18540136346936703
epoch 168 time used: 6  seconds  train loss: 0.16274999771646687 validation loss: 0.18576225604388077
epoch 169 time used: 6  seconds  train loss: 0.16266105877935352 validation loss: 0.18460312880962423
epoch 170 time used: 6  seconds  train loss: 0.16282656356242972 validation loss: 0.18628354727609867
epoch 171 time used: 6  seconds  train loss: 0.1626068091139914 validation loss: 0.18525881000198913
epoch 172 time used: 6  seconds  train loss: 0.16221285454364162 validation loss: 0.18445292008956773
epoch 173 time used: 6  seconds  train loss: 0.16172175175209014 validation loss: 0.18463368093328208
epoch 174 time used: 6  seconds  train loss: 0.1622309013630378 validation loss: 0.18434897316773824
epoch 175 time used: 6  seconds  train loss: 0.16225596334794332 validation loss: 0.18397143635318677
epoch 176 time used: 6  seconds  train loss: 0.16131770152480213 validation loss: 0.1845161186513123
epoch 177 time used: 6  seconds  train loss: 0.1616401227927344 validation loss: 0.18500955738616004
epoch 178 time used: 6  seconds  train loss: 0.1611814668947055 validation loss: 0.18489136158807987
epoch 179 time used: 6  seconds  train loss: 0.16108922677110052 validation loss: 0.18399442966944546
epoch 180 time used: 6  seconds  train loss: 0.16101490640261354 validation loss: 0.1841028502632806
epoch 181 time used: 6  seconds  train loss: 0.16077904763169276 validation loss: 0.18349024503828115
epoch 182 time used: 6  seconds  train loss: 0.16073469948311986 validation loss: 0.18420590237590564
epoch 183 time used: 6  seconds  train loss: 0.16040170429534026 validation loss: 0.1837455520477556
epoch 184 time used: 6  seconds  train loss: 0.16052189616527418 validation loss: 0.18294063829314824
epoch 185 time used: 6  seconds  train loss: 0.16039361867267327 validation loss: 0.18407462063817656
epoch 186 time used: 6  seconds  train loss: 0.16047860252342286 validation loss: 0.1833843603194678
epoch 187 time used: 6  seconds  train loss: 0.16018705440908307 validation loss: 0.18401080815369106
epoch 188 time used: 6  seconds  train loss: 0.1598054171531494 validation loss: 0.1842685754868349
epoch 189 time used: 6  seconds  train loss: 0.1604254918629888 validation loss: 0.18420007381178077
epoch 190 time used: 6  seconds  train loss: 0.15954924955927655 validation loss: 0.18295856892076548
epoch 191 time used: 6  seconds  train loss: 0.1594285487084245 validation loss: 0.1832963539169505
epoch 192 time used: 6  seconds  train loss: 0.15952361878964022 validation loss: 0.18344735604521212
epoch 193 time used: 6  seconds  train loss: 0.15936898919947282 validation loss: 0.182010463362956
epoch 194 time used: 6  seconds  train loss: 0.15919546262704948 validation loss: 0.1821362443196046
epoch 195 time used: 6  seconds  train loss: 0.15903360607328704 validation loss: 0.18287710432352097
epoch 196 time used: 6  seconds  train loss: 0.1590236346849894 validation loss: 0.18313569962740353
epoch 197 time used: 6  seconds  train loss: 0.15870395860928488 validation loss: 0.18436294021398356
epoch 198 time used: 6  seconds  train loss: 0.15905897504883076 validation loss: 0.18287653716985525
epoch 199 time used: 6  seconds  train loss: 0.1585368991991127 validation loss: 0.18344518989409572
YS.shape, YS_pred.shape, (14023, 1, 1, 69) (14023, 1, 1, 69)
YS.shape, YS_pred.shape, (14023, 69) (14023, 69)
****************************************
STGCN1, train, Torch MSE, 1.5791728623e-01, 0.1579172862

STGCN1, train, MSE, RMSE, MAE, MAPE, 319.4439446395, 17.8729948425, 10.4829363036, 15.1173182834

Model Training Ended ... Sun Jan  9 17:10:01 2022
pred_finaltest-NYCTaxi-outflow-onehot3_STGCN1_1_2201091649 testing started Sun Jan  9 17:10:01 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape is (3509, 1, 12, 69)
YS shape is (3509, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3509, 32, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape after is (3509, 33, 12, 69)
YS shape after is (3509, 1, 1, 69)
TEST XS.shape, YS.shape (3509, 33, 12, 69) (3509, 1, 1, 69)
Model Testing Started ... Sun Jan  9 17:10:02 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3509, 1, 1, 69) (3509, 1, 1, 69)
YS.shape, YS_pred.shape, (3509, 69) (3509, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
****************************************
STGCN1, test, Torch MSE, 1.7744439866e-01, 0.1774443987

STGCN1, test, MSE, RMSE, MAE, MAPE, 372.4462965640, 19.2988677534, 11.3809795905, 17.8917652258

Model Testing Ended ... Sun Jan  9 17:10:02 2022
pred_finaltest-NYCTaxi-outflow-onehot3_STGCN2_33_2201091710 training started Sun Jan  9 17:10:02 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14022, 1, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape is (14022, 1, 12, 69)
YS shape is (14022, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14022, 32, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape after is (14022, 33, 12, 69)
YS shape after is (14022, 1, 1, 69)
TRAIN XS.shape YS,shape (14022, 33, 12, 69) (14022, 1, 1, 69)
Model Training Started ... Sun Jan  9 17:10:04 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 6  seconds  train loss: 0.3795831451056318 validation loss: 0.3311473753067404
epoch 1 time used: 6  seconds  train loss: 0.2858051611475688 validation loss: 0.2867225900385901
epoch 2 time used: 6  seconds  train loss: 0.2597362312674765 validation loss: 0.27010084289995795
epoch 3 time used: 6  seconds  train loss: 0.25054799528209976 validation loss: 0.2598499079568007
epoch 4 time used: 6  seconds  train loss: 0.24565309378422406 validation loss: 0.26489217724721226
epoch 5 time used: 6  seconds  train loss: 0.24082177723908602 validation loss: 0.2524530663533817
epoch 6 time used: 6  seconds  train loss: 0.23883433822548197 validation loss: 0.2590697859942539
epoch 7 time used: 6  seconds  train loss: 0.23441077893657103 validation loss: 0.24685924789664818
epoch 8 time used: 6  seconds  train loss: 0.23353590417587433 validation loss: 0.24646532260990794
epoch 9 time used: 6  seconds  train loss: 0.23218850237260832 validation loss: 0.24904590933511955
epoch 10 time used: 6  seconds  train loss: 0.23055740519878343 validation loss: 0.24655123619406277
epoch 11 time used: 6  seconds  train loss: 0.2278196863220999 validation loss: 0.2490637150326934
epoch 12 time used: 6  seconds  train loss: 0.22755176648260747 validation loss: 0.2433220333904793
epoch 13 time used: 6  seconds  train loss: 0.2274694792062168 validation loss: 0.23862289953116206
epoch 14 time used: 6  seconds  train loss: 0.22584492359721814 validation loss: 0.2432069196506561
epoch 15 time used: 6  seconds  train loss: 0.22625833610949475 validation loss: 0.24115581724620586
epoch 16 time used: 6  seconds  train loss: 0.22400000492715536 validation loss: 0.23875715062064712
epoch 17 time used: 6  seconds  train loss: 0.22384830067453898 validation loss: 0.23986775980156214
epoch 18 time used: 6  seconds  train loss: 0.22153311223095307 validation loss: 0.23555603452532617
epoch 19 time used: 6  seconds  train loss: 0.22172515985993713 validation loss: 0.23919390433526896
epoch 20 time used: 6  seconds  train loss: 0.22164324865902593 validation loss: 0.23605920872515565
epoch 21 time used: 6  seconds  train loss: 0.22029519665551192 validation loss: 0.2347905723812644
epoch 22 time used: 6  seconds  train loss: 0.21943905056664584 validation loss: 0.2382425948492949
epoch 23 time used: 6  seconds  train loss: 0.21971180115029615 validation loss: 0.2341149738701289
epoch 24 time used: 6  seconds  train loss: 0.21856150841186328 validation loss: 0.23269380519407787
epoch 25 time used: 6  seconds  train loss: 0.2172970978868203 validation loss: 0.23471230084870245
epoch 26 time used: 6  seconds  train loss: 0.21667519133552887 validation loss: 0.2300915015352432
epoch 27 time used: 6  seconds  train loss: 0.21598227970907552 validation loss: 0.23179835270658875
epoch 28 time used: 6  seconds  train loss: 0.21551366218879098 validation loss: 0.23207328304078875
epoch 29 time used: 6  seconds  train loss: 0.21636723797856106 validation loss: 0.2330928919268416
epoch 30 time used: 6  seconds  train loss: 0.21469287196934414 validation loss: 0.23006220400775423
epoch 31 time used: 6  seconds  train loss: 0.21451554109103058 validation loss: 0.22842987588964322
epoch 32 time used: 6  seconds  train loss: 0.2136128683568349 validation loss: 0.22765346848141854
epoch 33 time used: 6  seconds  train loss: 0.21351321656140015 validation loss: 0.23350333923519645
epoch 34 time used: 6  seconds  train loss: 0.21232286108007484 validation loss: 0.22836773590536982
epoch 35 time used: 6  seconds  train loss: 0.2112024365745534 validation loss: 0.22591017062536187
epoch 36 time used: 6  seconds  train loss: 0.21185318066939932 validation loss: 0.22735875982661555
epoch 37 time used: 6  seconds  train loss: 0.2108732575354983 validation loss: 0.22568017539302077
epoch 38 time used: 6  seconds  train loss: 0.21061845332061044 validation loss: 0.22398102548689552
epoch 39 time used: 6  seconds  train loss: 0.2099839325628981 validation loss: 0.22597198891286094
epoch 40 time used: 6  seconds  train loss: 0.210508810266839 validation loss: 0.23120639916494515
epoch 41 time used: 6  seconds  train loss: 0.20909018154462594 validation loss: 0.22440513478845986
epoch 42 time used: 6  seconds  train loss: 0.20841431198357 validation loss: 0.22782243298620614
epoch 43 time used: 6  seconds  train loss: 0.20795640632132464 validation loss: 0.2240457448001188
epoch 44 time used: 6  seconds  train loss: 0.207152132068474 validation loss: 0.22351012285851915
epoch 45 time used: 6  seconds  train loss: 0.20683559090717663 validation loss: 0.22242154290658436
epoch 46 time used: 6  seconds  train loss: 0.20690495695419928 validation loss: 0.2244625848511322
epoch 47 time used: 6  seconds  train loss: 0.20688003531532442 validation loss: 0.22286285969167863
epoch 48 time used: 6  seconds  train loss: 0.20599372554514264 validation loss: 0.22186121113356086
epoch 49 time used: 6  seconds  train loss: 0.2055890764459653 validation loss: 0.22224043325839285
epoch 50 time used: 6  seconds  train loss: 0.20463871634747854 validation loss: 0.2231494428529375
epoch 51 time used: 6  seconds  train loss: 0.20440433062816446 validation loss: 0.22167089062116518
epoch 52 time used: 6  seconds  train loss: 0.20445184044406936 validation loss: 0.22231170587789925
epoch 53 time used: 6  seconds  train loss: 0.20328897527687823 validation loss: 0.22096698633854686
epoch 54 time used: 6  seconds  train loss: 0.2032340142816094 validation loss: 0.22260163656419438
epoch 55 time used: 6  seconds  train loss: 0.2024170635372087 validation loss: 0.2221506185366369
epoch 56 time used: 6  seconds  train loss: 0.202247177577318 validation loss: 0.22135490502076222
epoch 57 time used: 6  seconds  train loss: 0.2018713063308182 validation loss: 0.22218620361461683
epoch 58 time used: 6  seconds  train loss: 0.20112577287198008 validation loss: 0.2214688325584513
epoch 59 time used: 6  seconds  train loss: 0.20099390992054156 validation loss: 0.2213746819048015
epoch 60 time used: 6  seconds  train loss: 0.20028583456080704 validation loss: 0.2205821880002873
epoch 61 time used: 6  seconds  train loss: 0.20014472075134007 validation loss: 0.21790044867373573
epoch 62 time used: 6  seconds  train loss: 0.19943796390571458 validation loss: 0.21737908209417456
epoch 63 time used: 6  seconds  train loss: 0.19927315057485104 validation loss: 0.2198467590573578
epoch 64 time used: 6  seconds  train loss: 0.19900261394862334 validation loss: 0.22055223280711644
epoch 65 time used: 6  seconds  train loss: 0.19888514392178122 validation loss: 0.21774789207299913
epoch 66 time used: 6  seconds  train loss: 0.19792576775359236 validation loss: 0.21929857818249357
epoch 67 time used: 6  seconds  train loss: 0.19811376748195594 validation loss: 0.22036191228622037
epoch 68 time used: 6  seconds  train loss: 0.19785857421911301 validation loss: 0.2191998968108069
epoch 69 time used: 6  seconds  train loss: 0.1971892295363519 validation loss: 0.21715812989459063
epoch 70 time used: 6  seconds  train loss: 0.1968620457310812 validation loss: 0.2174574802228538
epoch 71 time used: 6  seconds  train loss: 0.19599435356691478 validation loss: 0.21612323476325698
epoch 72 time used: 6  seconds  train loss: 0.19600392663082425 validation loss: 0.2179144319812026
epoch 73 time used: 6  seconds  train loss: 0.19530561040700992 validation loss: 0.21892725357108977
epoch 74 time used: 6  seconds  train loss: 0.19502274814362494 validation loss: 0.21598807387840252
epoch 75 time used: 6  seconds  train loss: 0.1949774414733294 validation loss: 0.21572288185681063
epoch 76 time used: 6  seconds  train loss: 0.19415670588256698 validation loss: 0.21480320911712125
epoch 77 time used: 6  seconds  train loss: 0.19412487317646362 validation loss: 0.21644131061490848
epoch 78 time used: 6  seconds  train loss: 0.19374548066739922 validation loss: 0.2145856232539083
epoch 79 time used: 6  seconds  train loss: 0.19368388966589434 validation loss: 0.2153459409867024
epoch 80 time used: 6  seconds  train loss: 0.19284988214197382 validation loss: 0.21546464966354
epoch 81 time used: 6  seconds  train loss: 0.19284631956569995 validation loss: 0.21520056728118497
epoch 82 time used: 6  seconds  train loss: 0.19229025374959838 validation loss: 0.21483154893261464
epoch 83 time used: 6  seconds  train loss: 0.1919940874868349 validation loss: 0.21448486104939096
epoch 84 time used: 6  seconds  train loss: 0.1919816907154279 validation loss: 0.21692342798640507
epoch 85 time used: 6  seconds  train loss: 0.19157510956028037 validation loss: 0.21328311246494122
epoch 86 time used: 6  seconds  train loss: 0.190617360961069 validation loss: 0.21681099835968126
epoch 87 time used: 7  seconds  train loss: 0.19104026097794288 validation loss: 0.21547773126799655
epoch 88 time used: 7  seconds  train loss: 0.1898279538307828 validation loss: 0.21360201103409834
epoch 89 time used: 7  seconds  train loss: 0.1897741186996769 validation loss: 0.21440304551407466
epoch 90 time used: 7  seconds  train loss: 0.18961390537634215 validation loss: 0.21434746028964885
epoch 91 time used: 7  seconds  train loss: 0.18927123396920734 validation loss: 0.2129213178984043
epoch 92 time used: 7  seconds  train loss: 0.18849929530659051 validation loss: 0.21219462951081042
epoch 93 time used: 7  seconds  train loss: 0.18825060910842017 validation loss: 0.21448691756264252
epoch 94 time used: 7  seconds  train loss: 0.1883360337527032 validation loss: 0.21217084262483948
epoch 95 time used: 7  seconds  train loss: 0.18791274105640698 validation loss: 0.21389923464449487
epoch 96 time used: 7  seconds  train loss: 0.18728625693738252 validation loss: 0.2141176660657269
epoch 97 time used: 7  seconds  train loss: 0.18721137176210795 validation loss: 0.21249225641310182
epoch 98 time used: 7  seconds  train loss: 0.186483154484934 validation loss: 0.211103616657423
epoch 99 time used: 7  seconds  train loss: 0.1866858860412372 validation loss: 0.21196906437754154
epoch 100 time used: 7  seconds  train loss: 0.18677400300434568 validation loss: 0.21228170861568169
epoch 101 time used: 7  seconds  train loss: 0.1861345295531892 validation loss: 0.21136703076562538
epoch 102 time used: 7  seconds  train loss: 0.185982067203238 validation loss: 0.2116060589152748
epoch 103 time used: 7  seconds  train loss: 0.18534922382633168 validation loss: 0.21238847932030797
epoch 104 time used: 6  seconds  train loss: 0.18540313109246626 validation loss: 0.21213124096563593
epoch 105 time used: 5  seconds  train loss: 0.18490177615584327 validation loss: 0.21014500811007522
epoch 106 time used: 5  seconds  train loss: 0.18442132500634817 validation loss: 0.21282538046547161
epoch 107 time used: 5  seconds  train loss: 0.18500091079997497 validation loss: 0.21108116075201028
epoch 108 time used: 5  seconds  train loss: 0.18403836428798473 validation loss: 0.21035204220008524
epoch 109 time used: 5  seconds  train loss: 0.18409989764875204 validation loss: 0.21141440643627712
epoch 110 time used: 5  seconds  train loss: 0.183514670483669 validation loss: 0.20910028458763652
epoch 111 time used: 5  seconds  train loss: 0.1832513201947472 validation loss: 0.21094732743056244
epoch 112 time used: 5  seconds  train loss: 0.18286302397042034 validation loss: 0.21217395445991774
epoch 113 time used: 5  seconds  train loss: 0.18302875730376128 validation loss: 0.2096409040029839
epoch 114 time used: 5  seconds  train loss: 0.1821000452002858 validation loss: 0.2099102015962481
epoch 115 time used: 5  seconds  train loss: 0.1825281984624949 validation loss: 0.21095793955644335
epoch 116 time used: 5  seconds  train loss: 0.1820866667388247 validation loss: 0.20941773146237908
epoch 117 time used: 5  seconds  train loss: 0.1822621165438108 validation loss: 0.20823849409529638
epoch 118 time used: 5  seconds  train loss: 0.18152335372008246 validation loss: 0.20979836081615258
epoch 119 time used: 5  seconds  train loss: 0.18125027794764692 validation loss: 0.20937641045738478
epoch 120 time used: 5  seconds  train loss: 0.18140284816067787 validation loss: 0.21074249362918354
epoch 121 time used: 5  seconds  train loss: 0.18068097033227837 validation loss: 0.2099577055630926
epoch 122 time used: 5  seconds  train loss: 0.1806610840324843 validation loss: 0.2079896335338635
epoch 123 time used: 5  seconds  train loss: 0.17978791710833716 validation loss: 0.20894140724243604
epoch 124 time used: 5  seconds  train loss: 0.17963341730241816 validation loss: 0.20884906679510867
epoch 125 time used: 5  seconds  train loss: 0.179855621952194 validation loss: 0.2071048534314291
epoch 126 time used: 5  seconds  train loss: 0.17983537845204847 validation loss: 0.20828409934989126
epoch 127 time used: 5  seconds  train loss: 0.17924840869642392 validation loss: 0.20966312876614038
epoch 128 time used: 5  seconds  train loss: 0.1792266147273591 validation loss: 0.2089651159419377
epoch 129 time used: 5  seconds  train loss: 0.17860291087789673 validation loss: 0.20793493654785059
epoch 130 time used: 5  seconds  train loss: 0.17916410524762147 validation loss: 0.20893642908154525
epoch 131 time used: 5  seconds  train loss: 0.17864066527193728 validation loss: 0.20824526635429483
epoch 132 time used: 5  seconds  train loss: 0.1778814518681967 validation loss: 0.20619486454243124
epoch 133 time used: 5  seconds  train loss: 0.17745667044885566 validation loss: 0.20758165915523744
epoch 134 time used: 5  seconds  train loss: 0.17775680238561842 validation loss: 0.206972867284444
epoch 135 time used: 5  seconds  train loss: 0.17760277696349178 validation loss: 0.20854410111768137
epoch 136 time used: 5  seconds  train loss: 0.17699714868043823 validation loss: 0.20821469929547426
epoch 137 time used: 5  seconds  train loss: 0.17742732993008037 validation loss: 0.21017661899821255
epoch 138 time used: 5  seconds  train loss: 0.17694832466324711 validation loss: 0.20757506233552356
epoch 139 time used: 5  seconds  train loss: 0.176857940276344 validation loss: 0.20723291843942554
epoch 140 time used: 5  seconds  train loss: 0.1769773905860133 validation loss: 0.20824426964256876
epoch 141 time used: 5  seconds  train loss: 0.17577207027865036 validation loss: 0.20571709556438145
epoch 142 time used: 5  seconds  train loss: 0.17593022687859364 validation loss: 0.20712861321819762
epoch 143 time used: 6  seconds  train loss: 0.17584974558067376 validation loss: 0.2072054257630214
epoch 144 time used: 6  seconds  train loss: 0.17601031586873966 validation loss: 0.20593320954478406
epoch 145 time used: 6  seconds  train loss: 0.17576500248871102 validation loss: 0.2066584679564271
epoch 146 time used: 6  seconds  train loss: 0.1756647319762706 validation loss: 0.20660154371008627
epoch 147 time used: 6  seconds  train loss: 0.1757524278069856 validation loss: 0.20781131220489518
epoch 148 time used: 6  seconds  train loss: 0.17488887683814153 validation loss: 0.20744026826744547
epoch 149 time used: 6  seconds  train loss: 0.17461872961572839 validation loss: 0.2055309284297793
epoch 150 time used: 6  seconds  train loss: 0.1747495859086499 validation loss: 0.20545376348481884
epoch 151 time used: 6  seconds  train loss: 0.1746665002875791 validation loss: 0.20747586454892253
epoch 152 time used: 6  seconds  train loss: 0.1742923418863817 validation loss: 0.20576334702614982
epoch 153 time used: 6  seconds  train loss: 0.17398812620313722 validation loss: 0.20553236477251266
epoch 154 time used: 6  seconds  train loss: 0.17382804857643924 validation loss: 0.20522058379867725
epoch 155 time used: 6  seconds  train loss: 0.1738199935994489 validation loss: 0.20943506020378944
epoch 156 time used: 6  seconds  train loss: 0.17365024487015593 validation loss: 0.20709765647658607
epoch 157 time used: 6  seconds  train loss: 0.1733919834996389 validation loss: 0.20765130816870123
epoch 158 time used: 6  seconds  train loss: 0.17310090186431906 validation loss: 0.20818700454810382
epoch 159 time used: 6  seconds  train loss: 0.1732997040430776 validation loss: 0.20466515491570464
epoch 160 time used: 6  seconds  train loss: 0.17258412546468876 validation loss: 0.2068870747541606
epoch 161 time used: 6  seconds  train loss: 0.17229678919232944 validation loss: 0.20880479961038656
epoch 162 time used: 6  seconds  train loss: 0.17316082249775774 validation loss: 0.20617632993751434
epoch 163 time used: 6  seconds  train loss: 0.17233100764854817 validation loss: 0.2061127196004985
epoch 164 time used: 6  seconds  train loss: 0.1726633499044983 validation loss: 0.20771116892134062
epoch 165 time used: 6  seconds  train loss: 0.17244823577230295 validation loss: 0.2062467833586713
epoch 166 time used: 6  seconds  train loss: 0.17179444340318115 validation loss: 0.20437711274120648
epoch 167 time used: 6  seconds  train loss: 0.1715320011049604 validation loss: 0.20529701430254912
epoch 168 time used: 6  seconds  train loss: 0.1716866342513133 validation loss: 0.20615010178571963
epoch 169 time used: 6  seconds  train loss: 0.1714977549014168 validation loss: 0.20472113762626767
epoch 170 time used: 6  seconds  train loss: 0.17097604394381705 validation loss: 0.20601642489671299
epoch 171 time used: 6  seconds  train loss: 0.17124490593045 validation loss: 0.20460391780749362
epoch 172 time used: 6  seconds  train loss: 0.17099387259231297 validation loss: 0.20521825583438089
epoch 173 time used: 6  seconds  train loss: 0.1707587094377972 validation loss: 0.20579500546539706
epoch 174 time used: 6  seconds  train loss: 0.17081587696844971 validation loss: 0.2039082701197367
epoch 175 time used: 6  seconds  train loss: 0.17065094955607416 validation loss: 0.20488908238330705
epoch 176 time used: 6  seconds  train loss: 0.17045251334055544 validation loss: 0.20312784753285063
epoch 177 time used: 6  seconds  train loss: 0.1707146310463289 validation loss: 0.20404820799555565
epoch 178 time used: 6  seconds  train loss: 0.17069991138319737 validation loss: 0.20542139613961602
epoch 179 time used: 6  seconds  train loss: 0.1699894319386886 validation loss: 0.2062375373369071
epoch 180 time used: 6  seconds  train loss: 0.16927530535330002 validation loss: 0.20557593954201092
epoch 181 time used: 6  seconds  train loss: 0.16975159222883024 validation loss: 0.20367862946362886
epoch 182 time used: 6  seconds  train loss: 0.16925664855051434 validation loss: 0.20530080516475716
epoch 183 time used: 6  seconds  train loss: 0.16944367249511993 validation loss: 0.20604434938377744
epoch 184 time used: 6  seconds  train loss: 0.16910760418857085 validation loss: 0.20242961309531451
epoch 185 time used: 6  seconds  train loss: 0.16883255399588085 validation loss: 0.2029878536735476
epoch 186 time used: 6  seconds  train loss: 0.1689902466740582 validation loss: 0.20445976375309455
epoch 187 time used: 6  seconds  train loss: 0.16865605536241948 validation loss: 0.2031590287949246
epoch 188 time used: 6  seconds  train loss: 0.16867417592380088 validation loss: 0.20456025900326658
epoch 189 time used: 6  seconds  train loss: 0.16868886167218589 validation loss: 0.20209745284121036
epoch 190 time used: 6  seconds  train loss: 0.1688482999845359 validation loss: 0.2048170234619109
epoch 191 time used: 6  seconds  train loss: 0.16836611056218026 validation loss: 0.2024501111513536
epoch 192 time used: 6  seconds  train loss: 0.1686546943030601 validation loss: 0.20508981743031615
epoch 193 time used: 6  seconds  train loss: 0.16798606722859555 validation loss: 0.20235308685169448
epoch 194 time used: 6  seconds  train loss: 0.1675959238031789 validation loss: 0.2024994494230898
epoch 195 time used: 6  seconds  train loss: 0.16780190130824593 validation loss: 0.20329082404043902
epoch 196 time used: 6  seconds  train loss: 0.1675695589718429 validation loss: 0.20409004681802653
epoch 197 time used: 6  seconds  train loss: 0.16755605753724037 validation loss: 0.2023872081222224
epoch 198 time used: 6  seconds  train loss: 0.1678319370246709 validation loss: 0.20372545277977153
Early stopping at epoch: 199
YS.shape, YS_pred.shape, (14022, 1, 1, 69) (14022, 1, 1, 69)
YS.shape, YS_pred.shape, (14022, 69) (14022, 69)
****************************************
STGCN2, train, Torch MSE, 1.6481593468e-01, 0.1648159347

STGCN2, train, MSE, RMSE, MAE, MAPE, 377.6547691476, 19.4333416876, 10.9284838312, 15.7643759480

Model Training Ended ... Sun Jan  9 17:30:44 2022
pred_finaltest-NYCTaxi-outflow-onehot3_STGCN2_33_2201091710 testing started Sun Jan  9 17:30:44 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape is (3508, 1, 12, 69)
YS shape is (3508, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3508, 32, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape after is (3508, 33, 12, 69)
YS shape after is (3508, 1, 1, 69)
TEST XS.shape, YS.shape (3508, 33, 12, 69) (3508, 1, 1, 69)
Model Testing Started ... Sun Jan  9 17:30:45 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3508, 1, 1, 69) (3508, 1, 1, 69)
YS.shape, YS_pred.shape, (3508, 69) (3508, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
****************************************
STGCN2, test, Torch MSE, 1.9815287524e-01, 0.1981528752

STGCN2, test, MSE, RMSE, MAE, MAPE, 509.3321720605, 22.5683887786, 12.8639211987, 19.4993139544

Model Testing Ended ... Sun Jan  9 17:30:45 2022
pred_finaltest-NYCTaxi-outflow-onehot3_STGCN3_33_2201091730 training started Sun Jan  9 17:30:45 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14021, 1, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape is (14021, 1, 12, 69)
YS shape is (14021, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14021, 32, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape after is (14021, 33, 12, 69)
YS shape after is (14021, 1, 1, 69)
TRAIN XS.shape YS,shape (14021, 33, 12, 69) (14021, 1, 1, 69)
Model Training Started ... Sun Jan  9 17:30:47 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 6  seconds  train loss: 0.4228724886374478 validation loss: 0.35097165789117285
epoch 1 time used: 6  seconds  train loss: 0.3066541067952242 validation loss: 0.30310664294926154
epoch 2 time used: 6  seconds  train loss: 0.28105514493892664 validation loss: 0.2915023070910422
epoch 3 time used: 6  seconds  train loss: 0.2666009041086874 validation loss: 0.29143348932946267
epoch 4 time used: 6  seconds  train loss: 0.2610719737806031 validation loss: 0.28434625565495686
epoch 5 time used: 7  seconds  train loss: 0.2539219476615407 validation loss: 0.27652142699691
epoch 6 time used: 7  seconds  train loss: 0.25009026109958493 validation loss: 0.2701506798463213
epoch 7 time used: 7  seconds  train loss: 0.24751840833541738 validation loss: 0.26856033044138844
epoch 8 time used: 7  seconds  train loss: 0.24369313696385364 validation loss: 0.2759865021202405
epoch 9 time used: 7  seconds  train loss: 0.2407266344664965 validation loss: 0.2715967723422913
epoch 10 time used: 7  seconds  train loss: 0.24011738607092092 validation loss: 0.26217244141318086
epoch 11 time used: 7  seconds  train loss: 0.23816051008377162 validation loss: 0.26021130775732104
epoch 12 time used: 7  seconds  train loss: 0.23587122895758822 validation loss: 0.26154124153660013
epoch 13 time used: 7  seconds  train loss: 0.23462243923777124 validation loss: 0.26299669713002916
epoch 14 time used: 7  seconds  train loss: 0.23376277848509727 validation loss: 0.261644741721107
epoch 15 time used: 7  seconds  train loss: 0.23277255184863418 validation loss: 0.2577069980871725
epoch 16 time used: 7  seconds  train loss: 0.23230491321561855 validation loss: 0.2530025816004547
epoch 17 time used: 7  seconds  train loss: 0.2319484241950539 validation loss: 0.25120390313255125
epoch 18 time used: 7  seconds  train loss: 0.22930680095352643 validation loss: 0.2507063720866196
epoch 19 time used: 7  seconds  train loss: 0.22855804433039822 validation loss: 0.24742085772688158
epoch 20 time used: 7  seconds  train loss: 0.2274988681699851 validation loss: 0.24751850247757134
epoch 21 time used: 7  seconds  train loss: 0.22756629771233228 validation loss: 0.24617113306463886
epoch 22 time used: 7  seconds  train loss: 0.22671022015691464 validation loss: 0.24635059532273243
epoch 23 time used: 6  seconds  train loss: 0.22611603300677163 validation loss: 0.2440326776986658
epoch 24 time used: 6  seconds  train loss: 0.22506638690902156 validation loss: 0.2544083769533611
epoch 25 time used: 6  seconds  train loss: 0.2241099338928729 validation loss: 0.24993276611370016
epoch 26 time used: 6  seconds  train loss: 0.22348566141002607 validation loss: 0.2444705103661629
epoch 27 time used: 6  seconds  train loss: 0.22351052252776776 validation loss: 0.2469743267169219
epoch 28 time used: 6  seconds  train loss: 0.22394256403576795 validation loss: 0.24487759391376107
epoch 29 time used: 6  seconds  train loss: 0.22166017526265733 validation loss: 0.24426255061907967
epoch 30 time used: 6  seconds  train loss: 0.2217222380305798 validation loss: 0.23967576145071748
epoch 31 time used: 6  seconds  train loss: 0.22043515932280114 validation loss: 0.24295780044824683
epoch 32 time used: 6  seconds  train loss: 0.21988821378992557 validation loss: 0.2364461843840272
epoch 33 time used: 6  seconds  train loss: 0.22072588815376584 validation loss: 0.23836861613710744
epoch 34 time used: 6  seconds  train loss: 0.2188890317985123 validation loss: 0.23758539219141958
epoch 35 time used: 6  seconds  train loss: 0.21873903217205287 validation loss: 0.24103826447615812
epoch 36 time used: 6  seconds  train loss: 0.2172776511759489 validation loss: 0.24035898335511793
epoch 37 time used: 6  seconds  train loss: 0.21701866459255698 validation loss: 0.24622950508672037
epoch 38 time used: 6  seconds  train loss: 0.21631794143741434 validation loss: 0.236158338143223
epoch 39 time used: 6  seconds  train loss: 0.21662810856836565 validation loss: 0.24228981441589198
epoch 40 time used: 6  seconds  train loss: 0.21655733833823718 validation loss: 0.2389794051460178
epoch 41 time used: 6  seconds  train loss: 0.21536228684559683 validation loss: 0.2357948551297664
epoch 42 time used: 6  seconds  train loss: 0.21568426138557126 validation loss: 0.24627429303854992
epoch 43 time used: 6  seconds  train loss: 0.21449210689341475 validation loss: 0.23870830407872992
epoch 44 time used: 6  seconds  train loss: 0.21387602860137778 validation loss: 0.23399327950381035
epoch 45 time used: 7  seconds  train loss: 0.21346201933009407 validation loss: 0.23771177174462907
epoch 46 time used: 7  seconds  train loss: 0.21323441150699954 validation loss: 0.23612365214163686
epoch 47 time used: 7  seconds  train loss: 0.21278617271857733 validation loss: 0.23582456287695758
epoch 48 time used: 7  seconds  train loss: 0.21215877883357337 validation loss: 0.236619110132583
epoch 49 time used: 7  seconds  train loss: 0.21200095230782115 validation loss: 0.23490889083128688
epoch 50 time used: 7  seconds  train loss: 0.2107237023369746 validation loss: 0.23376646321702535
epoch 51 time used: 7  seconds  train loss: 0.20958101346160832 validation loss: 0.23276188326983607
epoch 52 time used: 7  seconds  train loss: 0.21010061998417062 validation loss: 0.23193425188320266
epoch 53 time used: 7  seconds  train loss: 0.20909419031476678 validation loss: 0.23281285473604033
epoch 54 time used: 7  seconds  train loss: 0.20978814833786885 validation loss: 0.23464046198507071
epoch 55 time used: 7  seconds  train loss: 0.20826856072908276 validation loss: 0.23328717885973518
epoch 56 time used: 7  seconds  train loss: 0.20735498650632933 validation loss: 0.23093453597084018
epoch 57 time used: 7  seconds  train loss: 0.20768818809226627 validation loss: 0.23089167157786272
epoch 58 time used: 7  seconds  train loss: 0.20702112423098745 validation loss: 0.228905318645974
epoch 59 time used: 7  seconds  train loss: 0.20699063023138714 validation loss: 0.2308292847256353
epoch 60 time used: 7  seconds  train loss: 0.2064316323750331 validation loss: 0.22888437999838498
epoch 61 time used: 7  seconds  train loss: 0.2056013852318996 validation loss: 0.2311899778728001
epoch 62 time used: 7  seconds  train loss: 0.20674704663385038 validation loss: 0.22965330902977937
epoch 63 time used: 7  seconds  train loss: 0.20521421562412642 validation loss: 0.23219248037030885
epoch 64 time used: 7  seconds  train loss: 0.20420596704134772 validation loss: 0.23441240434570443
epoch 65 time used: 7  seconds  train loss: 0.20405862061838237 validation loss: 0.22813931909106624
epoch 66 time used: 7  seconds  train loss: 0.20420513320793188 validation loss: 0.22627042630061517
epoch 67 time used: 7  seconds  train loss: 0.20311130229584123 validation loss: 0.2295824758797731
epoch 68 time used: 7  seconds  train loss: 0.20239188278930212 validation loss: 0.23049378667942674
epoch 69 time used: 7  seconds  train loss: 0.20343805507024648 validation loss: 0.2314722398588199
epoch 70 time used: 7  seconds  train loss: 0.20167333620804156 validation loss: 0.23287142270031616
epoch 71 time used: 7  seconds  train loss: 0.20143365817230144 validation loss: 0.22685035377213836
epoch 72 time used: 7  seconds  train loss: 0.20117269878594232 validation loss: 0.22970256254425472
epoch 73 time used: 7  seconds  train loss: 0.2007312646343998 validation loss: 0.23251498896464987
epoch 74 time used: 7  seconds  train loss: 0.19981390831522572 validation loss: 0.22804548786459009
epoch 75 time used: 7  seconds  train loss: 0.19950671388576657 validation loss: 0.22683362833649787
Early stopping at epoch: 76
YS.shape, YS_pred.shape, (14021, 1, 1, 69) (14021, 1, 1, 69)
YS.shape, YS_pred.shape, (14021, 69) (14021, 69)
****************************************
STGCN3, train, Torch MSE, 1.9951492816e-01, 0.1995149282

STGCN3, train, MSE, RMSE, MAE, MAPE, 513.1460600280, 22.6527274302, 12.8035488449, 17.5347296495

Model Training Ended ... Sun Jan  9 17:39:35 2022
pred_finaltest-NYCTaxi-outflow-onehot3_STGCN3_33_2201091730 testing started Sun Jan  9 17:39:35 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape is (3507, 1, 12, 69)
YS shape is (3507, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3507, 32, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape after is (3507, 33, 12, 69)
YS shape after is (3507, 1, 1, 69)
TEST XS.shape, YS.shape (3507, 33, 12, 69) (3507, 1, 1, 69)
Model Testing Started ... Sun Jan  9 17:39:36 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3507, 1, 1, 69) (3507, 1, 1, 69)
YS.shape, YS_pred.shape, (3507, 69) (3507, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
****************************************
STGCN3, test, Torch MSE, 2.2181711802e-01, 0.2218171180

STGCN3, test, MSE, RMSE, MAE, MAPE, 709.2086303773, 26.6309712624, 14.7389676992, 21.3135716168

Model Testing Ended ... Sun Jan  9 17:39:37 2022
