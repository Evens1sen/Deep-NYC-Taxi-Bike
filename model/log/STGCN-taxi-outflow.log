nohup: ignoring input
../data-NYCTaxi/30min/bike_taxi_inoutflow.npz
data0:[ 13.   3.  25.  22.  27.  20. 130.  18. 214.  78. 168.  20.  27. 239.
  28.  16. 104.  10.   0.   0.   0. 149.  98. 143.   8.   0.  20.   1.
   0.  78.  60. 130. 213.  46.  75. 130.  44.   3.   0.  96. 229.  80.
  99. 124.  28. 164.  86.   0.   0.   8.  44.   7.  75.   0.  80.  15.
  43. 166. 133. 200.  77. 181.   6.   4.  67. 155.  19.  54. 139.]
data.shape (35088, 69, 4)
pred_METR-LA_STGCN3_2112232320 training started Thu Dec 23 23:20:36 2021
getXSYS data.shape(35088, 69, 4)
getXSYS XS.shape(28056, 4, 12, 69)
getXSYS YS.shape(28056, 1, 1, 69)
TRAIN XS.shape YS,shape (28056, 4, 12, 69) (28056, 1, 1, 69)
Model Training Started ... Thu Dec 23 23:20:36 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 16, 10, 69]          --
|    |    └─align: 3-1                   [-1, 16, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 32, 10, 69]          416
|    └─spatio_conv_layer: 2-2            [-1, 16, 10, 69]          784
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-3                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 64, 8, 69]           3,136
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 16, 6, 69]           --
|    |    └─align: 3-5                   [-1, 16, 8, 69]           1,040
|    |    └─Conv2d: 3-6                  [-1, 32, 6, 69]           6,176
|    └─spatio_conv_layer: 2-7            [-1, 16, 6, 69]           784
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-7                   [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-8                  [-1, 64, 4, 69]           3,136
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-9                   [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-11                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 79,089
Trainable params: 79,089
Non-trainable params: 0
Total mult-adds (M): 8.59
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 1.42
Params size (MB): 0.30
Estimated Total Size (MB): 1.73
==========================================================================================
epoch 0 time used: 8  seconds  train loss: 0.3342248010129869 validation loss: 0.11562567280081218
epoch 1 time used: 7  seconds  train loss: 0.27969144622397435 validation loss: 0.09542540389654607
epoch 2 time used: 7  seconds  train loss: 0.26886566866111394 validation loss: 0.11239383462736809
epoch 3 time used: 10  seconds  train loss: 0.2611500952735618 validation loss: 0.10398578794000153
epoch 4 time used: 10  seconds  train loss: 0.25516540644523245 validation loss: 0.09153913253600147
epoch 5 time used: 10  seconds  train loss: 0.2515829837384392 validation loss: 0.08840426569791271
epoch 6 time used: 9  seconds  train loss: 0.24856143119456672 validation loss: 0.08503047382394778
epoch 7 time used: 9  seconds  train loss: 0.24547602949431288 validation loss: 0.09283642812241916
epoch 8 time used: 9  seconds  train loss: 0.2429222465739036 validation loss: 0.10422294835037134
epoch 9 time used: 9  seconds  train loss: 0.2416932258561185 validation loss: 0.09198322607932487
epoch 10 time used: 9  seconds  train loss: 0.24059095671293065 validation loss: 0.09147664648593577
epoch 11 time used: 9  seconds  train loss: 0.23927324531075814 validation loss: 0.08281023793787164
epoch 12 time used: 8  seconds  train loss: 0.23759288912203275 validation loss: 0.08445648770616848
epoch 13 time used: 7  seconds  train loss: 0.23717217449573952 validation loss: 0.08264115721514192
epoch 14 time used: 8  seconds  train loss: 0.2359518994138636 validation loss: 0.08856465078578024
epoch 15 time used: 8  seconds  train loss: 0.23429764027233554 validation loss: 0.08323034533228602
epoch 16 time used: 7  seconds  train loss: 0.23370072540234021 validation loss: 0.08165862600977414
epoch 17 time used: 7  seconds  train loss: 0.2333656618705985 validation loss: 0.08900333387978504
epoch 18 time used: 7  seconds  train loss: 0.2325856692661379 validation loss: 0.10059759935185139
epoch 19 time used: 7  seconds  train loss: 0.23216371324121687 validation loss: 0.08586238759524945
epoch 20 time used: 7  seconds  train loss: 0.23111234010334214 validation loss: 0.08360767112325188
epoch 21 time used: 8  seconds  train loss: 0.2305503090313726 validation loss: 0.0883916981171977
epoch 22 time used: 7  seconds  train loss: 0.2300212946259673 validation loss: 0.08350380089230643
epoch 23 time used: 7  seconds  train loss: 0.22963121814251217 validation loss: 0.08567594416866556
epoch 24 time used: 8  seconds  train loss: 0.22857619578923133 validation loss: 0.08871404744848282
epoch 25 time used: 7  seconds  train loss: 0.22848775800090054 validation loss: 0.088507217546542
Early stopping at epoch: 26
YS.shape, YS_pred.shape, (28056, 1, 1, 69) (28056, 1, 1, 69)
YS.shape, YS_pred.shape, (28056, 69) (28056, 69)
****************************************
STGCN3, train, Torch MSE, 2.2541602666e-01, 0.2254160267

STGCN3, train, MSE, RMSE, MAE, MAPE, 195.7961799231, 13.9927188181, 7.6165045546, 18.4378763042

Model Training Ended ... Thu Dec 23 23:24:38 2021
pred_METR-LA_STGCN3_2112232320 testing started Thu Dec 23 23:24:38 2021
getXSYS data.shape(35088, 69, 4)
getXSYS XS.shape(7016, 4, 12, 69)
getXSYS YS.shape(7016, 1, 1, 69)
TEST XS.shape, YS.shape (7016, 4, 12, 69) (7016, 1, 1, 69)
Model Testing Started ... Thu Dec 23 23:24:38 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape, (7016, 1, 1, 69) (7016, 1, 1, 69)
YS.shape, YS_pred.shape, (7016, 69) (7016, 69)
****************************************
STGCN3, test, Torch MSE, 1.8604795101e-01, 0.1860479510

STGCN3, test, MSE, RMSE, MAE, MAPE, 179.9264262054, 13.4136656513, 7.7807563002, 61.0945441117

Model Testing Ended ... Thu Dec 23 23:24:44 2021
