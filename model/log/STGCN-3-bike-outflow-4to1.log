nohup: ignoring input
../data-NYCTaxi/30min/bike_taxi_inoutflow.npz
Namespace(adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=4, cpu=1, dataname='METR-LA', epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/30min/bike_taxi_inoutflow.npz', gpu=5, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=1, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (35088, 69, 4)
pred_METR-LA_STGCN3_2112241833 training started Fri Dec 24 18:33:33 2021
getXSYS data.shape(35088, 69, 4)
getXSYS XS.shape(28056, 4, 12, 69)
getXSYS YS.shape(28056, 1, 1, 69)
TRAIN XS.shape YS,shape (28056, 4, 12, 69) (28056, 1, 1, 69)
Model Training Started ... Fri Dec 24 18:33:33 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 16, 10, 69]          --
|    |    └─align: 3-1                   [-1, 16, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 32, 10, 69]          416
|    └─spatio_conv_layer: 2-2            [-1, 16, 10, 69]          784
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-3                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 64, 8, 69]           3,136
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 16, 6, 69]           --
|    |    └─align: 3-5                   [-1, 16, 8, 69]           1,040
|    |    └─Conv2d: 3-6                  [-1, 32, 6, 69]           6,176
|    └─spatio_conv_layer: 2-7            [-1, 16, 6, 69]           784
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-7                   [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-8                  [-1, 64, 4, 69]           3,136
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-9                   [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-11                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 79,089
Trainable params: 79,089
Non-trainable params: 0
Total mult-adds (M): 8.59
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 1.42
Params size (MB): 0.30
Estimated Total Size (MB): 1.73
==========================================================================================
epoch 0 time used: 8  seconds  train loss: 0.2828005059616955 validation loss: 0.3734366573990326
epoch 1 time used: 8  seconds  train loss: 0.23039847491406545 validation loss: 0.3412615393841066
epoch 2 time used: 8  seconds  train loss: 0.21685418095143003 validation loss: 0.3445102560798905
epoch 3 time used: 7  seconds  train loss: 0.20980543398100557 validation loss: 0.3474762084173415
epoch 4 time used: 7  seconds  train loss: 0.20444621264211 validation loss: 0.32651755579999275
epoch 5 time used: 8  seconds  train loss: 0.2007405927237913 validation loss: 0.32574717518200313
epoch 6 time used: 8  seconds  train loss: 0.19886960426211245 validation loss: 0.3273076981875439
epoch 7 time used: 9  seconds  train loss: 0.19621781164749832 validation loss: 0.3199127296929622
epoch 8 time used: 8  seconds  train loss: 0.19447375451519588 validation loss: 0.32156007834435324
epoch 9 time used: 8  seconds  train loss: 0.19315564347127337 validation loss: 0.3243901611377209
epoch 10 time used: 7  seconds  train loss: 0.1911969439255652 validation loss: 0.32842904105803755
epoch 11 time used: 8  seconds  train loss: 0.19161102293773438 validation loss: 0.32009686157850925
epoch 12 time used: 8  seconds  train loss: 0.19036614374245903 validation loss: 0.3235247215552992
epoch 13 time used: 8  seconds  train loss: 0.18923493354566917 validation loss: 0.31890103378151774
epoch 14 time used: 8  seconds  train loss: 0.18807277308228476 validation loss: 0.3158008231459298
epoch 15 time used: 8  seconds  train loss: 0.1873551279809005 validation loss: 0.32199148005626127
epoch 16 time used: 8  seconds  train loss: 0.18696954384093478 validation loss: 0.3146882222135216
epoch 17 time used: 7  seconds  train loss: 0.18716513367540566 validation loss: 0.31274789574311473
epoch 18 time used: 8  seconds  train loss: 0.18527828085201084 validation loss: 0.3197805430683819
epoch 19 time used: 8  seconds  train loss: 0.18556181441230285 validation loss: 0.3088398814575265
epoch 20 time used: 7  seconds  train loss: 0.18460291656482836 validation loss: 0.3249314230818133
epoch 21 time used: 7  seconds  train loss: 0.18439702715566433 validation loss: 0.3170161617509245
epoch 22 time used: 7  seconds  train loss: 0.18379350873068095 validation loss: 0.3107844238305724
epoch 23 time used: 7  seconds  train loss: 0.18321409014751044 validation loss: 0.3211848591004201
epoch 24 time used: 7  seconds  train loss: 0.18302625786824026 validation loss: 0.3110993218398142
epoch 25 time used: 7  seconds  train loss: 0.18316643293802062 validation loss: 0.31068773018283863
epoch 26 time used: 8  seconds  train loss: 0.18210195363007367 validation loss: 0.33605214350917656
epoch 27 time used: 7  seconds  train loss: 0.1823881237647641 validation loss: 0.31468434978965887
epoch 28 time used: 8  seconds  train loss: 0.18170130735339785 validation loss: 0.3179163057001221
Early stopping at epoch: 29
YS.shape, YS_pred.shape, (28056, 1, 1, 69) (28056, 1, 1, 69)
YS.shape, YS_pred.shape, (28056, 69) (28056, 69)
****************************************
STGCN3, train, Torch MSE, 1.8168284434e-01, 0.1816828443

STGCN3, train, MSE, RMSE, MAE, MAPE, 43.1137867089, 6.5661089474, 4.0138158463, 42.3374840852

Model Training Ended ... Fri Dec 24 18:37:47 2021
pred_METR-LA_STGCN3_2112241833 testing started Fri Dec 24 18:37:47 2021
getXSYS data.shape(35088, 69, 4)
getXSYS XS.shape(7016, 4, 12, 69)
getXSYS YS.shape(7016, 1, 1, 69)
TEST XS.shape, YS.shape (7016, 4, 12, 69) (7016, 1, 1, 69)
Model Testing Started ... Fri Dec 24 18:37:47 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
Traceback (most recent call last):
  File "pred_STGCN.py", line 284, in <module>
    main()
  File "pred_STGCN.py", line 280, in main
    testModel(MODELNAME, 'test', testXS, testYS)
  File "pred_STGCN.py", line 211, in testModel
    model.load_state_dict(torch.load(PATH + '/' + name + '.pt'))
  File "/home/cseadmin/mhy/anaconda3/lib/python3.8/site-packages/torch/nn/modules/module.py", line 1482, in load_state_dict
    raise RuntimeError('Error(s) in loading state_dict for {}:\n\t{}'.format(
RuntimeError: Error(s) in loading state_dict for STGCN:
	size mismatch for st_conv1.tconv1.conv.weight: copying a param with shape torch.Size([32, 1, 3, 1]) from checkpoint, the shape in current model is torch.Size([32, 4, 3, 1]).
