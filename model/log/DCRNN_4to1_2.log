nohup: ignoring input
data.shape (17544, 69, 4)
pred_NYC-Taxi_DCRNN_2112252100 training started Sat Dec 25 21:00:21 2021
TRAIN XS.shape YS,shape (14021, 12, 69, 4) (14021, 3, 69, 1)
Model Training Started ... Sat Dec 25 21:00:21 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 69, 64]           --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 69, 64]              39,360
|    |    └─DCGRU_Cell: 3-2              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 69, 64]              73,920
|    |    └─DCGRU_Cell: 3-14             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 69, 64]              (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 69, 4]               --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 69, 64]              39,360
|    |    └─DCGRU_Cell: 3-26             [-1, 69, 64]              73,920
|    └─Linear: 2-1                       [-1, 69, 4]               260
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-2                       [-1, 1, 69]               5
├─DCGRU_Decoder: 1-3                     [-1, 69, 4]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 69, 64]              (recursive)
|    └─Linear: 2-3                       [-1, 69, 4]               (recursive)
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-4                       [-1, 1, 69]               5
├─DCGRU_Decoder: 1-4                     [-1, 69, 4]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 69, 64]              (recursive)
|    └─Linear: 2-5                       [-1, 69, 4]               (recursive)
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-6                       [-1, 1, 69]               5
==========================================================================================
Total params: 226,835
Trainable params: 226,835
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.41
Params size (MB): 0.87
Estimated Total Size (MB): 1.29
==========================================================================================
XS_torch.shape:   torch.Size([14021, 12, 69, 4])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 9  seconds  train loss: 0.48242189514353256 validation loss: 0.37105365254779715
epoch 1 time used: 10  seconds  train loss: 0.36860102892194074 validation loss: 0.3390933886399897
epoch 2 time used: 10  seconds  train loss: 0.3405427979575643 validation loss: 0.32801137151408044
epoch 3 time used: 10  seconds  train loss: 0.32201184354234214 validation loss: 0.3204748268237606
epoch 4 time used: 10  seconds  train loss: 0.30945561950122025 validation loss: 0.3073874391696144
epoch 5 time used: 10  seconds  train loss: 0.2986526011662721 validation loss: 0.3042341444367215
epoch 6 time used: 10  seconds  train loss: 0.29095765842379284 validation loss: 0.2976167051369166
epoch 7 time used: 10  seconds  train loss: 0.2843159869298664 validation loss: 0.2923313048283032
epoch 8 time used: 10  seconds  train loss: 0.2786376533327174 validation loss: 0.28667733894370995
epoch 9 time used: 10  seconds  train loss: 0.27507834638373874 validation loss: 0.2829778462019364
epoch 10 time used: 10  seconds  train loss: 0.26890746554840184 validation loss: 0.27737158446807014
epoch 11 time used: 10  seconds  train loss: 0.26586968927147103 validation loss: 0.27647381250816144
epoch 12 time used: 10  seconds  train loss: 0.26319576550626117 validation loss: 0.2740741624059639
epoch 13 time used: 11  seconds  train loss: 0.2598455095469932 validation loss: 0.2743945542193792
epoch 14 time used: 11  seconds  train loss: 0.25860672568726856 validation loss: 0.26909427860771934
epoch 15 time used: 10  seconds  train loss: 0.25593359725149595 validation loss: 0.2692818275806364
epoch 16 time used: 10  seconds  train loss: 0.2547978225343578 validation loss: 0.2663508102646298
epoch 17 time used: 11  seconds  train loss: 0.25245177749705927 validation loss: 0.26585417008372764
epoch 18 time used: 11  seconds  train loss: 0.2505895383862513 validation loss: 0.26431180918413916
epoch 19 time used: 10  seconds  train loss: 0.24879451522152393 validation loss: 0.269017633001803
epoch 20 time used: 10  seconds  train loss: 0.24814892915160405 validation loss: 0.26179560956041
epoch 21 time used: 11  seconds  train loss: 0.24700424665925866 validation loss: 0.26328004309264713
epoch 22 time used: 10  seconds  train loss: 0.24557984780907668 validation loss: 0.25940911171780406
epoch 23 time used: 10  seconds  train loss: 0.2443307120150139 validation loss: 0.2564907318105442
epoch 24 time used: 11  seconds  train loss: 0.24352448477121608 validation loss: 0.2578231414011799
epoch 25 time used: 11  seconds  train loss: 0.24231647016716812 validation loss: 0.25809884654475973
epoch 26 time used: 11  seconds  train loss: 0.2414954904191145 validation loss: 0.25764824447465906
epoch 27 time used: 11  seconds  train loss: 0.24064333626121662 validation loss: 0.2531865429891835
epoch 28 time used: 11  seconds  train loss: 0.23898048578410183 validation loss: 0.2539093192311878
epoch 29 time used: 11  seconds  train loss: 0.2387761344855641 validation loss: 0.2541961865345546
epoch 30 time used: 10  seconds  train loss: 0.23797264432806048 validation loss: 0.2517948028314338
epoch 31 time used: 10  seconds  train loss: 0.23719136865841747 validation loss: 0.25252270855804343
epoch 32 time used: 11  seconds  train loss: 0.23664550604204576 validation loss: 0.2522554448160252
epoch 33 time used: 10  seconds  train loss: 0.2356038689807684 validation loss: 0.25045719168149466
epoch 34 time used: 10  seconds  train loss: 0.23531643911239025 validation loss: 0.25134140972198926
epoch 35 time used: 11  seconds  train loss: 0.23451518219050577 validation loss: 0.2520748557224317
epoch 36 time used: 10  seconds  train loss: 0.2340699162784834 validation loss: 0.24908138268414184
epoch 37 time used: 10  seconds  train loss: 0.23324557617525343 validation loss: 0.2489087660688029
epoch 38 time used: 10  seconds  train loss: 0.2328533686048867 validation loss: 0.24690664824389486
epoch 39 time used: 10  seconds  train loss: 0.231853125404954 validation loss: 0.24665557655584996
epoch 40 time used: 11  seconds  train loss: 0.2313407326914567 validation loss: 0.2479755752302889
epoch 41 time used: 10  seconds  train loss: 0.23101372265217163 validation loss: 0.24838527863663534
epoch 42 time used: 10  seconds  train loss: 0.23030278684263475 validation loss: 0.24685946171513573
epoch 43 time used: 11  seconds  train loss: 0.23040215036050482 validation loss: 0.2443767325220554
epoch 44 time used: 11  seconds  train loss: 0.228998284946057 validation loss: 0.24462830957452433
epoch 45 time used: 10  seconds  train loss: 0.2285118163321902 validation loss: 0.24299584607940636
epoch 46 time used: 11  seconds  train loss: 0.22875176279289078 validation loss: 0.2429672697324176
epoch 47 time used: 11  seconds  train loss: 0.22834097755569413 validation loss: 0.2436429461070081
epoch 48 time used: 10  seconds  train loss: 0.22751384238913816 validation loss: 0.246098137860698
epoch 49 time used: 10  seconds  train loss: 0.22695657332012698 validation loss: 0.2405332206608701
epoch 50 time used: 11  seconds  train loss: 0.22636112781137685 validation loss: 0.24207445707956315
epoch 51 time used: 10  seconds  train loss: 0.22594706069424209 validation loss: 0.24083337493780607
epoch 52 time used: 10  seconds  train loss: 0.22563885893268232 validation loss: 0.24011046185672996
epoch 53 time used: 11  seconds  train loss: 0.22519508710621156 validation loss: 0.2421628065403026
epoch 54 time used: 10  seconds  train loss: 0.22565696488326173 validation loss: 0.239654044440591
epoch 55 time used: 10  seconds  train loss: 0.2246162817635208 validation loss: 0.23999714811427622
epoch 56 time used: 11  seconds  train loss: 0.22407875066962582 validation loss: 0.23870612988625672
epoch 57 time used: 11  seconds  train loss: 0.22386834875142725 validation loss: 0.23846395858613953
epoch 58 time used: 10  seconds  train loss: 0.22328001969133482 validation loss: 0.23759250202589693
epoch 59 time used: 10  seconds  train loss: 0.22335502084552328 validation loss: 0.23812208676161387
epoch 60 time used: 11  seconds  train loss: 0.22244220451225005 validation loss: 0.23849211243888138
epoch 61 time used: 10  seconds  train loss: 0.22198606960968587 validation loss: 0.23852896476159147
epoch 62 time used: 11  seconds  train loss: 0.22205613272700048 validation loss: 0.2376971723043232
epoch 63 time used: 11  seconds  train loss: 0.22101867994288105 validation loss: 0.23895651472682486
epoch 64 time used: 10  seconds  train loss: 0.22132008984553764 validation loss: 0.2389042387502369
epoch 65 time used: 10  seconds  train loss: 0.22100414240014332 validation loss: 0.23751376914386402
epoch 66 time used: 11  seconds  train loss: 0.22058779516241858 validation loss: 0.2373750578044689
epoch 67 time used: 10  seconds  train loss: 0.21989104065243648 validation loss: 0.23595992324866366
epoch 68 time used: 10  seconds  train loss: 0.2194080269799234 validation loss: 0.23604703701807306
epoch 69 time used: 11  seconds  train loss: 0.21941565166166485 validation loss: 0.23721715007179203
epoch 70 time used: 10  seconds  train loss: 0.21937588358162513 validation loss: 0.2361900156743174
epoch 71 time used: 11  seconds  train loss: 0.21947588387513572 validation loss: 0.23845646791776384
epoch 72 time used: 11  seconds  train loss: 0.2184898885902847 validation loss: 0.23707861721481654
epoch 73 time used: 10  seconds  train loss: 0.21847120645013585 validation loss: 0.23735555680017095
epoch 74 time used: 10  seconds  train loss: 0.21771502143053267 validation loss: 0.234369748823995
epoch 75 time used: 10  seconds  train loss: 0.21770851200863714 validation loss: 0.23495792081984396
epoch 76 time used: 10  seconds  train loss: 0.2170811513998161 validation loss: 0.23693734344522135
epoch 77 time used: 11  seconds  train loss: 0.21685284151679574 validation loss: 0.23447799877275824
epoch 78 time used: 10  seconds  train loss: 0.21692616098724674 validation loss: 0.23880359395292916
epoch 79 time used: 10  seconds  train loss: 0.21627528955756084 validation loss: 0.2363169137165333
epoch 80 time used: 10  seconds  train loss: 0.21611840118792844 validation loss: 0.2342333362245995
epoch 81 time used: 10  seconds  train loss: 0.21590250802906866 validation loss: 0.23446664370541156
epoch 82 time used: 11  seconds  train loss: 0.21546695782475958 validation loss: 0.2353094770645864
epoch 83 time used: 10  seconds  train loss: 0.2155141318936592 validation loss: 0.23547690618874614
epoch 84 time used: 11  seconds  train loss: 0.21531490481148569 validation loss: 0.2344332609136514
epoch 85 time used: 10  seconds  train loss: 0.21465467193012405 validation loss: 0.2329698703966342
epoch 86 time used: 10  seconds  train loss: 0.21485512563973946 validation loss: 0.2327405325154611
epoch 87 time used: 10  seconds  train loss: 0.21447787579862 validation loss: 0.234257098467977
epoch 88 time used: 10  seconds  train loss: 0.21404965457521358 validation loss: 0.23448895461989075
epoch 89 time used: 11  seconds  train loss: 0.2131784371679444 validation loss: 0.2359393286453406
epoch 90 time used: 10  seconds  train loss: 0.21404586148876145 validation loss: 0.2343718660979426
epoch 91 time used: 10  seconds  train loss: 0.2135250984135691 validation loss: 0.23455950229322986
epoch 92 time used: 11  seconds  train loss: 0.21286435303332016 validation loss: 0.23203200922988854
epoch 93 time used: 10  seconds  train loss: 0.2125909241978571 validation loss: 0.23196348201120098
epoch 94 time used: 10  seconds  train loss: 0.2124256968721723 validation loss: 0.23342018000275763
epoch 95 time used: 10  seconds  train loss: 0.21235120575358823 validation loss: 0.23230256137681973
epoch 96 time used: 11  seconds  train loss: 0.21209543480385698 validation loss: 0.232452437944638
epoch 97 time used: 10  seconds  train loss: 0.21161940383880037 validation loss: 0.23186091980081386
epoch 98 time used: 11  seconds  train loss: 0.211424041147103 validation loss: 0.2313971529840675
epoch 99 time used: 11  seconds  train loss: 0.21106073629070968 validation loss: 0.23128572051958976
epoch 100 time used: 10  seconds  train loss: 0.21116773019911297 validation loss: 0.23124645893497597
epoch 101 time used: 10  seconds  train loss: 0.2105962074333501 validation loss: 0.23358511484424113
epoch 102 time used: 11  seconds  train loss: 0.2106151086016202 validation loss: 0.23111155008630485
epoch 103 time used: 11  seconds  train loss: 0.20977682605954232 validation loss: 0.23016278518823916
epoch 104 time used: 10  seconds  train loss: 0.20957996701335224 validation loss: 0.2306088590394138
epoch 105 time used: 10  seconds  train loss: 0.20928789480408044 validation loss: 0.2307399779269169
epoch 106 time used: 11  seconds  train loss: 0.20944252428496976 validation loss: 0.23020535479663645
epoch 107 time used: 10  seconds  train loss: 0.20910902756178537 validation loss: 0.23143453239816567
epoch 108 time used: 10  seconds  train loss: 0.20877980362389506 validation loss: 0.23071110651483553
epoch 109 time used: 11  seconds  train loss: 0.20906281956621206 validation loss: 0.22970738650830352
epoch 110 time used: 10  seconds  train loss: 0.20856968777689672 validation loss: 0.23137274103136113
epoch 111 time used: 10  seconds  train loss: 0.2086903764063114 validation loss: 0.230430346451959
epoch 112 time used: 10  seconds  train loss: 0.20836688445004647 validation loss: 0.23096637672617717
epoch 113 time used: 10  seconds  train loss: 0.20775039944910714 validation loss:/home/cseadmin/mhy/model/DCRNN.py:290: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(rowsum, -0.5).flatten()
 0.22922639850541923
epoch 114 time used: 10  seconds  train loss: 0.207753500576551 validation loss: 0.22884665490794848
epoch 115 time used: 10  seconds  train loss: 0.20746545562108254 validation loss: 0.22917766739862414
epoch 116 time used: 11  seconds  train loss: 0.20702996922891925 validation loss: 0.22884962684381913
epoch 117 time used: 10  seconds  train loss: 0.20703146592836874 validation loss: 0.22946951764859408
epoch 118 time used: 11  seconds  train loss: 0.20601369268563038 validation loss: 0.23026745037493948
epoch 119 time used: 10  seconds  train loss: 0.2061718618797875 validation loss: 0.22907858511514823
epoch 120 time used: 11  seconds  train loss: 0.2065204112293435 validation loss: 0.22853285854568633
epoch 121 time used: 11  seconds  train loss: 0.20610729991942692 validation loss: 0.2291934949309229
epoch 122 time used: 10  seconds  train loss: 0.205640949102384 validation loss: 0.2290483647357105
epoch 123 time used: 10  seconds  train loss: 0.20520419186514988 validation loss: 0.22801049515239458
epoch 124 time used: 10  seconds  train loss: 0.20524322760680386 validation loss: 0.22897301508029802
epoch 125 time used: 10  seconds  train loss: 0.20490466902183715 validation loss: 0.22825905868514768
epoch 126 time used: 10  seconds  train loss: 0.20455292302581904 validation loss: 0.22848072692250362
epoch 127 time used: 11  seconds  train loss: 0.20504682333511368 validation loss: 0.2280514484820744
epoch 128 time used: 10  seconds  train loss: 0.2047530619113578 validation loss: 0.22858993886745255
epoch 129 time used: 9  seconds  train loss: 0.20410720965140877 validation loss: 0.2279219576378108
epoch 130 time used: 9  seconds  train loss: 0.2037740374013738 validation loss: 0.2281806494294747
epoch 131 time used: 9  seconds  train loss: 0.20370257790873017 validation loss: 0.2277244467158625
epoch 132 time used: 9  seconds  train loss: 0.20353233341017102 validation loss: 0.22914641577042788
epoch 133 time used: 9  seconds  train loss: 0.20349992586243296 validation loss: 0.22840983195775452
epoch 134 time used: 9  seconds  train loss: 0.2031909868262045 validation loss: 0.2283474950537434
epoch 135 time used: 9  seconds  train loss: 0.2030052037640585 validation loss: 0.2288246742671242
epoch 136 time used: 9  seconds  train loss: 0.20283912333110507 validation loss: 0.22762414753539048
epoch 137 time used: 9  seconds  train loss: 0.20298576410367897 validation loss: 0.22812751855295316
epoch 138 time used: 9  seconds  train loss: 0.20217570919515568 validation loss: 0.22771541061091274
epoch 139 time used: 9  seconds  train loss: 0.20237100799211197 validation loss: 0.22796880904770006
epoch 140 time used: 9  seconds  train loss: 0.20182303210248534 validation loss: 0.22861908791035296
epoch 141 time used: 9  seconds  train loss: 0.20171622767738384 validation loss: 0.2268015852891848
epoch 142 time used: 9  seconds  train loss: 0.20145468145152198 validation loss: 0.22797354074015458
epoch 143 time used: 9  seconds  train loss: 0.2014240288543981 validation loss: 0.22777652208354904
epoch 144 time used: 9  seconds  train loss: 0.201563531747267 validation loss: 0.2277771743344907
epoch 145 time used: 9  seconds  train loss: 0.20086416477755922 validation loss: 0.22594877102513758
epoch 146 time used: 9  seconds  train loss: 0.20124722532818673 validation loss: 0.2252118025193946
epoch 147 time used: 9  seconds  train loss: 0.20156726919364804 validation loss: 0.22668066683729513
epoch 148 time used: 9  seconds  train loss: 0.20029849244477813 validation loss: 0.22830361641276176
epoch 149 time used: 9  seconds  train loss: 0.19996194652715024 validation loss: 0.22512273840644464
epoch 150 time used: 9  seconds  train loss: 0.20004009817647048 validation loss: 0.22606649869044576
epoch 151 time used: 9  seconds  train loss: 0.20001826526911126 validation loss: 0.22574346202717327
epoch 152 time used: 9  seconds  train loss: 0.19978461797671945 validation loss: 0.22598250479747142
epoch 153 time used: 9  seconds  train loss: 0.19929260823463904 validation loss: 0.2278160058595219
epoch 154 time used: 9  seconds  train loss: 0.19923142876013272 validation loss: 0.22545293050021767
epoch 155 time used: 9  seconds  train loss: 0.19971317691740012 validation loss: 0.22834055893297409
epoch 156 time used: 9  seconds  train loss: 0.19899621026248546 validation loss: 0.22620676182469707
epoch 157 time used: 9  seconds  train loss: 0.19897191776469822 validation loss: 0.22642582989867863
epoch 158 time used: 9  seconds  train loss: 0.19873369621422068 validation loss: 0.2252443483555174
Early stopping at epoch: 159
YS.shape, YS_pred.shape, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
DCRNN, train, Torch MSE, 1.9776708721e-01, 0.1977670872
DCRNN, train, MSE, RMSE, MAE, MAPE, 504.9767200118, 22.4716870753, 12.6683304896, 18.7725353586
Model Training Ended ... Sat Dec 25 21:29:01 2021
pred_NYC-Taxi_DCRNN_2112252100 testing started Sat Dec 25 21:29:01 2021
TEST XS.shape, YS.shape (3507, 12, 69, 4) (3507, 3, 69, 1)
Model Testing Started ... Sat Dec 25 21:29:01 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
YS.shape, YS_pred.shape, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
DCRNN, test, Torch MSE, 2.2347971747e-01, 0.2234797175
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 713.7280740907, 26.7156896615, 14.8949319629, 22.4819976230
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 613.5891532941, 24.7707317876, 13.9197278221, 21.6501536758
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 718.8554005546, 26.8114788953, 14.9257072083, 22.4345134213
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 808.7389977770, 28.4383367618, 15.8393528379, 23.3613175664
Model Testing Ended ... Sat Dec 25 21:29:03 2021
