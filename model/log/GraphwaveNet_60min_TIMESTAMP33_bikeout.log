data.shape (17544, 69)
pred_METR-LA_GraphWaveNet_220109035416 training started Sun Jan  9 03:54:17 2022
TRAIN XS.shape YS,shape (14021, 33, 69, 12) (14021, 3, 69, 1)
Model Training Started ... Sun Jan  9 03:54:19 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv2d: 1-1                            [-1, 32, 69, 13]          1,088
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-1                       [-1, 32, 69, 12]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-2                       [-1, 32, 69, 12]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-3                       [-1, 256, 69, 12]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-4                          [-1, 32, 69, 12]          --
|    |    └─nconv: 3-1                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-2                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-3                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-4                   [-1, 32, 69, 12]          --
|    |    └─linear: 3-5                  [-1, 32, 69, 12]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-5                  [-1, 32, 69, 12]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-6                       [-1, 32, 69, 10]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-7                       [-1, 32, 69, 10]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-8                       [-1, 256, 69, 10]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-9                          [-1, 32, 69, 10]          --
|    |    └─nconv: 3-6                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-7                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-8                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-9                   [-1, 32, 69, 10]          --
|    |    └─linear: 3-10                 [-1, 32, 69, 10]          5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-10                 [-1, 32, 69, 10]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-11                      [-1, 32, 69, 9]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-12                      [-1, 32, 69, 9]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-13                      [-1, 256, 69, 9]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-14                         [-1, 32, 69, 9]           --
|    |    └─nconv: 3-11                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-12                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-13                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-14                  [-1, 32, 69, 9]           --
|    |    └─linear: 3-15                 [-1, 32, 69, 9]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-15                 [-1, 32, 69, 9]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-16                      [-1, 32, 69, 7]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-17                      [-1, 32, 69, 7]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-18                      [-1, 256, 69, 7]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-19                         [-1, 32, 69, 7]           --
|    |    └─nconv: 3-16                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-17                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-18                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-19                  [-1, 32, 69, 7]           --
|    |    └─linear: 3-20                 [-1, 32, 69, 7]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-20                 [-1, 32, 69, 7]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-21                      [-1, 32, 69, 6]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-22                      [-1, 32, 69, 6]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-23                      [-1, 256, 69, 6]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-24                         [-1, 32, 69, 6]           --
|    |    └─nconv: 3-21                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-22                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-23                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-24                  [-1, 32, 69, 6]           --
|    |    └─linear: 3-25                 [-1, 32, 69, 6]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-25                 [-1, 32, 69, 6]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-26                      [-1, 32, 69, 4]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-27                      [-1, 32, 69, 4]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-28                      [-1, 256, 69, 4]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-29                         [-1, 32, 69, 4]           --
|    |    └─nconv: 3-26                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-27                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-28                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-29                  [-1, 32, 69, 4]           --
|    |    └─linear: 3-30                 [-1, 32, 69, 4]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-30                 [-1, 32, 69, 4]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-31                      [-1, 32, 69, 3]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-32                      [-1, 32, 69, 3]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-33                      [-1, 256, 69, 3]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-34                         [-1, 32, 69, 3]           --
|    |    └─nconv: 3-31                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-32                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-33                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-34                  [-1, 32, 69, 3]           --
|    |    └─linear: 3-35                 [-1, 32, 69, 3]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-35                 [-1, 32, 69, 3]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-36                      [-1, 32, 69, 1]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-37                      [-1, 32, 69, 1]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-38                      [-1, 256, 69, 1]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-39                         [-1, 32, 69, 1]           --
|    |    └─nconv: 3-36                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-37                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-38                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-39                  [-1, 32, 69, 1]           --
|    |    └─linear: 3-40                 [-1, 32, 69, 1]           5,152
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-40                 [-1, 32, 69, 1]           64
├─Conv2d: 1-2                            [-1, 512, 69, 1]          131,584
├─Conv2d: 1-3                            [-1, 3, 69, 1]            1,539
==========================================================================================
Total params: 276,803
Trainable params: 276,803
Non-trainable params: 0
Total mult-adds (M): 72.64
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 11.00
Params size (MB): 1.06
Estimated Total Size (MB): 12.16
==========================================================================================
XS_torch.shape:   torch.Size([14021, 33, 69, 12])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 68  seconds  train loss: 0.299619805173451 validation loss: 0.3467037138670972
epoch 1 time used: 69  seconds  train loss: 0.24464867100056428 validation loss: 0.32241667814752545
epoch 2 time used: 492  seconds  train loss: 0.2239318214451641 validation loss: 0.3384643437110283
epoch 3 time used: 538  seconds  train loss: 0.21195782057365223 validation loss: 0.3187019336890032
epoch 4 time used: 374  seconds  train loss: 0.20351987590823223 validation loss: 0.32825328910344
epoch 5 time used: 69  seconds  train loss: 0.19781747284485923 validation loss: 0.3156777111482974
epoch 6 time used: 69  seconds  train loss: 0.19379766660985084 validation loss: 0.31572971715290615
epoch 7 time used: 69  seconds  train loss: 0.19085736309895113 validation loss: 0.31355121427444616
epoch 8 time used: 69  seconds  train loss: 0.1875631751466505 validation loss: 0.31271644163594137
epoch 9 time used: 69  seconds  train loss: 0.18568687417878754 validation loss: 0.3140894178825994
epoch 10 time used: 69  seconds  train loss: 0.18407480287987205 validation loss: 0.3150043658746424
epoch 11 time used: 68  seconds  train loss: 0.18194974254893292 validation loss: 0.32274896832989475
epoch 12 time used: 66  seconds  train loss: 0.17952459391764022 validation loss: 0.31434151435061586
epoch 13 time used: 66  seconds  train loss: 0.1790895828321931 validation loss: 0.3040761577525414
epoch 14 time used: 67  seconds  train loss: 0.17783082285571028 validation loss: 0.3243272665800942
epoch 15 time used: 67  seconds  train loss: 0.17649737358054393 validation loss: 0.3115483949304103
epoch 16 time used: 67  seconds  train loss: 0.17473841091981726 validation loss: 0.31929979119311724
epoch 17 time used: 67  seconds  train loss: 0.17514310110594808 validation loss: 0.313577171672227
epoch 18 time used: 67  seconds  train loss: 0.17349377506751754 validation loss: 0.31921432996503435
epoch 19 time used: 67  seconds  train loss: 0.17149442019391067 validation loss: 0.31827671445918915
epoch 20 time used: 67  seconds  train loss: 0.17086786861076858 validation loss: 0.30584123763810955
epoch 21 time used: 67  seconds  train loss: 0.169503021452067 validation loss: 0.30573339288532564
epoch 22 time used: 67  seconds  train loss: 0.16868764163521163 validation loss: 0.3115010484245527
epoch 23 time used: 67  seconds  train loss: 0.1680084399011728 validation loss: 0.30770224341309826
epoch 24 time used: 67  seconds  train loss: 0.16690611149866727 validation loss: 0.309643819426647
epoch 25 time used: 67  seconds  train loss: 0.16634375089673215 validation loss: 0.30917185046845547
epoch 26 time used: 67  seconds  train loss: 0.16439154766983421 validation loss: 0.312870783103376
epoch 27 time used: 67  seconds  train loss: 0.16453934139971396 validation loss: 0.31250032413638257
epoch 28 time used: 66  seconds  train loss: 0.16407573517541912 validation loss: 0.3102357169423046
epoch 29 time used: 68  seconds  train loss: 0.16245145382518134 validation loss: 0.31558049303153823
epoch 30 time used: 67  seconds  train loss: 0.16186631100940363 validation loss: 0.3101802961831765
epoch 31 time used: 67  seconds  train loss: 0.16230215792027056 validation loss: 0.30875408673245636
epoch 32 time used: 67  seconds  train loss: 0.16127675385458834 validation loss: 0.3114515906800152
Early stopping at epoch: 33
YS.shape, YS_pred.shape before, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape after, (14021, 3, 69) (14021, 3, 69)
YS_pred.shape before (14021, 3, 69)
YS_pred.shape after (14021, 3, 69)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
GraphWaveNet, train, Torch MSE, 1.5742800418e-01, 0.1574280042
GraphWaveNet, train, MSE, RMSE, MAE, MAPE, 139.6801918886, 11.8186374802, 6.6561631406, 40.1748724595
Model Training Ended ... Sun Jan  9 04:54:40 2022
pred_METR-LA_GraphWaveNet_220109035416 testing started Sun Jan  9 04:54:40 2022
TEST XS.shape, YS.shape (3507, 33, 69, 12) (3507, 3, 69, 1)
Model Testing Started ... Sun Jan  9 04:54:41 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape before, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape after, (3507, 3, 69) (3507, 3, 69)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
GraphWaveNet, test, Torch MSE, 3.3405129113e-01, 0.3340512911
all pred steps, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 274.2876611702, 16.5616322013, 9.4599372117, 49.4273748669
1 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 179.5006498442, 13.3977852589, 7.8599178867, 41.3737295970
2 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 289.4664393652, 17.0137132739, 9.6595683240, 50.1819190639
3 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 353.8986454278, 18.8121940620, 10.8603716707, 56.7267097923
Model Testing Ended ... Sun Jan  9 04:55:09 2022
