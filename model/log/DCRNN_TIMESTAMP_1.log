/home/cseadmin/mhy/model/DCRNN.py:300: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(rowsum, -0.5).flatten()
data.shape (17544, 69)
pred_NYC-Taxi_DCRNN_2201030057 training started Mon Jan  3 00:57:17 2022
TRAIN XS.shape YS,shape (14021, 12, 69, 2) (14021, 3, 69, 1)
Model Training Started ... Mon Jan  3 00:57:18 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 69, 64]           --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 69, 64]              38,208
|    |    └─DCGRU_Cell: 3-2              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 69, 64]              73,920
|    |    └─DCGRU_Cell: 3-14             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 69, 64]              (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 69, 1]               --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 69, 64]              37,632
|    |    └─DCGRU_Cell: 3-26             [-1, 69, 64]              73,920
|    └─Linear: 2-1                       [-1, 69, 1]               65
├─DCGRU_Decoder: 1-3                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 69, 64]              (recursive)
|    └─Linear: 2-2                       [-1, 69, 1]               (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 69, 64]              (recursive)
|    └─Linear: 2-3                       [-1, 69, 1]               (recursive)
==========================================================================================
Total params: 223,745
Trainable params: 223,745
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 0.40
Params size (MB): 0.85
Estimated Total Size (MB): 1.26
==========================================================================================
XS_torch.shape:   torch.Size([14021, 12, 69, 2])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 19  seconds  train loss: 0.31892905568683966 validation loss: 0.35705669546426533
epoch 1 time used: 19  seconds  train loss: 0.2474994176678678 validation loss: 0.3489438747754453
epoch 2 time used: 20  seconds  train loss: 0.22927419081412895 validation loss: 0.3430114726440878
epoch 3 time used: 19  seconds  train loss: 0.2168567294323526 validation loss: 0.33914979092066994
epoch 4 time used: 19  seconds  train loss: 0.21274591545095498 validation loss: 0.35110296048032713
epoch 5 time used: 19  seconds  train loss: 0.20782707151077762 validation loss: 0.3114543984055995
epoch 6 time used: 19  seconds  train loss: 0.20543173385008484 validation loss: 0.3333752774131414
epoch 7 time used: 19  seconds  train loss: 0.20154126138126652 validation loss: 0.31942047422706094
epoch 8 time used: 19  seconds  train loss: 0.19824492966833354 validation loss: 0.30629694883441216
epoch 9 time used: 19  seconds  train loss: 0.19714424716151419 validation loss: 0.3262946147172028
epoch 10 time used: 19  seconds  train loss: 0.1954655910270938 validation loss: 0.31862327847491656
epoch 11 time used: 19  seconds  train loss: 0.19337736557954135 validation loss: 0.3240074093894012
epoch 12 time used: 19  seconds  train loss: 0.19076494123868068 validation loss: 0.316351677595515
epoch 13 time used: 19  seconds  train loss: 0.1891517044328345 validation loss: 0.3387392165826785
epoch 14 time used: 19  seconds  train loss: 0.1875877300593765 validation loss: 0.3193189044442098
epoch 15 time used: 19  seconds  train loss: 0.1865675845002755 validation loss: 0.31320481503002995
epoch 16 time used: 18  seconds  train loss: 0.18544980606661193 validation loss: 0.30874113895793814
epoch 17 time used: 19  seconds  train loss: 0.18412108903001953 validation loss: 0.31967840044075463
Early stopping at epoch: 18
YS.shape, YS_pred.shape, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
DCRNN, train, Torch MSE, 1.8067481518e-01, 0.1806748152
DCRNN, train, MSE, RMSE, MAE, MAPE, 181.0490820529, 13.4554480436, 7.5351503990, 49.2839133076
Model Training Ended ... Mon Jan  3 01:03:37 2022
pred_NYC-Taxi_DCRNN_2201030057 testing started Mon Jan  3 01:03:37 2022
TEST XS.shape, YS.shape (3507, 12, 69, 2) (3507, 3, 69, 1)
Model Testing Started ... Mon Jan  3 01:03:37 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
adj_mx shape is : (69, 69)
YS.shape, YS_pred.shape, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
DCRNN, test, Torch MSE, 3.3681975431e-01, 0.3368197543
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 232.9630910078, 15.2631284804, 9.2245082930, 50.3236717596
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 144.5380066528, 12.0223960446, 7.4368744000, 42.4803435489
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 236.8384363814, 15.3895560814, 9.3567421976, 50.5701732203
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 317.5154501684, 17.8189632181, 10.8799605371, 57.9207284822
Model Testing Ended ... Mon Jan  3 01:03:40 2022
