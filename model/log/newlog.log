nohup: ignoring input
../data-NYCTaxi/30min/bike_taxi_inoutflow.npz
Namespace(adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=4, cpu=1, dataname='METR-LA', epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/30min/bike_taxi_inoutflow.npz', gpu=3, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=1, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (35088, 69, 4)
pred_METR-LA_STGCN3_4_2112241906 training started Fri Dec 24 19:06:16 2021
getXSYS data.shape(35088, 69, 4)
getXSYS XS.shape(28056, 4, 12, 69)
getXSYS YS.shape(28056, 1, 1, 69)
TRAIN XS.shape YS,shape (28056, 4, 12, 69) (28056, 1, 1, 69)
Model Training Started ... Fri Dec 24 19:06:16 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 16, 10, 69]          --
|    |    └─align: 3-1                   [-1, 16, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 32, 10, 69]          416
|    └─spatio_conv_layer: 2-2            [-1, 16, 10, 69]          784
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-3                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 64, 8, 69]           3,136
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 16, 6, 69]           --
|    |    └─align: 3-5                   [-1, 16, 8, 69]           1,040
|    |    └─Conv2d: 3-6                  [-1, 32, 6, 69]           6,176
|    └─spatio_conv_layer: 2-7            [-1, 16, 6, 69]           784
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-7                   [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-8                  [-1, 64, 4, 69]           3,136
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-9                   [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-11                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 79,089
Trainable params: 79,089
Non-trainable params: 0
Total mult-adds (M): 8.59
==========================================================================================
Input size (MB): 0.01
Forward/backward pass size (MB): 1.42
Params size (MB): 0.30
Estimated Total Size (MB): 1.73
==========================================================================================
epoch 0 time used: 8  seconds  train loss: 0.2827383679386321 validation loss: 0.37202747478456555
epoch 1 time used: 7  seconds  train loss: 0.23035846204882782 validation loss: 0.3409948024717124
epoch 2 time used: 8  seconds  train loss: 0.21674200699302085 validation loss: 0.34357158282661765
epoch 3 time used: 8  seconds  train loss: 0.20969159743626486 validation loss: 0.3456549208780147
epoch 4 time used: 8  seconds  train loss: 0.20470224782873683 validation loss: 0.3261955764802188
epoch 5 time used: 8  seconds  train loss: 0.20043029105963397 validation loss: 0.32769725689495055
epoch 6 time used: 8  seconds  train loss: 0.19871027175229486 validation loss: 0.33136307467481574
epoch 7 time used: 7  seconds  train loss: 0.19646678354228905 validation loss: 0.319057510565039
epoch 8 time used: 8  seconds  train loss: 0.1944603389067205 validation loss: 0.31827452390459754
epoch 9 time used: 8  seconds  train loss: 0.19308500959689257 validation loss: 0.32334134088882804
epoch 10 time used: 8  seconds  train loss: 0.19117544553610957 validation loss: 0.32536016952321845
epoch 11 time used: 7  seconds  train loss: 0.19153643865437997 validation loss: 0.31920993846469636
epoch 12 time used: 8  seconds  train loss: 0.18993246127152918 validation loss: 0.3229461326315629
epoch 13 time used: 7  seconds  train loss: 0.1895135159003059 validation loss: 0.32085346400584797
epoch 14 time used: 7  seconds  train loss: 0.18795402169888012 validation loss: 0.31656642584913575
epoch 15 time used: 7  seconds  train loss: 0.18741484230693875 validation loss: 0.32180616725262734
epoch 16 time used: 7  seconds  train loss: 0.1871836119905752 validation loss: 0.31719507409155046
epoch 17 time used: 7  seconds  train loss: 0.1865319305767357 validation loss: 0.3091760492151471
epoch 18 time used: 8  seconds  train loss: 0.1852196594174027 validation loss: 0.31626323102579046
epoch 19 time used: 8  seconds  train loss: 0.1853759064878911 validation loss: 0.3074335498554196
epoch 20 time used: 7  seconds  train loss: 0.18458899955039762 validation loss: 0.3185251899550095
epoch 21 time used: 7  seconds  train loss: 0.18439439303413943 validation loss: 0.3147524499148768
epoch 22 time used: 7  seconds  train loss: 0.18408521870665212 validation loss: 0.3088939402189763
epoch 23 time used: 7  seconds  train loss: 0.18307749606549675 validation loss: 0.320963278935443
epoch 24 time used: 7  seconds  train loss: 0.18271101545030324 validation loss: 0.30981913433307456
epoch 25 time used: 7  seconds  train loss: 0.1832313164804583 validation loss: 0.3090488175517105
epoch 26 time used: 7  seconds  train loss: 0.18237090351877885 validation loss: 0.33240235558017084
epoch 27 time used: 7  seconds  train loss: 0.18236641688894908 validation loss: 0.31400996658208535
epoch 28 time used: 8  seconds  train loss: 0.18170022841682112 validation loss: 0.3132735541446752
Early stopping at epoch: 29
YS.shape, YS_pred.shape, (28056, 1, 1, 69) (28056, 1, 1, 69)
YS.shape, YS_pred.shape, (28056, 69) (28056, 69)
****************************************
STGCN3, train, Torch MSE, 1.8128698291e-01, 0.1812869829

STGCN3, train, MSE, RMSE, MAE, MAPE, 43.5841757781, 6.6018312443, 4.0484344949, 42.3436818399

Model Training Ended ... Fri Dec 24 19:10:27 2021
pred_METR-LA_STGCN3_4_2112241906 testing started Fri Dec 24 19:10:27 2021
getXSYS data.shape(35088, 69, 4)
getXSYS XS.shape(7016, 4, 12, 69)
getXSYS YS.shape(7016, 1, 1, 69)
TEST XS.shape, YS.shape (7016, 4, 12, 69) (7016, 1, 1, 69)
Model Testing Started ... Fri Dec 24 19:10:27 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape, (7016, 1, 1, 69) (7016, 1, 1, 69)
YS.shape, YS_pred.shape, (7016, 69) (7016, 69)
****************************************
STGCN3, test, Torch MSE, 3.6432814831e-01, 0.3643281483

STGCN3, test, MSE, RMSE, MAE, MAPE, 84.0253849799, 9.1665361495, 5.4990172266, 47.7966756268

Model Testing Ended ... Fri Dec 24 19:10:28 2021
