nohup: ignoring input
../data-NYCTaxi/60min/taxi-timestamp-outflow.h5
Namespace(addtime=True, adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=4, dataname='finaltest-NYCTaxi-outflow-onehot', datatype=0, epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/60min/taxi-timestamp-outflow.h5', gpu=7, graphnum=1, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
timestamp shape is (17544, 69, 32)
data.shape (17544, 69)
pred_finaltest-NYCTaxi-outflow-onehot_STGCN1_1_2201090635 training started Sun Jan  9 06:35:00 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14023, 1, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape is (14023, 1, 12, 69)
YS shape is (14023, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14023, 32, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
XS shape after is (14023, 33, 12, 69)
YS shape after is (14023, 1, 1, 69)
TRAIN XS.shape YS,shape (14023, 33, 12, 69) (14023, 1, 1, 69)
Model Training Started ... Sun Jan  9 06:35:04 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.32693239922142653 validation loss: 0.2628846131456422
epoch 1 time used: 4  seconds  train loss: 0.2528607157084062 validation loss: 0.24597516528416277
epoch 2 time used: 4  seconds  train loss: 0.24019137878143992 validation loss: 0.24385671470584153
epoch 3 time used: 4  seconds  train loss: 0.23321452427901382 validation loss: 0.23426417843212893
epoch 4 time used: 4  seconds  train loss: 0.22891201610815845 validation loss: 0.23995546658278463
epoch 5 time used: 4  seconds  train loss: 0.22455634214135817 validation loss: 0.23451079768211042
epoch 6 time used: 4  seconds  train loss: 0.22081449728188907 validation loss: 0.2265511720573569
epoch 7 time used: 4  seconds  train loss: 0.2187596648324284 validation loss: 0.22319348560220095
epoch 8 time used: 4  seconds  train loss: 0.2165379669526387 validation loss: 0.22028666328377405
epoch 9 time used: 4  seconds  train loss: 0.21495252818282096 validation loss: 0.235935616964146
epoch 10 time used: 4  seconds  train loss: 0.21527113686175295 validation loss: 0.2204314392342679
epoch 11 time used: 4  seconds  train loss: 0.21331884920014146 validation loss: 0.21963204694215868
epoch 12 time used: 4  seconds  train loss: 0.21254765348358667 validation loss: 0.2172809568851659
epoch 13 time used: 4  seconds  train loss: 0.2119468229907066 validation loss: 0.22016919414043698
epoch 14 time used: 4  seconds  train loss: 0.21178180440810995 validation loss: 0.21615644870352488
epoch 15 time used: 4  seconds  train loss: 0.20942723514981257 validation loss: 0.22047351922944008
epoch 16 time used: 4  seconds  train loss: 0.20982882016882629 validation loss: 0.2142826098921091
epoch 17 time used: 4  seconds  train loss: 0.20908602835108034 validation loss: 0.21942073421279704
epoch 18 time used: 4  seconds  train loss: 0.20867410663579086 validation loss: 0.2145038437261897
epoch 19 time used: 4  seconds  train loss: 0.20734572145593 validation loss: 0.2144810534159388
epoch 20 time used: 4  seconds  train loss: 0.2070212935080058 validation loss: 0.2166518015448053
epoch 21 time used: 4  seconds  train loss: 0.20685664211090932 validation loss: 0.21339182842138218
epoch 22 time used: 4  seconds  train loss: 0.20682734577706313 validation loss: 0.2145845806231447
epoch 23 time used: 4  seconds  train loss: 0.20553000149147824 validation loss: 0.2139652713461733
epoch 24 time used: 4  seconds  train loss: 0.20509306641497452 validation loss: 0.2229061520616463
epoch 25 time used: 4  seconds  train loss: 0.2058837311483537 validation loss: 0.2106904107726647
epoch 26 time used: 4  seconds  train loss: 0.2041548344500199 validation loss: 0.21078184626983767
epoch 27 time used: 4  seconds  train loss: 0.20320532355934212 validation loss: 0.2105548822379969
epoch 28 time used: 4  seconds  train loss: 0.20380822539378107 validation loss: 0.21208150842090503
epoch 29 time used: 4  seconds  train loss: 0.2027160175005012 validation loss: 0.20967692022859472
epoch 30 time used: 4  seconds  train loss: 0.20223727431983218 validation loss: 0.2137713141599112
epoch 31 time used: 4  seconds  train loss: 0.20267851617925034 validation loss: 0.2118384520020134
epoch 32 time used: 4  seconds  train loss: 0.2013724142444163 validation loss: 0.20930331236487854
epoch 33 time used: 4  seconds  train loss: 0.20146099042873025 validation loss: 0.2103553460076817
epoch 34 time used: 4  seconds  train loss: 0.20078931954107151 validation loss: 0.21322965910111027
epoch 35 time used: 4  seconds  train loss: 0.20048703943798965 validation loss: 0.21128444796926418
epoch 36 time used: 4  seconds  train loss: 0.20002632601385498 validation loss: 0.20857546355679452
epoch 37 time used: 4  seconds  train loss: 0.20007645316306613 validation loss: 0.2081827955523424
epoch 38 time used: 4  seconds  train loss: 0.19941377995601006 validation loss: 0.20766608964458438
epoch 39 time used: 4  seconds  train loss: 0.19920326088051923 validation loss: 0.21056079585689583
epoch 40 time used: 4  seconds  train loss: 0.19887780597419785 validation loss: 0.21336828616776604
epoch 41 time used: 4  seconds  train loss: 0.19836501833036263 validation loss: 0.21176127070232725
epoch 42 time used: 4  seconds  train loss: 0.19808308446951386 validation loss: 0.2096690496103599
epoch 43 time used: 4  seconds  train loss: 0.19730942663178758 validation loss: 0.20772860204738272
epoch 44 time used: 4  seconds  train loss: 0.1974344050048713 validation loss: 0.21169106268705942
epoch 45 time used: 4  seconds  train loss: 0.1969981811715999 validation loss: 0.20831137505416794
epoch 46 time used: 4  seconds  train loss: 0.19620297081167365 validation loss: 0.20764219126766637
epoch 47 time used: 4  seconds  train loss: 0.19592348319685546 validation loss: 0.2047158562654233
epoch 48 time used: 4  seconds  train loss: 0.19598825581450724 validation loss: 0.20736999730688466
epoch 49 time used: 4  seconds  train loss: 0.1949098254717164 validation loss: 0.20799648539039386
epoch 50 time used: 4  seconds  train loss: 0.19527156528361755 validation loss: 0.20492769720822285
epoch 51 time used: 4  seconds  train loss: 0.1938975213355132 validation loss: 0.20514588475363363
epoch 52 time used: 4  seconds  train loss: 0.19354190539808513 validation loss: 0.204656245041356
epoch 53 time used: 4  seconds  train loss: 0.1933124807008224 validation loss: 0.2063310185093507
epoch 54 time used: 4  seconds  train loss: 0.1934238433473559 validation loss: 0.20569070150222496
epoch 55 time used: 4  seconds  train loss: 0.19252405218846835 validation loss: 0.2065825179108741
epoch 56 time used: 4  seconds  train loss: 0.1925274930426816 validation loss: 0.206931325448151
epoch 57 time used: 4  seconds  train loss: 0.1919699075023819 validation loss: 0.2043380057274513
epoch 58 time used: 4  seconds  train loss: 0.19150401873372877 validation loss: 0.2062726308125737
epoch 59 time used: 4  seconds  train loss: 0.19118529717030328 validation loss: 0.20475383239749903
epoch 60 time used: 4  seconds  train loss: 0.19088605103593778 validation loss: 0.20378395560565704
epoch 61 time used: 4  seconds  train loss: 0.19056384563446044 validation loss: 0.20416934104796755
epoch 62 time used: 4  seconds  train loss: 0.18986174316307153 validation loss: 0.2030691860729262
epoch 63 time used: 4  seconds  train loss: 0.19003871233849964 validation loss: 0.2027360739040837
epoch 64 time used: 4  seconds  train loss: 0.18953761359541613 validation loss: 0.2029820743946096
epoch 65 time used: 4  seconds  train loss: 0.18976753356744336 validation loss: 0.2012342471890768
epoch 66 time used: 5  seconds  train loss: 0.1884141461433389 validation loss: 0.2010962239467139
epoch 67 time used: 4  seconds  train loss: 0.18756785849147242 validation loss: 0.2009856710927662
epoch 68 time used: 4  seconds  train loss: 0.18772782156306161 validation loss: 0.20092018267391615
epoch 69 time used: 4  seconds  train loss: 0.1873474207756086 validation loss: 0.2009666889174897
epoch 70 time used: 4  seconds  train loss: 0.18755379543619227 validation loss: 0.20079066969467038
epoch 71 time used: 4  seconds  train loss: 0.18624708523037187 validation loss: 0.20011934232555384
epoch 72 time used: 4  seconds  train loss: 0.18643698343292134 validation loss: 0.20056223313399063
epoch 73 time used: 3  seconds  train loss: 0.18604535304781084 validation loss: 0.2007773058096885
epoch 74 time used: 3  seconds  train loss: 0.18540430720394574 validation loss: 0.20011509459357363
epoch 75 time used: 3  seconds  train loss: 0.18529226909639782 validation loss: 0.2006870320675649
epoch 76 time used: 4  seconds  train loss: 0.18518981720338337 validation loss: 0.19951759510834557
epoch 77 time used: 4  seconds  train loss: 0.18419315137315204 validation loss: 0.20198310029316274
epoch 78 time used: 4  seconds  train loss: 0.18387337348620486 validation loss: 0.2002807006418399
epoch 79 time used: 4  seconds  train loss: 0.18464422035285294 validation loss: 0.1999704940653636
epoch 80 time used: 4  seconds  train loss: 0.18378365283684703 validation loss: 0.19863842262823242
epoch 81 time used: 4  seconds  train loss: 0.18338926330318078 validation loss: 0.20089298517310952
epoch 82 time used: 4  seconds  train loss: 0.18274464443775337 validation loss: 0.19815691912847455
epoch 83 time used: 4  seconds  train loss: 0.18261809447429583 validation loss: 0.199342289866207
epoch 84 time used: 4  seconds  train loss: 0.1820931547501268 validation loss: 0.19788184884406468
epoch 85 time used: 4  seconds  train loss: 0.1819714271910519 validation loss: 0.19896338875811914
epoch 86 time used: 4  seconds  train loss: 0.18161113718319638 validation loss: 0.19862535446287222
epoch 87 time used: 4  seconds  train loss: 0.18078054195025536 validation loss: 0.19704651914184187
epoch 88 time used: 4  seconds  train loss: 0.18148728123552546 validation loss: 0.19768766618529796
epoch 89 time used: 4  seconds  train loss: 0.1809133806846544 validation loss: 0.19783371924945986
epoch 90 time used: 4  seconds  train loss: 0.18011773047936866 validation loss: 0.19877542112462532
epoch 91 time used: 4  seconds  train loss: 0.1806448372112801 validation loss: 0.19762022574833304
epoch 92 time used: 4  seconds  train loss: 0.17958639043564706 validation loss: 0.1969414743877994
epoch 93 time used: 4  seconds  train loss: 0.17879325804082766 validation loss: 0.19662970387792833
epoch 94 time used: 4  seconds  train loss: 0.17909994497713075 validation loss: 0.19775853478187708
epoch 95 time used: 4  seconds  train loss: 0.17859383213296592 validation loss: 0.19747377332795094
epoch 96 time used: 4  seconds  train loss: 0.17900627782506096 validation loss: 0.19731329094153163
epoch 97 time used: 4  seconds  train loss: 0.17825589447897824 validation loss: 0.1956414586210414
epoch 98 time used: 4  seconds  train loss: 0.17802870508948282 validation loss: 0.19560046434504472
epoch 99 time used: 4  seconds  train loss: 0.17804837429678916 validation loss: 0.19589552683654812
epoch 100 time used: 4  seconds  train loss: 0.17731366576270155 validation loss: 0.19796746511052693
epoch 101 time used: 4  seconds  train loss: 0.17723011216596557 validation loss: 0.19617784915824515
epoch 102 time used: 4  seconds  train loss: 0.17693062748914826 validation loss: 0.19438987257170529
epoch 103 time used: 4  seconds  train loss: 0.1763900126032258 validation loss: 0.19377534825055176
epoch 104 time used: 4  seconds  train loss: 0.17616085412061205 validation loss: 0.1951757483035581
epoch 105 time used: 4  seconds  train loss: 0.1760351785699235 validation loss: 0.19332177224699185
epoch 106 time used: 4  seconds  train loss: 0.17572354196336276 validation loss: 0.19662302574360635
epoch 107 time used: 4  seconds  train loss: 0.1758022326541899 validation loss: 0.19438624219661838
epoch 108 time used: 4  seconds  train loss: 0.17484033059180026 validation loss: 0.1944745568483133
epoch 109 time used: 4  seconds  train loss: 0.17486339898836156 validation loss: 0.19518597186019743
epoch 110 time used: 4  seconds  train loss: 0.17459105331672337 validation loss: 0.195538747458545
epoch 111 time used: 4  seconds  train loss: 0.1745058361383211 validation loss: 0.19518558809366895
epoch 112 time used: 4  seconds  train loss: 0.1740978719722768 validation loss: 0.19512391236599555
epoch 113 time used: 4  seconds  train loss: 0.1740270909295397 validation loss: 0.193639744759558
epoch 114 time used: 4  seconds  train loss: 0.17353868756774196 validation loss: 0.19315155817825863
epoch 115 time used: 4  seconds  train loss: 0.17382870323306288 validation loss: 0.19352183753228228
epoch 116 time used: 4  seconds  train loss: 0.17294856766033873 validation loss: 0.19262325330183155
epoch 117 time used: 4  seconds  train loss: 0.17271483918711142 validation loss: 0.19273429151881577
epoch 118 time used: 4  seconds  train loss: 0.17311277402399416 validation loss: 0.19304500614583525
epoch 119 time used: 4  seconds  train loss: 0.17273486288417716 validation loss: 0.19419220123063885
epoch 120 time used: 4  seconds  train loss: 0.17245024407939785 validation loss: 0.1925818105544353
epoch 121 time used: 4  seconds  train loss: 0.17206238005204033 validation loss: 0.19192638724651326
epoch 122 time used: 4  seconds  train loss: 0.1716326292637605 validation loss: 0.1913760828414238
epoch 123 time used: 4  seconds  train loss: 0.17124888304539007 validation loss: 0.192073152378771
epoch 124 time used: 4  seconds  train loss: 0.17148948957401267 validation loss: 0.19191799079494617
epoch 125 time used: 4  seconds  train loss: 0.17139061964082836 validation loss: 0.1908440442083226
epoch 126 time used: 4  seconds  train loss: 0.17073186681391073 validation loss: 0.192472544963606
epoch 127 time used: 4  seconds  train loss: 0.17029153993193852 validation loss: 0.1909933704447216
epoch 128 time used: 4  seconds  train loss: 0.1703061114434994 validation loss: 0.19044192659807288
epoch 129 time used: 4  seconds  train loss: 0.170178354784737 validation loss: 0.19158384995295943
epoch 130 time used: 4  seconds  train loss: 0.17010500895704986 validation loss: 0.19063870265391372
epoch 131 time used: 4  seconds  train loss: 0.17001349455278486 validation loss: 0.19073238360222175
epoch 132 time used: 4  seconds  train loss: 0.16954544632533944 validation loss: 0.18986938070958503
epoch 133 time used: 4  seconds  train loss: 0.1695916295998837 validation loss: 0.19082870125702567
epoch 134 time used: 4  seconds  train loss: 0.16934525547420096 validation loss: 0.19011010474398418
epoch 135 time used: 4  seconds  train loss: 0.16893285795645493 validation loss: 0.1894747780787897
epoch 136 time used: 4  seconds  train loss: 0.16869120166956553 validation loss: 0.19204856193514463
epoch 137 time used: 4  seconds  train loss: 0.168497121846569 validation loss: 0.19047175734572186
epoch 138 time used: 4  seconds  train loss: 0.16833469911426088 validation loss: 0.19015519420419227
epoch 139 time used: 4  seconds  train loss: 0.16779178591306945 validation loss: 0.19019414898469253
epoch 140 time used: 4  seconds  train loss: 0.16823168873738348 validation loss: 0.1896745519626501
epoch 141 time used: 4  seconds  train loss: 0.1677053997865419 validation loss: 0.18878611302586604
epoch 142 time used: 4  seconds  train loss: 0.16755042430726902 validation loss: 0.18877644316679534
epoch 143 time used: 4  seconds  train loss: 0.16755950203637526 validation loss: 0.19066703001635454
epoch 144 time used: 4  seconds  train loss: 0.16741159866034935 validation loss: 0.19015598425474836
epoch 145 time used: 4  seconds  train loss: 0.16723931181110205 validation loss: 0.19055015720847804
epoch 146 time used: 4  seconds  train loss: 0.16727961978974532 validation loss: 0.1904635424622113
epoch 147 time used: 4  seconds  train loss: 0.16698002582317265 validation loss: 0.18948566373830786
epoch 148 time used: 4  seconds  train loss: 0.16672933653737823 validation loss: 0.18767281395159513
epoch 149 time used: 4  seconds  train loss: 0.16626141059175195 validation loss: 0.1881835364778587
epoch 150 time used: 4  seconds  train loss: 0.16607016862750346 validation loss: 0.18919415653805968
epoch 151 time used: 4  seconds  train loss: 0.16587281703900397 validation loss: 0.1887284543299362
epoch 152 time used: 4  seconds  train loss: 0.1656721253898344 validation loss: 0.18783114845420862
epoch 153 time used: 4  seconds  train loss: 0.16554275379009914 validation loss: 0.18784817374915447
epoch 154 time used: 4  seconds  train loss: 0.1651706404844337 validation loss: 0.1883631502126736
epoch 155 time used: 4  seconds  train loss: 0.16509944380252656 validation loss: 0.18726045706750866
epoch 156 time used: 4  seconds  train loss: 0.16515724225411496 validation loss: 0.18718226080578665
epoch 157 time used: 4  seconds  train loss: 0.16508113174731884 validation loss: 0.18724545531285128
epoch 158 time used: 4  seconds  train loss: 0.16465238491596978 validation loss: 0.18690077075601916
epoch 159 time used: 4  seconds  train loss: 0.16464452339365118 validation loss: 0.18804835121392252
epoch 160 time used: 4  seconds  train loss: 0.16451517742099855 validation loss: 0.18665471178289827
epoch 161 time used: 4  seconds  train loss: 0.16435371351222636 validation loss: 0.18762677948745535
epoch 162 time used: 4  seconds  train loss: 0.16398152696134213 validation loss: 0.18702580282093795
epoch 163 time used: 4  seconds  train loss: 0.1640715377060689 validation loss: 0.18663671306725985
epoch 164 time used: 4  seconds  train loss: 0.1637522412978641 validation loss: 0.186082460236971
epoch 165 time used: 4  seconds  train loss: 0.16364233196753258 validation loss: 0.18580964129445762
epoch 166 time used: 4  seconds  train loss: 0.1635635836443089 validation loss: 0.18625033520591375
epoch 167 time used: 4  seconds  train loss: 0.16351989607259132 validation loss: 0.18706839890801016
epoch 168 time used: 4  seconds  train loss: 0.16307419145505606 validation loss: 0.18737655201436992
epoch 169 time used: 4  seconds  train loss: 0.16326915598926062 validation loss: 0.18603144774794647
epoch 170 time used: 4  seconds  train loss: 0.163048513710936 validation loss: 0.1854884423787296
epoch 171 time used: 4  seconds  train loss: 0.16288438174378705 validation loss: 0.18561944980078673
epoch 172 time used: 4  seconds  train loss: 0.1625678741917342 validation loss: 0.1862458041818633
epoch 173 time used: 4  seconds  train loss: 0.1623376442804119 validation loss: 0.1858412408685929
epoch 174 time used: 4  seconds  train loss: 0.1625329533508374 validation loss: 0.18580486019781095
epoch 175 time used: 4  seconds  train loss: 0.16254924722531994 validation loss: 0.18579774375854052
epoch 176 time used: 4  seconds  train loss: 0.16167560985346782 validation loss: 0.18495248876091283
epoch 177 time used: 4  seconds  train loss: 0.1618914515605863 validation loss: 0.18712834939913142
epoch 178 time used: 4  seconds  train loss: 0.16144548950393509 validation loss: 0.18589883412011882
epoch 179 time used: 4  seconds  train loss: 0.16138413268905785 validation loss: 0.1846990975834476
epoch 180 time used: 4  seconds  train loss: 0.1612715295688253 validation loss: 0.18530077396701283
epoch 181 time used: 4  seconds  train loss: 0.16156255400268257 validation loss: 0.18497313195239184
epoch 182 time used: 4  seconds  train loss: 0.1609849189925019 validation loss: 0.1854420489011597
epoch 183 time used: 4  seconds  train loss: 0.16079874695464666 validation loss: 0.1870541483486848
epoch 184 time used: 4  seconds  train loss: 0.16077338469009042 validation loss: 0.18381971733711544
epoch 185 time used: 4  seconds  train loss: 0.16081968729536808 validation loss: 0.18674878592465308
epoch 186 time used: 4  seconds  train loss: 0.16063767468288068 validation loss: 0.18406541982141822
epoch 187 time used: 4  seconds  train loss: 0.16040369737604915 validation loss: 0.18397802666161173
epoch 188 time used: 4  seconds  train loss: 0.1602764141297282 validation loss: 0.1859450445335658
epoch 189 time used: 4  seconds  train loss: 0.16060255758385397 validation loss: 0.18522859731539276
epoch 190 time used: 4  seconds  train loss: 0.16061507095723201 validation loss: 0.18409759197245987
epoch 191 time used: 4  seconds  train loss: 0.1600020754866806 validation loss: 0.18490575037203852
epoch 192 time used: 4  seconds  train loss: 0.160000128914111 validation loss: 0.18421694649945514
epoch 193 time used: 4  seconds  train loss: 0.1597372823356125 validation loss: 0.18368273086025588
epoch 194 time used: 4  seconds  train loss: 0.15986424282545372 validation loss: 0.18326138229419078
epoch 195 time used: 4  seconds  train loss: 0.15935737175628628 validation loss: 0.18463564723203063
epoch 196 time used: 4  seconds  train loss: 0.15924313147085511 validation loss: 0.1854343286375964
epoch 197 time used: 4  seconds  train loss: 0.1595276727823096 validation loss: 0.18410563129768057
epoch 198 time used: 4  seconds  train loss: 0.15905111766046107 validation loss: 0.18382393696684873
epoch 199 time used: 4  seconds  train loss: 0.15916728655205767 validation loss: 0.18371523276642943
YS.shape, YS_pred.shape, (14023, 1, 1, 69) (14023, 1, 1, 69)
YS.shape, YS_pred.shape, (14023, 69) (14023, 69)
****************************************
STGCN1, train, Torch MSE, 1.5763242545e-01, 0.1576324254

STGCN1, train, MSE, RMSE, MAE, MAPE, 316.0745883005, 17.7784866707, 10.4190454988, 14.9305350457

Model Training Ended ... Sun Jan  9 06:50:33 2022
pred_finaltest-NYCTaxi-outflow-onehot_STGCN1_1_2201090635 testing started Sun Jan  9 06:50:33 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape is (3509, 1, 12, 69)
YS shape is (3509, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3509, 32, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
XS shape after is (3509, 33, 12, 69)
YS shape after is (3509, 1, 1, 69)
TEST XS.shape, YS.shape (3509, 33, 12, 69) (3509, 1, 1, 69)
Model Testing Started ... Sun Jan  9 06:50:33 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3509, 1, 1, 69) (3509, 1, 1, 69)
YS.shape, YS_pred.shape, (3509, 69) (3509, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
****************************************
STGCN1, test, Torch MSE, 1.7726993888e-01, 0.1772699389

STGCN1, test, MSE, RMSE, MAE, MAPE, 358.6598186474, 18.9383161513, 11.2590207915, 18.0284937833

Model Testing Ended ... Sun Jan  9 06:50:34 2022
pred_finaltest-NYCTaxi-outflow-onehot_STGCN2_33_2201090650 training started Sun Jan  9 06:50:34 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14022, 1, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape is (14022, 1, 12, 69)
YS shape is (14022, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14022, 32, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
XS shape after is (14022, 33, 12, 69)
YS shape after is (14022, 1, 1, 69)
TRAIN XS.shape YS,shape (14022, 33, 12, 69) (14022, 1, 1, 69)
Model Training Started ... Sun Jan  9 06:50:36 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 4  seconds  train loss: 0.3796807083701512 validation loss: 0.3305067495489148
epoch 1 time used: 4  seconds  train loss: 0.28599148163324034 validation loss: 0.2851520070367314
epoch 2 time used: 4  seconds  train loss: 0.2596256388376371 validation loss: 0.27109972677840144
epoch 3 time used: 4  seconds  train loss: 0.2504394409798674 validation loss: 0.2581775945319629
epoch 4 time used: 4  seconds  train loss: 0.2455160489743239 validation loss: 0.2624176156330435
epoch 5 time used: 4  seconds  train loss: 0.24072667771742526 validation loss: 0.2529668522795744
epoch 6 time used: 4  seconds  train loss: 0.2389297437595946 validation loss: 0.25882320181682866
epoch 7 time used: 4  seconds  train loss: 0.23451961628435022 validation loss: 0.24909260819723997
epoch 8 time used: 4  seconds  train loss: 0.2336056945968912 validation loss: 0.24534769999729317
epoch 9 time used: 4  seconds  train loss: 0.2322869359249396 validation loss: 0.24981428336838757
epoch 10 time used: 4  seconds  train loss: 0.23111120644525363 validation loss: 0.24536500435962177
epoch 11 time used: 4  seconds  train loss: 0.22746822913737139 validation loss: 0.24657315369408536
epoch 12 time used: 4  seconds  train loss: 0.22771889596815573 validation loss: 0.2429628981839434
epoch 13 time used: 4  seconds  train loss: 0.2274038110883907 validation loss: 0.23895772720362482
epoch 14 time used: 4  seconds  train loss: 0.22624678238746598 validation loss: 0.24226030080031477
epoch 15 time used: 4  seconds  train loss: 0.22586888604656158 validation loss: 0.23902701036935525
epoch 16 time used: 4  seconds  train loss: 0.2238199063193799 validation loss: 0.24149244727064254
epoch 17 time used: 4  seconds  train loss: 0.22391519678334695 validation loss: 0.2402906300711482
epoch 18 time used: 4  seconds  train loss: 0.22135558568335306 validation loss: 0.2348953175905155
epoch 19 time used: 4  seconds  train loss: 0.22185045385144045 validation loss: 0.23830400967489157
epoch 20 time used: 4  seconds  train loss: 0.2216657100407649 validation loss: 0.2354007991752282
epoch 21 time used: 4  seconds  train loss: 0.22017525546255765 validation loss: 0.23720794972255443
epoch 22 time used: 4  seconds  train loss: 0.2196032261997109 validation loss: 0.23864105110058292
epoch 23 time used: 4  seconds  train loss: 0.21964346007458765 validation loss: 0.2345221462211674
epoch 24 time used: 4  seconds  train loss: 0.2187106542666371 validation loss: 0.23253349067310708
epoch 25 time used: 4  seconds  train loss: 0.21792090664196348 validation loss: 0.23613970224781167
epoch 26 time used: 4  seconds  train loss: 0.21674996175886668 validation loss: 0.22936275125365901
epoch 27 time used: 4  seconds  train loss: 0.2161290706204789 validation loss: 0.23113028099893232
epoch 28 time used: 4  seconds  train loss: 0.21613981899844764 validation loss: 0.23196705630079922
epoch 29 time used: 4  seconds  train loss: 0.21616011770539748 validation loss: 0.23294664496907627
epoch 30 time used: 4  seconds  train loss: 0.21513531878876 validation loss: 0.2287293040303591
epoch 31 time used: 4  seconds  train loss: 0.214838579952916 validation loss: 0.2296887872070159
epoch 32 time used: 4  seconds  train loss: 0.21345007982767245 validation loss: 0.22715007902653778
epoch 33 time used: 4  seconds  train loss: 0.2134551613094638 validation loss: 0.23151459609074926
epoch 34 time used: 4  seconds  train loss: 0.21269364800519452 validation loss: 0.22752204156574765
epoch 35 time used: 4  seconds  train loss: 0.21120137221457197 validation loss: 0.22541210102953368
epoch 36 time used: 4  seconds  train loss: 0.21214849368795632 validation loss: 0.22764688109712333
epoch 37 time used: 4  seconds  train loss: 0.2105043523237674 validation loss: 0.22548624529746078
epoch 38 time used: 4  seconds  train loss: 0.2107346603790038 validation loss: 0.22551027951890648
epoch 39 time used: 4  seconds  train loss: 0.21006384877293235 validation loss: 0.22606646771507133
epoch 40 time used: 4  seconds  train loss: 0.21042150306142002 validation loss: 0.2320723138107821
epoch 41 time used: 4  seconds  train loss: 0.20938999104474554 validation loss: 0.22511091761193272
epoch 42 time used: 4  seconds  train loss: 0.20850437333506297 validation loss: 0.22677632814397555
epoch 43 time used: 4  seconds  train loss: 0.20811731083433516 validation loss: 0.22409956434319786
epoch 44 time used: 4  seconds  train loss: 0.20728602458502982 validation loss: 0.2227604934064851
epoch 45 time used: 4  seconds  train loss: 0.20736687585659255 validation loss: 0.22321891351148732
epoch 46 time used: 4  seconds  train loss: 0.20679369950675375 validation loss: 0.22295533948568907
epoch 47 time used: 4  seconds  train loss: 0.20719966584356114 validation loss: 0.22358485891420501
epoch 48 time used: 4  seconds  train loss: 0.2057749750608045 validation loss: 0.22082603583829577
epoch 49 time used: 4  seconds  train loss: 0.2050365680977927 validation loss: 0.22294891170447578
epoch 50 time used: 4  seconds  train loss: 0.20473608782558805 validation loss: 0.22420338801805864
epoch 51 time used: 4  seconds  train loss: 0.20449972586907134 validation loss: 0.22079672956391871
epoch 52 time used: 4  seconds  train loss: 0.20454673298667 validation loss: 0.2209261933429814
epoch 53 time used: 4  seconds  train loss: 0.20340046637705753 validation loss: 0.22093856105176096
epoch 54 time used: 4  seconds  train loss: 0.20337922670835581 validation loss: 0.22207741575348533
epoch 55 time used: 4  seconds  train loss: 0.20214654879694766 validation loss: 0.2230304973130898
epoch 56 time used: 4  seconds  train loss: 0.2020885429949076 validation loss: 0.2210563098235057
epoch 57 time used: 4  seconds  train loss: 0.20199699835178175 validation loss: 0.21977713580003685
epoch 58 time used: 4  seconds  train loss: 0.20107588725666592 validation loss: 0.2197969216689748
epoch 59 time used: 4  seconds  train loss: 0.2011991654389042 validation loss: 0.22015344344304755
epoch 60 time used: 4  seconds  train loss: 0.2002329953553498 validation loss: 0.21974031973143543
epoch 61 time used: 4  seconds  train loss: 0.19944549175761947 validation loss: 0.219992496817029
epoch 62 time used: 4  seconds  train loss: 0.19960642036705498 validation loss: 0.22024594759063862
epoch 63 time used: 4  seconds  train loss: 0.19904227494557064 validation loss: 0.22168408850228113
epoch 64 time used: 4  seconds  train loss: 0.19891507878665168 validation loss: 0.21858006359608734
epoch 65 time used: 4  seconds  train loss: 0.19821514457656114 validation loss: 0.21877955966212037
epoch 66 time used: 4  seconds  train loss: 0.19743469191949073 validation loss: 0.21910224992652247
epoch 67 time used: 4  seconds  train loss: 0.1977020367337513 validation loss: 0.2197648465667394
epoch 68 time used: 4  seconds  train loss: 0.1971056142651721 validation loss: 0.22098953333400143
epoch 69 time used: 4  seconds  train loss: 0.19619885338058157 validation loss: 0.21783510286571364
epoch 70 time used: 4  seconds  train loss: 0.19623987782345453 validation loss: 0.21631753298465142
epoch 71 time used: 4  seconds  train loss: 0.195704439832117 validation loss: 0.21732436562529714
epoch 72 time used: 4  seconds  train loss: 0.1954576771796522 validation loss: 0.21709789554187386
epoch 73 time used: 4  seconds  train loss: 0.19444710174261945 validation loss: 0.21971707232190213
epoch 74 time used: 4  seconds  train loss: 0.1942568858038661 validation loss: 0.21480236397562066
epoch 75 time used: 4  seconds  train loss: 0.19432322981183847 validation loss: 0.21595709367574994
epoch 76 time used: 4  seconds  train loss: 0.19340452169505315 validation loss: 0.21525804527609674
epoch 77 time used: 4  seconds  train loss: 0.19310954382691836 validation loss: 0.2154783592333606
epoch 78 time used: 4  seconds  train loss: 0.19342127245483387 validation loss: 0.21475907915398793
epoch 79 time used: 4  seconds  train loss: 0.19310129752868602 validation loss: 0.21507497242329396
epoch 80 time used: 4  seconds  train loss: 0.19171131627733 validation loss: 0.21493208459357976
epoch 81 time used: 4  seconds  train loss: 0.19201835727854885 validation loss: 0.21433723680951292
epoch 82 time used: 4  seconds  train loss: 0.19157734923310651 validation loss: 0.21567810590751363
epoch 83 time used: 4  seconds  train loss: 0.1915488441983551 validation loss: 0.21527599571809317
epoch 84 time used: 4  seconds  train loss: 0.19066193728864178 validation loss: 0.21603732423073757
epoch 85 time used: 4  seconds  train loss: 0.1904932592640744 validation loss: 0.21380824021489295
epoch 86 time used: 4  seconds  train loss: 0.18926183903180394 validation loss: 0.21716046167555633
epoch 87 time used: 4  seconds  train loss: 0.18985012121670441 validation loss: 0.21416037672088273
epoch 88 time used: 4  seconds  train loss: 0.18903319320601758 validation loss: 0.21452762484040452
epoch 89 time used: 4  seconds  train loss: 0.1886251542548094 validation loss: 0.21352922979315145
epoch 90 time used: 4  seconds  train loss: 0.18820720269993083 validation loss: 0.21464889281080304
epoch 91 time used: 4  seconds  train loss: 0.18821742884011322 validation loss: 0.21132759995550274
epoch 92 time used: 4  seconds  train loss: 0.18786140511200902 validation loss: 0.21148561388339168
epoch 93 time used: 4  seconds  train loss: 0.18807023028618491 validation loss: 0.21290797809499099
epoch 94 time used: 4  seconds  train loss: 0.18688450570172188 validation loss: 0.21242376997072357
epoch 95 time used: 4  seconds  train loss: 0.18705965050596587 validation loss: 0.21489360729626636
epoch 96 time used: 4  seconds  train loss: 0.18643624383198018 validation loss: 0.21375939605308136
epoch 97 time used: 4  seconds  train loss: 0.18620085744546283 validation loss: 0.21333107530764694
epoch 98 time used: 4  seconds  train loss: 0.1861760977627411 validation loss: 0.2124376627491735
epoch 99 time used: 4  seconds  train loss: 0.18588778401477304 validation loss: 0.2127557040722929
epoch 100 time used: 4  seconds  train loss: 0.18545633537455092 validation loss: 0.21128797021955337
epoch 101 time used: 4  seconds  train loss: 0.1854656417758106 validation loss: 0.21171791774167106
epoch 102 time used: 4  seconds  train loss: 0.18482967458282185 validation loss: 0.21137570583405524
epoch 103 time used: 4  seconds  train loss: 0.1843833809136878 validation loss: 0.21333439712754265
epoch 104 time used: 4  seconds  train loss: 0.1843321113826321 validation loss: 0.21234490839298018
epoch 105 time used: 4  seconds  train loss: 0.18368607351633998 validation loss: 0.2113187521254071
epoch 106 time used: 4  seconds  train loss: 0.18349742289544202 validation loss: 0.21394318869232248
epoch 107 time used: 4  seconds  train loss: 0.18364279879651352 validation loss: 0.21009841733025064
epoch 108 time used: 4  seconds  train loss: 0.18316637767450433 validation loss: 0.21022814809766008
epoch 109 time used: 4  seconds  train loss: 0.18275166754545175 validation loss: 0.20943565217855653
epoch 110 time used: 4  seconds  train loss: 0.18237453677250262 validation loss: 0.20938140616305406
epoch 111 time used: 4  seconds  train loss: 0.1822443015576478 validation loss: 0.21031304785882957
epoch 112 time used: 4  seconds  train loss: 0.1822138102317519 validation loss: 0.21202842348042175
epoch 113 time used: 4  seconds  train loss: 0.181850363180917 validation loss: 0.21081987556327225
epoch 114 time used: 4  seconds  train loss: 0.1816562173836621 validation loss: 0.21164150978929985
epoch 115 time used: 4  seconds  train loss: 0.1817508685940081 validation loss: 0.21103274506871114
epoch 116 time used: 4  seconds  train loss: 0.18044969473270675 validation loss: 0.20929089237877932
epoch 117 time used: 4  seconds  train loss: 0.18106337548351606 validation loss: 0.20887294933582398
epoch 118 time used: 4  seconds  train loss: 0.1803466041320907 validation loss: 0.20852430726688928
epoch 119 time used: 4  seconds  train loss: 0.18069487369500664 validation loss: 0.2087760363656048
epoch 120 time used: 5  seconds  train loss: 0.18033708129173795 validation loss: 0.2101927947569628
epoch 121 time used: 5  seconds  train loss: 0.17983769730786472 validation loss: 0.21087532749328353
epoch 122 time used: 5  seconds  train loss: 0.18006617537808114 validation loss: 0.2111393802773252
epoch 123 time used: 5  seconds  train loss: 0.17927166834632716 validation loss: 0.21056943825837618
epoch 124 time used: 4  seconds  train loss: 0.1794840306534298 validation loss: 0.20897500845988817
epoch 125 time used: 4  seconds  train loss: 0.17923721969759215 validation loss: 0.2083860985207952
epoch 126 time used: 4  seconds  train loss: 0.17895702309271888 validation loss: 0.20989781640219266
epoch 127 time used: 4  seconds  train loss: 0.17840506804534495 validation loss: 0.20833838290305934
epoch 128 time used: 4  seconds  train loss: 0.1778671170021388 validation loss: 0.2090017469318268
epoch 129 time used: 4  seconds  train loss: 0.1783674416368423 validation loss: 0.20856460305839283
epoch 130 time used: 4  seconds  train loss: 0.17832185318290444 validation loss: 0.20982223362393604
epoch 131 time used: 4  seconds  train loss: 0.17760233793731656 validation loss: 0.20715150483594374
epoch 132 time used: 4  seconds  train loss: 0.17758098404986009 validation loss: 0.2077314717662178
epoch 133 time used: 4  seconds  train loss: 0.1770627288766766 validation loss: 0.20735165504850256
epoch 134 time used: 4  seconds  train loss: 0.1769156936015328 validation loss: 0.21039345338558105
epoch 135 time used: 4  seconds  train loss: 0.17652220689066953 validation loss: 0.2078809888445848
epoch 136 time used: 4  seconds  train loss: 0.1765379089130653 validation loss: 0.20782258458907307
epoch 137 time used: 5  seconds  train loss: 0.176584297012453 validation loss: 0.20971284635870782
epoch 138 time used: 5  seconds  train loss: 0.1761836105339276 validation loss: 0.2075095942240746
epoch 139 time used: 5  seconds  train loss: 0.17654977215634493 validation loss: 0.20734342751643076
epoch 140 time used: 5  seconds  train loss: 0.1766187176952464 validation loss: 0.2072298812036574
epoch 141 time used: 5  seconds  train loss: 0.17552640149578586 validation loss: 0.20681913195340482
epoch 142 time used: 4  seconds  train loss: 0.17540635718252093 validation loss: 0.20601527832333727
epoch 143 time used: 4  seconds  train loss: 0.175218382397115 validation loss: 0.20605900137341504
epoch 144 time used: 4  seconds  train loss: 0.17480315607138588 validation loss: 0.20669901088789674
epoch 145 time used: 4  seconds  train loss: 0.1751289411884948 validation loss: 0.2069429814288498
epoch 146 time used: 4  seconds  train loss: 0.17489181681939137 validation loss: 0.20564790683784148
epoch 147 time used: 4  seconds  train loss: 0.17520487905447402 validation loss: 0.20809168386853769
epoch 148 time used: 4  seconds  train loss: 0.17436561057776304 validation loss: 0.20569316243792152
epoch 149 time used: 4  seconds  train loss: 0.17426683899777007 validation loss: 0.20552934748712975
epoch 150 time used: 4  seconds  train loss: 0.17420220913951345 validation loss: 0.2058049323503725
epoch 151 time used: 4  seconds  train loss: 0.1738030852716392 validation loss: 0.20628028921039188
epoch 152 time used: 4  seconds  train loss: 0.17357768729172435 validation loss: 0.20779485422512226
epoch 153 time used: 4  seconds  train loss: 0.17375762906262243 validation loss: 0.20605894498191285
epoch 154 time used: 4  seconds  train loss: 0.17395689577648835 validation loss: 0.2071161712841245
epoch 155 time used: 4  seconds  train loss: 0.1734789656207229 validation loss: 0.20733974073284092
epoch 156 time used: 4  seconds  train loss: 0.17302028699034497 validation loss: 0.20630414866408278
epoch 157 time used: 4  seconds  train loss: 0.17246165431836133 validation loss: 0.20777605604901017
epoch 158 time used: 4  seconds  train loss: 0.17289174455420314 validation loss: 0.2072978274725671
epoch 159 time used: 4  seconds  train loss: 0.17263902193036307 validation loss: 0.2053409304386945
epoch 160 time used: 4  seconds  train loss: 0.17234100744144015 validation loss: 0.2067432375003186
epoch 161 time used: 4  seconds  train loss: 0.17199571240850917 validation loss: 0.20736966019892653
epoch 162 time used: 4  seconds  train loss: 0.17180679685081923 validation loss: 0.20460030352362074
epoch 163 time used: 4  seconds  train loss: 0.17187627384949064 validation loss: 0.2063844752818329
epoch 164 time used: 4  seconds  train loss: 0.17169089948735558 validation loss: 0.20595637005496148
epoch 165 time used: 4  seconds  train loss: 0.17200742206987207 validation loss: 0.20603111427950982
epoch 166 time used: 4  seconds  train loss: 0.17143618920480178 validation loss: 0.20411588331494274
epoch 167 time used: 4  seconds  train loss: 0.1713508855260296 validation loss: 0.2052775187724941
epoch 168 time used: 4  seconds  train loss: 0.17122500334370738 validation loss: 0.20511940500767517
epoch 169 time used: 4  seconds  train loss: 0.171191210624194 validation loss: 0.20511712652407438
epoch 170 time used: 4  seconds  train loss: 0.17055157547800998 validation loss: 0.20587778513049373
epoch 171 time used: 4  seconds  train loss: 0.17057778354776995 validation loss: 0.20596132196668754
epoch 172 time used: 4  seconds  train loss: 0.17023858373468667 validation loss: 0.20532312429910107
epoch 173 time used: 4  seconds  train loss: 0.17037988797635414 validation loss: 0.20418502579093048
epoch 174 time used: 4  seconds  train loss: 0.17047318001837572 validation loss: 0.20443021555798296
epoch 175 time used: 4  seconds  train loss: 0.17005260201025751 validation loss: 0.2037383851176048
epoch 176 time used: 4  seconds  train loss: 0.16983200214959288 validation loss: 0.20460039986689568
epoch 177 time used: 4  seconds  train loss: 0.16989110523894185 validation loss: 0.20354521544878645
epoch 178 time used: 4  seconds  train loss: 0.1698643363552539 validation loss: 0.20336571032329076
epoch 179 time used: 4  seconds  train loss: 0.1695822434248906 validation loss: 0.20688520656676546
epoch 180 time used: 4  seconds  train loss: 0.16931122264391596 validation loss: 0.20484090418354553
epoch 181 time used: 4  seconds  train loss: 0.16917614221004473 validation loss: 0.20349470581657467
epoch 182 time used: 4  seconds  train loss: 0.1690967304897596 validation loss: 0.20375868530186395
epoch 183 time used: 4  seconds  train loss: 0.16891881256472152 validation loss: 0.20542801855396559
epoch 184 time used: 4  seconds  train loss: 0.1689098187696381 validation loss: 0.2038341027562848
epoch 185 time used: 4  seconds  train loss: 0.16889120136887958 validation loss: 0.20308787679577037
epoch 186 time used: 4  seconds  train loss: 0.16867141927577958 validation loss: 0.20422481597999947
epoch 187 time used: 4  seconds  train loss: 0.1683608823885437 validation loss: 0.20401092359867357
epoch 188 time used: 4  seconds  train loss: 0.16845010833860133 validation loss: 0.20438036700010437
epoch 189 time used: 4  seconds  train loss: 0.16824783035013144 validation loss: 0.20297619850038462
epoch 190 time used: 4  seconds  train loss: 0.16803273465704516 validation loss: 0.20357019668875323
epoch 191 time used: 4  seconds  train loss: 0.1679036606967629 validation loss: 0.2040000565379807
epoch 192 time used: 4  seconds  train loss: 0.16804641161054162 validation loss: 0.20393218863404824
epoch 193 time used: 4  seconds  train loss: 0.16816342759102265 validation loss: 0.2022913826987598
epoch 194 time used: 4  seconds  train loss: 0.16803400030719282 validation loss: 0.20316827609174537
epoch 195 time used: 4  seconds  train loss: 0.16736555599269506 validation loss: 0.20353277555480387
epoch 196 time used: 4  seconds  train loss: 0.1675334419177344 validation loss: 0.20413882534842592
epoch 197 time used: 4  seconds  train loss: 0.16706056648263995 validation loss: 0.2022504411591031
epoch 198 time used: 4  seconds  train loss: 0.16709792305976431 validation loss: 0.2028256204729412
epoch 199 time used: 4  seconds  train loss: 0.16680945736829067 validation loss: 0.20178846485330523
YS.shape, YS_pred.shape, (14022, 1, 1, 69) (14022, 1, 1, 69)
YS.shape, YS_pred.shape, (14022, 69) (14022, 69)
****************************************
STGCN2, train, Torch MSE, 1.6453184850e-01, 0.1645318485

STGCN2, train, MSE, RMSE, MAE, MAPE, 376.1890013819, 19.3955923184, 10.9061209491, 15.9148966327

Model Training Ended ... Sun Jan  9 07:06:17 2022
pred_finaltest-NYCTaxi-outflow-onehot_STGCN2_33_2201090650 testing started Sun Jan  9 07:06:17 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape is (3508, 1, 12, 69)
YS shape is (3508, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3508, 32, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
XS shape after is (3508, 33, 12, 69)
YS shape after is (3508, 1, 1, 69)
TEST XS.shape, YS.shape (3508, 33, 12, 69) (3508, 1, 1, 69)
Model Testing Started ... Sun Jan  9 07:06:18 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3508, 1, 1, 69) (3508, 1, 1, 69)
YS.shape, YS_pred.shape, (3508, 69) (3508, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
****************************************
STGCN2, test, Torch MSE, 1.9603346635e-01, 0.1960334663

STGCN2, test, MSE, RMSE, MAE, MAPE, 499.4354369497, 22.3480521959, 12.7821899430, 19.6353249760

Model Testing Ended ... Sun Jan  9 07:06:18 2022
pred_finaltest-NYCTaxi-outflow-onehot_STGCN3_33_2201090706 training started Sun Jan  9 07:06:18 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14021, 1, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape is (14021, 1, 12, 69)
YS shape is (14021, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(14021, 32, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
XS shape after is (14021, 33, 12, 69)
YS shape after is (14021, 1, 1, 69)
TRAIN XS.shape YS,shape (14021, 33, 12, 69) (14021, 1, 1, 69)
Model Training Started ... Sun Jan  9 07:06:21 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          1,088
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          6,400
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 32, 10, 69]          1,056
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-5                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-6                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-7                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-8                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-9       [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 32, 6, 69]           1,056
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-11                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-13                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 106,273
Trainable params: 106,273
Non-trainable params: 0
Total mult-adds (M): 20.41
==========================================================================================
Input size (MB): 0.10
Forward/backward pass size (MB): 2.36
Params size (MB): 0.41
Estimated Total Size (MB): 2.87
==========================================================================================
epoch 0 time used: 4  seconds  train loss: 0.42299758578536173 validation loss: 0.3459983066837922
epoch 1 time used: 4  seconds  train loss: 0.3061598363181532 validation loss: 0.3034432931450933
epoch 2 time used: 4  seconds  train loss: 0.2799637164759022 validation loss: 0.28976389435924804
epoch 3 time used: 4  seconds  train loss: 0.2659111313587452 validation loss: 0.29140333745456465
epoch 4 time used: 4  seconds  train loss: 0.2610482394714716 validation loss: 0.28365273453205975
epoch 5 time used: 4  seconds  train loss: 0.2540651162206291 validation loss: 0.2769678422827348
epoch 6 time used: 4  seconds  train loss: 0.2498602290514202 validation loss: 0.27010813681860346
epoch 7 time used: 4  seconds  train loss: 0.2473685076532513 validation loss: 0.26599534110076345
epoch 8 time used: 4  seconds  train loss: 0.2446125404897714 validation loss: 0.27539542252787574
epoch 9 time used: 4  seconds  train loss: 0.2411620416692153 validation loss: 0.2719041206329398
epoch 10 time used: 4  seconds  train loss: 0.23993500818403996 validation loss: 0.2618200867960131
epoch 11 time used: 4  seconds  train loss: 0.23836056011135895 validation loss: 0.2611766107852161
epoch 12 time used: 4  seconds  train loss: 0.23638845150813553 validation loss: 0.2618308239369411
epoch 13 time used: 4  seconds  train loss: 0.23515318542534264 validation loss: 0.2600372200412065
epoch 14 time used: 4  seconds  train loss: 0.23399963547400632 validation loss: 0.26087548815381234
epoch 15 time used: 4  seconds  train loss: 0.2330175050266177 validation loss: 0.2580745439239046
epoch 16 time used: 4  seconds  train loss: 0.23186774525146434 validation loss: 0.2539634034760122
epoch 17 time used: 4  seconds  train loss: 0.23156016758959808 validation loss: 0.25304573082407067
epoch 18 time used: 4  seconds  train loss: 0.22944331328488735 validation loss: 0.2527248434981685
epoch 19 time used: 4  seconds  train loss: 0.228766803549834 validation loss: 0.2506652902397372
epoch 20 time used: 4  seconds  train loss: 0.22788367345370414 validation loss: 0.24760933273088845
epoch 21 time used: 5  seconds  train loss: 0.22739069519444868 validation loss: 0.2498729984146897
epoch 22 time used: 5  seconds  train loss: 0.22659230534440344 validation loss: 0.2470005472778798
epoch 23 time used: 4  seconds  train loss: 0.22600400762193398 validation loss: 0.2467272134420196
epoch 24 time used: 4  seconds  train loss: 0.22549970388257 validation loss: 0.25387049886715185
epoch 25 time used: 4  seconds  train loss: 0.22423058007316943 validation loss: 0.25153119757524983
epoch 26 time used: 4  seconds  train loss: 0.22368901802325894 validation loss: 0.24609093254148381
epoch 27 time used: 4  seconds  train loss: 0.22345174040085414 validation loss: 0.2454352582174237
epoch 28 time used: 4  seconds  train loss: 0.22414229904979535 validation loss: 0.24505437737999136
epoch 29 time used: 4  seconds  train loss: 0.22176395872632726 validation loss: 0.24520812846222947
epoch 30 time used: 4  seconds  train loss: 0.2216356796096193 validation loss: 0.24046060469275668
epoch 31 time used: 4  seconds  train loss: 0.22084072106410052 validation loss: 0.24254928018389874
epoch 32 time used: 4  seconds  train loss: 0.2203286882328373 validation loss: 0.2411965315962817
epoch 33 time used: 4  seconds  train loss: 0.22066009229757827 validation loss: 0.2415311366353658
epoch 34 time used: 4  seconds  train loss: 0.219129664737781 validation loss: 0.23847724345161517
epoch 35 time used: 4  seconds  train loss: 0.21851756713524056 validation loss: 0.24208963775865977
epoch 36 time used: 4  seconds  train loss: 0.21701772156331528 validation loss: 0.2458232468322421
epoch 37 time used: 4  seconds  train loss: 0.21709013937018692 validation loss: 0.24477359071093427
epoch 38 time used: 4  seconds  train loss: 0.21656215548962307 validation loss: 0.23889553578356912
epoch 39 time used: 4  seconds  train loss: 0.21697969564619615 validation loss: 0.24883892462380056
epoch 40 time used: 4  seconds  train loss: 0.21662881448111862 validation loss: 0.2387054224593668
epoch 41 time used: 4  seconds  train loss: 0.21573000381581356 validation loss: 0.23792290102735086
epoch 42 time used: 4  seconds  train loss: 0.215575299693079 validation loss: 0.2472310463105755
epoch 43 time used: 4  seconds  train loss: 0.21427313557345898 validation loss: 0.23848333445638503
epoch 44 time used: 4  seconds  train loss: 0.21411654612588152 validation loss: 0.23339531292285637
epoch 45 time used: 4  seconds  train loss: 0.21403526637932746 validation loss: 0.23744127328608014
epoch 46 time used: 4  seconds  train loss: 0.21305480400202986 validation loss: 0.23834482759356296
epoch 47 time used: 4  seconds  train loss: 0.21311573252776644 validation loss: 0.23717344728661346
epoch 48 time used: 4  seconds  train loss: 0.2124268179962835 validation loss: 0.23587272450948402
epoch 49 time used: 4  seconds  train loss: 0.21196025964643966 validation loss: 0.23540959152336197
epoch 50 time used: 4  seconds  train loss: 0.2110995829183114 validation loss: 0.23483695042214936
epoch 51 time used: 4  seconds  train loss: 0.20999444113090213 validation loss: 0.23570140805233566
epoch 52 time used: 4  seconds  train loss: 0.2106593758703483 validation loss: 0.2341317565388089
epoch 53 time used: 4  seconds  train loss: 0.2095908786036271 validation loss: 0.23567786411564484
epoch 54 time used: 4  seconds  train loss: 0.20996481036863926 validation loss: 0.23337509006652843
epoch 55 time used: 4  seconds  train loss: 0.20901726827117725 validation loss: 0.2348893254026303
epoch 56 time used: 4  seconds  train loss: 0.20811100434335777 validation loss: 0.2317440565133598
epoch 57 time used: 4  seconds  train loss: 0.2086201012766163 validation loss: 0.23391539909910353
epoch 58 time used: 4  seconds  train loss: 0.20781471689341316 validation loss: 0.23254325172422413
epoch 59 time used: 4  seconds  train loss: 0.2069235187829182 validation loss: 0.23406879342051146
epoch 60 time used: 4  seconds  train loss: 0.20706863174191273 validation loss: 0.2335446258051628
epoch 61 time used: 4  seconds  train loss: 0.2068387411017351 validation loss: 0.23272027731519798
epoch 62 time used: 4  seconds  train loss: 0.2062480235900481 validation loss: 0.23094794009660763
epoch 63 time used: 4  seconds  train loss: 0.20544346800680693 validation loss: 0.23385261338367777
epoch 64 time used: 3  seconds  train loss: 0.20495228286204603 validation loss: 0.24060541221365137
epoch 65 time used: 4  seconds  train loss: 0.20508536131870952 validation loss: 0.23262955687825365
epoch 66 time used: 4  seconds  train loss: 0.20485690981878454 validation loss: 0.23278085014443362
epoch 67 time used: 4  seconds  train loss: 0.20390479651926238 validation loss: 0.232217127060931
epoch 68 time used: 4  seconds  train loss: 0.2032106169124438 validation loss: 0.23236676006744197
epoch 69 time used: 4  seconds  train loss: 0.2035146703160777 validation loss: 0.2343745752701539
epoch 70 time used: 4  seconds  train loss: 0.20206733169425845 validation loss: 0.23441677625119448
epoch 71 time used: 4  seconds  train loss: 0.20223187069998605 validation loss: 0.2315846586900647
Early stopping at epoch: 72
YS.shape, YS_pred.shape, (14021, 1, 1, 69) (14021, 1, 1, 69)
YS.shape, YS_pred.shape, (14021, 69) (14021, 69)
****************************************
STGCN3, train, Torch MSE, 2.0168943169e-01, 0.2016894317

STGCN3, train, MSE, RMSE, MAE, MAPE, 550.6282612173, 23.4654695503, 13.0281149245, 18.0887408066

Model Training Ended ... Sun Jan  9 07:12:02 2022
pred_finaltest-NYCTaxi-outflow-onehot_STGCN3_33_2201090706 testing started Sun Jan  9 07:12:02 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape is (3507, 1, 12, 69)
YS shape is (3507, 1, 1, 69)
getXSYS data.shape(17544, 69, 32)
getXSYS XS.shape(3507, 32, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
XS shape after is (3507, 33, 12, 69)
YS shape after is (3507, 1, 1, 69)
TEST XS.shape, YS.shape (3507, 33, 12, 69) (3507, 1, 1, 69)
Model Testing Started ... Sun Jan  9 07:12:03 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([1, 3, 69, 69])
YS.shape, YS_pred.shape, (3507, 1, 1, 69) (3507, 1, 1, 69)
YS.shape, YS_pred.shape, (3507, 69) (3507, 69)
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
****************************************
STGCN3, test, Torch MSE, 2.2360686797e-01, 0.2236068680

STGCN3, test, MSE, RMSE, MAE, MAPE, 709.8607081580, 26.6432112959, 14.9124053368, 21.4707356109

Model Testing Ended ... Sun Jan  9 07:12:04 2022
