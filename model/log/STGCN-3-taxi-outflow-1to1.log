nohup: ignoring input
../data-NYCTaxi/30min/201901-202012-NYCtaxi-outflow.npz
Namespace(adjpath='../data-NYCZones/adjmatrix/W_adj_matrix.csv', adjtype='symnadj', batchsize=64, channel=1, cpu=1, dataname='METR-LA', epoch=200, ex='typhoon-inflow', flowpath='../data-NYCTaxi/30min/201901-202012-NYCtaxi-outflow.npz', gpu=3, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (35088, 69)
pred_METR-LA_STGCN3_2112241833 training started Fri Dec 24 18:33:19 2021
getXSYS data.shape(35088, 69)
getXSYS XS.shape(28056, 1, 12, 69)
getXSYS YS.shape(28056, 1, 1, 69)
TRAIN XS.shape YS,shape (28056, 1, 12, 69) (28056, 1, 1, 69)
Model Training Started ... Fri Dec 24 18:33:19 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 16, 10, 69]          --
|    |    └─align: 3-1                   [-1, 16, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 32, 10, 69]          128
|    └─spatio_conv_layer: 2-2            [-1, 16, 10, 69]          784
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-3                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-4                  [-1, 64, 8, 69]           3,136
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 16, 6, 69]           --
|    |    └─align: 3-5                   [-1, 16, 8, 69]           1,040
|    |    └─Conv2d: 3-6                  [-1, 32, 6, 69]           6,176
|    └─spatio_conv_layer: 2-7            [-1, 16, 6, 69]           784
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-7                   [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-8                  [-1, 64, 4, 69]           3,136
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-9                   [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-10                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-11                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 78,801
Trainable params: 78,801
Non-trainable params: 0
Total mult-adds (M): 8.39
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 1.42
Params size (MB): 0.30
Estimated Total Size (MB): 1.72
==========================================================================================
epoch 0 time used: 8  seconds  train loss: 0.34263341906085376 validation loss: 0.10411984489188086
epoch 1 time used: 8  seconds  train loss: 0.29426816199259376 validation loss: 0.10424620210529563
epoch 2 time used: 8  seconds  train loss: 0.2785308804519162 validation loss: 0.08771711255848356
epoch 3 time used: 8  seconds  train loss: 0.26996413120801366 validation loss: 0.08730932414778149
epoch 4 time used: 8  seconds  train loss: 0.26471733061355546 validation loss: 0.08522518504106118
epoch 5 time used: 8  seconds  train loss: 0.2596246750795495 validation loss: 0.08699593880610279
epoch 6 time used: 8  seconds  train loss: 0.25669559072421627 validation loss: 0.082274099987713
epoch 7 time used: 8  seconds  train loss: 0.254003035965857 validation loss: 0.08350185741887393
epoch 8 time used: 9  seconds  train loss: 0.2509625921111383 validation loss: 0.08510423113018623
epoch 9 time used: 8  seconds  train loss: 0.24997608252972894 validation loss: 0.08154423940010073
epoch 10 time used: 8  seconds  train loss: 0.24700783403071566 validation loss: 0.08363133113558285
epoch 11 time used: 9  seconds  train loss: 0.24557493018132323 validation loss: 0.08093240533564755
epoch 12 time used: 8  seconds  train loss: 0.2445211346587502 validation loss: 0.08263682743992803
epoch 13 time used: 8  seconds  train loss: 0.24363190314692923 validation loss: 0.07988461917083013
epoch 14 time used: 8  seconds  train loss: 0.24221430077363995 validation loss: 0.08082718917760612
epoch 15 time used: 8  seconds  train loss: 0.24143175692212349 validation loss: 0.08433941114584469
epoch 16 time used: 8  seconds  train loss: 0.24054895649143643 validation loss: 0.08158232050936957
epoch 17 time used: 8  seconds  train loss: 0.23941849588029443 validation loss: 0.08209832846515024
epoch 18 time used: 8  seconds  train loss: 0.23855391251098318 validation loss: 0.08108316247819121
epoch 19 time used: 8  seconds  train loss: 0.2378052165490886 validation loss: 0.0802486985688166
epoch 20 time used: 8  seconds  train loss: 0.23788224117453072 validation loss: 0.08015036803893565
epoch 21 time used: 8  seconds  train loss: 0.23684485485691747 validation loss: 0.08047792599739632
epoch 22 time used: 7  seconds  train loss: 0.23574330361597243 validation loss: 0.08022798979370759
Early stopping at epoch: 23
YS.shape, YS_pred.shape, (28056, 1, 1, 69) (28056, 1, 1, 69)
YS.shape, YS_pred.shape, (28056, 69) (28056, 69)
****************************************
STGCN3, train, Torch MSE, 2.3481160380e-01, 0.2348116038

STGCN3, train, MSE, RMSE, MAE, MAPE, 219.3047783839, 14.8089425140, 8.1125231896, 32.9713618502

Model Training Ended ... Fri Dec 24 18:36:49 2021
pred_METR-LA_STGCN3_2112241833 testing started Fri Dec 24 18:36:49 2021
getXSYS data.shape(35088, 69)
getXSYS XS.shape(7016, 1, 12, 69)
getXSYS YS.shape(7016, 1, 1, 69)
TEST XS.shape, YS.shape (7016, 1, 12, 69) (7016, 1, 1, 69)
Model Testing Started ... Fri Dec 24 18:36:49 2021
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape, (7016, 1, 1, 69) (7016, 1, 1, 69)
YS.shape, YS_pred.shape, (7016, 69) (7016, 69)
****************************************
STGCN3, test, Torch MSE, 1.5629538134e-01, 0.1562953813

STGCN3, test, MSE, RMSE, MAE, MAPE, 103.6462331982, 10.1806794075, 5.9566759124, 69.1196140135

Model Testing Ended ... Fri Dec 24 18:36:55 2021
