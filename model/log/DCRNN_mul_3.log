data.shape (17544, 69)
pred_NYC-Taxi_DCRNN_2201092124 training started Sun Jan  9 21:24:21 2022
TRAIN XS.shape YS,shape (14021, 12, 69, 1) (14021, 3, 69, 1)
Model Training Started ... Sun Jan  9 21:24:21 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─DCGRU_Encoder: 1-1                     [2, 12, 69, 64]           --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-1              [-1, 69, 64]              112,512
|    |    └─DCGRU_Cell: 3-2              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-3              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-4              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-5              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-6              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-7              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-8              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-9              [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-10             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-11             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-12             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-13             [-1, 69, 64]              221,376
|    |    └─DCGRU_Cell: 3-14             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-15             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-16             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-17             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-18             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-19             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-20             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-21             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-22             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-23             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-24             [-1, 69, 64]              (recursive)
├─DCGRU_Decoder: 1-2                     [-1, 69, 1]               --
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-25             [-1, 69, 64]              112,512
|    |    └─DCGRU_Cell: 3-26             [-1, 69, 64]              221,376
|    └─Linear: 2-1                       [-1, 69, 1]               65
├─DCGRU_Decoder: 1-3                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-27             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-28             [-1, 69, 64]              (recursive)
|    └─Linear: 2-2                       [-1, 69, 1]               (recursive)
├─DCGRU_Decoder: 1-4                     [-1, 69, 1]               (recursive)
|    └─ModuleList: 2                     []                        --
|    |    └─DCGRU_Cell: 3-29             [-1, 69, 64]              (recursive)
|    |    └─DCGRU_Cell: 3-30             [-1, 69, 64]              (recursive)
|    └─Linear: 2-3                       [-1, 69, 1]               (recursive)
==========================================================================================
Total params: 667,841
Trainable params: 667,841
Non-trainable params: 0
Total mult-adds (M): 0.00
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 0.40
Params size (MB): 2.55
Estimated Total Size (MB): 2.96
==========================================================================================
XS_torch.shape:   torch.Size([14021, 12, 69, 1])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 31  seconds  train loss: 0.3711087783579334 validation loss: 0.3160281001297461
epoch 1 time used: 33  seconds  train loss: 0.3096261860533728 validation loss: 0.29053292111947887
epoch 2 time used: 30  seconds  train loss: 0.2904952140090751 validation loss: 0.28097822743691653
epoch 3 time used: 31  seconds  train loss: 0.27733841200274445 validation loss: 0.27152068985236144
epoch 4 time used: 32  seconds  train loss: 0.2689939610123207 validation loss: 0.2606373435928695
epoch 5 time used: 32  seconds  train loss: 0.2625574115475498 validation loss: 0.259159063330665
epoch 6 time used: 32  seconds  train loss: 0.25568602543371605 validation loss: 0.2543380280358412
epoch 7 time used: 32  seconds  train loss: 0.25149914235566545 validation loss: 0.24987775706184026
epoch 8 time used: 32  seconds  train loss: 0.24755623521733292 validation loss: 0.24511804580008448
epoch 9 time used: 32  seconds  train loss: 0.24352659163604856 validation loss: 0.24403102894000714
epoch 10 time used: 31  seconds  train loss: 0.24179804423246393 validation loss: 0.240401614956766
epoch 11 time used: 33  seconds  train loss: 0.23811150322063063 validation loss: 0.23764993072712143
epoch 12 time used: 34  seconds  train loss: 0.23542542309103395 validation loss: 0.23608995418139206
epoch 13 time used: 34  seconds  train loss: 0.23357908043404296 validation loss: 0.23480348466670792
epoch 14 time used: 34  seconds  train loss: 0.23138596562539324 validation loss: 0.23391176488184617
epoch 15 time used: 30  seconds  train loss: 0.23061546001657432 validation loss: 0.2304994974283239
epoch 16 time used: 29  seconds  train loss: 0.22738810384510627 validation loss: 0.2290394509256872
epoch 17 time used: 29  seconds  train loss: 0.22764845259966196 validation loss: 0.22845512949869556
epoch 18 time used: 29  seconds  train loss: 0.22469434795101342 validation loss: 0.23062760649377526
epoch 19 time used: 29  seconds  train loss: 0.22293130410662063 validation loss: 0.22520717515206923
epoch 20 time used: 29  seconds  train loss: 0.22151776437927312 validation loss: 0.2255620025799605
epoch 21 time used: 29  seconds  train loss: 0.21990931272642752 validation loss: 0.2236275589438894
epoch 22 time used: 30  seconds  train loss: 0.21954474524076498 validation loss: 0.2262245751981115
epoch 23 time used: 30  seconds  train loss: 0.21803527153156307 validation loss: 0.22159034779632153
epoch 24 time used: 32  seconds  train loss: 0.21781529902556762 validation loss: 0.2200213359956801
epoch 25 time used: 32  seconds  train loss: 0.21521315125813498 validation loss: 0.2214978183091061
epoch 26 time used: 31  seconds  train loss: 0.2146085106883408 validation loss: 0.21901208067953554
epoch 27 time used: 31  seconds  train loss: 0.2138454579193428 validation loss: 0.21772886303514327
epoch 28 time used: 30  seconds  train loss: 0.21228551355934236 validation loss: 0.21843698364084813
epoch 29 time used: 30  seconds  train loss: 0.2119965176746361 validation loss: 0.21703425603156354
epoch 30 time used: 32  seconds  train loss: 0.2107477817777939 validation loss: 0.217292381825613
epoch 31 time used: 31  seconds  train loss: 0.20925832806773942 validation loss: 0.21600908832385482
epoch 32 time used: 29  seconds  train loss: 0.20920520730834075 validation loss: 0.21408085770696758
epoch 33 time used: 29  seconds  train loss: 0.20831772904171397 validation loss: 0.21151949943846046
epoch 34 time used: 31  seconds  train loss: 0.20719128466698025 validation loss: 0.21389233024713317
epoch 35 time used: 29  seconds  train loss: 0.20543899735236035 validation loss: 0.21102582222553096
epoch 36 time used: 29  seconds  train loss: 0.20548785642824308 validation loss: 0.2120107312458825
epoch 37 time used: 29  seconds  train loss: 0.20534472305474624 validation loss: 0.21241628350153421
epoch 38 time used: 29  seconds  train loss: 0.20402235145439804 validation loss: 0.21084751710678193
epoch 39 time used: 29  seconds  train loss: 0.2032694302166484 validation loss: 0.20952904281348278
epoch 40 time used: 29  seconds  train loss: 0.2023375333278623 validation loss: 0.20963567753757537
epoch 41 time used: 29  seconds  train loss: 0.20195236773921568 validation loss: 0.20867341148193672
epoch 42 time used: 29  seconds  train loss: 0.20135959014077898 validation loss: 0.2082562484335913
epoch 43 time used: 29  seconds  train loss: 0.20039083068946847 validation loss: 0.20720763433952027
epoch 44 time used: 29  seconds  train loss: 0.19949823289983312 validation loss: 0.20741742250073383
epoch 45 time used: 29  seconds  train loss: 0.1991314695602059 validation loss: 0.2087517980246019
epoch 46 time used: 29  seconds  train loss: 0.19874474822133925 validation loss: 0.20642202707507987
epoch 47 time used: 29  seconds  train loss: 0.1983100523437939 validation loss: 0.20740710781155078
epoch 48 time used: 29  seconds  train loss: 0.19795726953887535 validation loss: 0.20601272899221842
epoch 49 time used: 29  seconds  train loss: 0.19705526074525156 validation loss: 0.2043727307627695
epoch 50 time used: 29  seconds  train loss: 0.1966788236271647 validation loss: 0.20645091214726738
epoch 51 time used: 29  seconds  train loss: 0.19589146881819472 validation loss: 0.2035574871033039
epoch 52 time used: 29  seconds  train loss: 0.19578966900176709 validation loss: 0.20324819821904744
epoch 53 time used: 29  seconds  train loss: 0.19536370022953004 validation loss: 0.20291274311674437
epoch 54 time used: 29  seconds  train loss: 0.19488567801846485 validation loss: 0.20285062271734
epoch 55 time used: 29  seconds  train loss: 0.1940691671466299 validation loss: 0.2028999312292557
epoch 56 time used: 29  seconds  train loss: 0.19396844710808528 validation loss: 0.20183352317663172
epoch 57 time used: 29  seconds  train loss: 0.19367809553837442 validation loss: 0.20165971377136635
epoch 58 time used: 29  seconds  train loss: 0.1929990868198005 validation loss: 0.20319100147611538
epoch 59 time used: 29  seconds  train loss: 0.19333656060314738 validation loss: 0.2023231807567022
epoch 60 time used: 29  seconds  train loss: 0.19199909487958447 validation loss: 0.2003328682471192
epoch 61 time used: 29  seconds  train loss: 0.19180405249240384 validation loss: 0.20007774412325974
epoch 62 time used: 29  seconds  train loss: 0.19216815452448197 validation loss: 0.20125282509491502
epoch 63 time used: 29  seconds  train loss: 0.19159754971300386 validation loss: 0.20227375595962668
epoch 64 time used: 29  seconds  train loss: 0.19119799717225894 validation loss: 0.19934443440936458
epoch 65 time used: 29  seconds  train loss: 0.19000764136249093 validation loss: 0.1993103174485279
epoch 66 time used: 29  seconds  train loss: 0.1901987760938415 validation loss: 0.19873740583981234
epoch 67 time used: 29  seconds  train loss: 0.19006192175969652 validation loss: 0.19927429546816175
epoch 68 time used: 29  seconds  train loss: 0.18925793056947463 validation loss: 0.20009190500360588
epoch 69 time used: 29  seconds  train loss: 0.1895487865437348 validation loss: 0.1992123720224966
epoch 70 time used: 29  seconds  train loss: 0.18920253262404785 validation loss: 0.19740440885611282
epoch 71 time used: 29  seconds  train loss: 0.18861749932961858 validation loss: 0.19831862794931318
epoch 72 time used: 29  seconds  train loss: 0.18837376115743446 validation loss: 0.19929126521314272
epoch 73 time used: 29  seconds  train loss: 0.18792377487140796 validation loss: 0.19804657150763344
epoch 74 time used: 29  seconds  train loss: 0.18822522524089583 validation loss: 0.1986373561029086
epoch 75 time used: 29  seconds  train loss: 0.18736660273039346 validation loss: 0.1978751095580293
epoch 76 time used: 29  seconds  train loss: 0.18754551031805616 validation loss: 0.19659306307860394
epoch 77 time used: 29  seconds  train loss: 0.18675203016984335 validation loss: 0.19946637268550588
epoch 78 time used: 29  seconds  train loss: 0.1871505255589549 validation loss: 0.19758901090976924
epoch 79 time used: 29  seconds  train loss: 0.18618318598376138 validation loss: 0.19635001323050386
epoch 80 time used: 29  seconds  train loss: 0.18657389966291832 validation loss: 0.19551912893653256
epoch 81 time used: 29  seconds  train loss: 0.18586629786552028 validation loss: 0.1972070319851126
epoch 82 time used: 29  seconds  train loss: 0.1864209667474935 validation loss: 0.19664401810507876
epoch 83 time used: 29  seconds  train loss: 0.1857500496703948 validation loss: 0.19646643881653625
epoch 84 time used: 29  seconds  train loss: 0.18514110278647927 validation loss: 0.1955862837948258
epoch 85 time used: 29  seconds  train loss: 0.18474157119092702 validation loss: 0.19548389113296186
epoch 86 time used: 29  seconds  train loss: 0.1846951259331086 validation loss: 0.19543659493233637
epoch 87 time used: 29  seconds  train loss: 0.18421415001746688 validation loss: 0.19512546121122085
epoch 88 time used: 29  seconds  train loss: 0.18449247638896268 validation loss: 0.19620196664938572
epoch 89 time used: 29  seconds  train loss: 0.18449927339792485 validation loss: 0.19585733492239774
epoch 90 time used: 29  seconds  train loss: 0.1834851696207891 validation loss: 0.19423675890725065
epoch 91 time used: 29  seconds  train loss: 0.18357118037184636 validation loss: 0.1945689631593071
epoch 92 time used: 29  seconds  train loss: 0.18388770448294764 validation loss: 0.1946360498615761
epoch 93 time used: 29  seconds  train loss: 0.18378650086844125 validation loss: 0.19575272162199972
epoch 94 time used: 29  seconds  train loss: 0.18327507355293235 validation loss: 0.1947190697133303
epoch 95 time used: 29  seconds  train loss: 0.18307579379925948 validation loss: 0.19372031424158448
epoch 96 time used: 29  seconds  train loss: 0.18266691182951683 validation loss: 0.19377019131822854
epoch 97 time used: 29  seconds  train loss: 0.18248341331409637 validation loss: 0.19360142197360056
epoch 98 time used: 29  seconds  train loss: 0.18264034124687048 validation loss: 0.19354179471782187
epoch 99 time used: 29  seconds  train loss: 0.18245093622598657 validation loss: 0.19331792171213605
epoch 100 time used: 29  seconds  train loss: 0.18238137865497966 validation loss: 0.19467195284516214
epoch 101 time used: 29  seconds  train loss: 0.18233653442417327 validation loss: 0.19217628277986987
epoch 102 time used: 29  seconds  train loss: 0.18203685910996373 validation loss: 0.19319925965136686
epoch 103 time used: 29  seconds  train loss: 0.18152188490997279 validation loss: 0.1933623524271143
epoch 104 time used: 29  seconds  train loss: 0.18203461438388283 validation loss: 0.19398386974506085
epoch 105 time used: 29  seconds  train loss: 0.18175096025208834 validation loss: 0.1928606785863587
epoch 106 time used: 29  seconds  train loss: 0.18105765018900016 validation loss: 0.19254932343041767
epoch 107 time used: 29  seconds  train loss: 0.18079376240623166 validation loss: 0.19194849813861706
epoch 108 time used: 29  seconds  train loss: 0.18065081718479495 validation loss: 0.19202832971140105
epoch 109 time used: 29  seconds  train loss: 0.18063163599421467 validation loss: 0.19390889170063746
epoch 110 time used: 29  seconds  train loss: 0.18090107897068802 validation loss: 0.19255539271672387
epoch 111 time used: 29  seconds  train loss: 0.18063606863539577 validation loss: 0.19291717580775158
epoch 112 time used: 29  seconds  train loss: 0.18032094722545064 validation loss: 0.19195390664810327
epoch 113 time used: 29  seconds  train loss: 0.1806185566469478 validation loss: 0.19331487786307447
epoch 114 time used: 29  seconds  train loss: 0.18016178829684723 validation loss: 0.19108744200236172
epoch 115 time used: 29  seconds  train loss: 0.17960160019870375 validation loss: 0.1918864225106993
epoch 116 time used: 29  seconds  train loss: 0.1794847719320304 validation loss: 0.19119231562681083
epoch 117 time used: 29  seconds  train loss: 0.17910142840023804 validation loss: 0.19236251522286987/home/cseadmin/mhy/model/DCRNN.py:318: RuntimeWarning: divide by zero encountered in power
  d_inv = np.power(rowsum, -1).flatten()

epoch 118 time used: 29  seconds  train loss: 0.17936959285999612 validation loss: 0.19135581059790446
epoch 119 time used: 29  seconds  train loss: 0.17972846777170148 validation loss: 0.1912970540187594
epoch 120 time used: 29  seconds  train loss: 0.17915508753028256 validation loss: 0.19054826788064486
epoch 121 time used: 29  seconds  train loss: 0.17904843531857495 validation loss: 0.19117593687905357
epoch 122 time used: 29  seconds  train loss: 0.17889287691766212 validation loss: 0.1912236371196071
epoch 123 time used: 29  seconds  train loss: 0.1785488399623231 validation loss: 0.19080421980523546
epoch 124 time used: 29  seconds  train loss: 0.17863745638085843 validation loss: 0.19122335296049842
epoch 125 time used: 29  seconds  train loss: 0.17828143781332229 validation loss: 0.19052141785825652
epoch 126 time used: 29  seconds  train loss: 0.17830210006369182 validation loss: 0.19149209928730182
epoch 127 time used: 29  seconds  train loss: 0.17842923353520596 validation loss: 0.1899382429876398
epoch 128 time used: 29  seconds  train loss: 0.17845314307752322 validation loss: 0.19222706402463363
epoch 129 time used: 29  seconds  train loss: 0.17809745112575534 validation loss: 0.19088088972223058
epoch 130 time used: 29  seconds  train loss: 0.1783308921631439 validation loss: 0.19044662312446697
epoch 131 time used: 29  seconds  train loss: 0.17794241933780655 validation loss: 0.19006189801695683
epoch 132 time used: 29  seconds  train loss: 0.17786865413461012 validation loss: 0.18961136219029553
epoch 133 time used: 29  seconds  train loss: 0.17750999167255443 validation loss: 0.19171764456368962
epoch 134 time used: 29  seconds  train loss: 0.1773185012907635 validation loss: 0.189717179526619
epoch 135 time used: 29  seconds  train loss: 0.17777014512812855 validation loss: 0.19048184583986819
epoch 136 time used: 29  seconds  train loss: 0.1774797601073271 validation loss: 0.19014640726229837
epoch 137 time used: 29  seconds  train loss: 0.1769910968589907 validation loss: 0.1907653495269847
epoch 138 time used: 29  seconds  train loss: 0.17696066207049294 validation loss: 0.18853158118278723
epoch 139 time used: 29  seconds  train loss: 0.17657366077247721 validation loss: 0.1896536932101062
epoch 140 time used: 29  seconds  train loss: 0.17687329560042128 validation loss: 0.18935747754043397
epoch 141 time used: 29  seconds  train loss: 0.1764873040977891 validation loss: 0.18947393541089888
epoch 142 time used: 29  seconds  train loss: 0.1769243444036419 validation loss: 0.18964084682808696
epoch 143 time used: 29  seconds  train loss: 0.17642855017473613 validation loss: 0.18916138470240884
epoch 144 time used: 29  seconds  train loss: 0.17649664626589495 validation loss: 0.18839918689019192
epoch 145 time used: 29  seconds  train loss: 0.17627536614535103 validation loss: 0.18953363718098393
epoch 146 time used: 29  seconds  train loss: 0.17680319671448955 validation loss: 0.18889604082157865
epoch 147 time used: 29  seconds  train loss: 0.17607478557909434 validation loss: 0.1884495591563085
epoch 148 time used: 29  seconds  train loss: 0.17632959729633232 validation loss: 0.1885136964062045
epoch 149 time used: 29  seconds  train loss: 0.17624225928762427 validation loss: 0.18826335894673876
epoch 150 time used: 29  seconds  train loss: 0.17574742154127462 validation loss: 0.18807171725471974
epoch 151 time used: 29  seconds  train loss: 0.17533536932155136 validation loss: 0.18824020008563452
epoch 152 time used: 29  seconds  train loss: 0.17603014805513598 validation loss: 0.1874023802234184
epoch 153 time used: 29  seconds  train loss: 0.17514894500904377 validation loss: 0.18839388154128314
epoch 154 time used: 29  seconds  train loss: 0.1755258527356326 validation loss: 0.1885964467449999
epoch 155 time used: 29  seconds  train loss: 0.17590435526057724 validation loss: 0.18885878870912912
epoch 156 time used: 29  seconds  train loss: 0.1751880917879126 validation loss: 0.18755729256768397
epoch 157 time used: 29  seconds  train loss: 0.175060319922862 validation loss: 0.18787537724272702
epoch 158 time used: 29  seconds  train loss: 0.174978438586259 validation loss: 0.1877224900708223
epoch 159 time used: 29  seconds  train loss: 0.17510177844173946 validation loss: 0.1876543532574578
epoch 160 time used: 29  seconds  train loss: 0.1755188457014353 validation loss: 0.18756017569161387
epoch 161 time used: 29  seconds  train loss: 0.1749119745147784 validation loss: 0.1890424305771802
Early stopping at epoch: 162
YS.shape, YS_pred.shape, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
DCRNN, train, Torch MSE, 1.7313963261e-01, 0.1731396326
DCRNN, train, MSE, RMSE, MAE, MAPE, 356.3832662064, 18.8781160661, 11.0161688618, 16.7222265830
Model Training Ended ... Sun Jan  9 22:45:55 2022
pred_NYC-Taxi_DCRNN_2201092124 testing started Sun Jan  9 22:45:55 2022
TEST XS.shape, YS.shape (3507, 12, 69, 1) (3507, 3, 69, 1)
Model Testing Started ... Sun Jan  9 22:45:55 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
DCRNN, test, Torch MSE, 1.8126761510e-01, 0.1812676151
all pred steps, DCRNN, test, MSE, RMSE, MAE, MAPE, 387.5609692330, 19.6865682442, 11.4829044219, 18.5503239581
1 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 360.8470821257, 18.9959754192, 11.3320142296, 18.5822348992
2 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 384.4324175792, 19.6069481965, 11.3653318136, 18.4036529649
3 step, DCRNN, test, MSE, RMSE, MAE, MAPE, 417.4030737194, 20.4304447754, 11.7513658909, 18.6650857962
Model Testing Ended ... Sun Jan  9 22:46:00 2022
