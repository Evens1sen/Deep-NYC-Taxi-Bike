data.shape (17544, 69)
pred_METR-LA_GraphWaveNet_2201031827 training started Mon Jan  3 18:27:18 2022
TRAIN XS.shape YS,shape (14021, 1, 69, 12) (14021, 3, 69, 1)
Model Training Started ... Mon Jan  3 18:27:18 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─Conv2d: 1-1                            [-1, 32, 69, 13]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-1                       [-1, 32, 69, 12]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-2                       [-1, 32, 69, 12]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-3                       [-1, 256, 69, 12]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-4                          [-1, 32, 69, 12]          --
|    |    └─nconv: 3-1                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-2                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-3                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-4                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-5                   [-1, 32, 69, 12]          --
|    |    └─nconv: 3-6                   [-1, 32, 69, 12]          --
|    |    └─linear: 3-7                  [-1, 32, 69, 12]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-5                  [-1, 32, 69, 12]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-6                       [-1, 32, 69, 10]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-7                       [-1, 32, 69, 10]          2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-8                       [-1, 256, 69, 10]         8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-9                          [-1, 32, 69, 10]          --
|    |    └─nconv: 3-8                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-9                   [-1, 32, 69, 10]          --
|    |    └─nconv: 3-10                  [-1, 32, 69, 10]          --
|    |    └─nconv: 3-11                  [-1, 32, 69, 10]          --
|    |    └─nconv: 3-12                  [-1, 32, 69, 10]          --
|    |    └─nconv: 3-13                  [-1, 32, 69, 10]          --
|    |    └─linear: 3-14                 [-1, 32, 69, 10]          7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-10                 [-1, 32, 69, 10]          64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-11                      [-1, 32, 69, 9]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-12                      [-1, 32, 69, 9]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-13                      [-1, 256, 69, 9]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-14                         [-1, 32, 69, 9]           --
|    |    └─nconv: 3-15                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-16                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-17                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-18                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-19                  [-1, 32, 69, 9]           --
|    |    └─nconv: 3-20                  [-1, 32, 69, 9]           --
|    |    └─linear: 3-21                 [-1, 32, 69, 9]           7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-15                 [-1, 32, 69, 9]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-16                      [-1, 32, 69, 7]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-17                      [-1, 32, 69, 7]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-18                      [-1, 256, 69, 7]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-19                         [-1, 32, 69, 7]           --
|    |    └─nconv: 3-22                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-23                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-24                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-25                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-26                  [-1, 32, 69, 7]           --
|    |    └─nconv: 3-27                  [-1, 32, 69, 7]           --
|    |    └─linear: 3-28                 [-1, 32, 69, 7]           7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-20                 [-1, 32, 69, 7]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-21                      [-1, 32, 69, 6]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-22                      [-1, 32, 69, 6]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-23                      [-1, 256, 69, 6]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-24                         [-1, 32, 69, 6]           --
|    |    └─nconv: 3-29                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-30                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-31                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-32                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-33                  [-1, 32, 69, 6]           --
|    |    └─nconv: 3-34                  [-1, 32, 69, 6]           --
|    |    └─linear: 3-35                 [-1, 32, 69, 6]           7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-25                 [-1, 32, 69, 6]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-26                      [-1, 32, 69, 4]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-27                      [-1, 32, 69, 4]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-28                      [-1, 256, 69, 4]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-29                         [-1, 32, 69, 4]           --
|    |    └─nconv: 3-36                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-37                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-38                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-39                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-40                  [-1, 32, 69, 4]           --
|    |    └─nconv: 3-41                  [-1, 32, 69, 4]           --
|    |    └─linear: 3-42                 [-1, 32, 69, 4]           7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-30                 [-1, 32, 69, 4]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-31                      [-1, 32, 69, 3]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-32                      [-1, 32, 69, 3]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-33                      [-1, 256, 69, 3]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-34                         [-1, 32, 69, 3]           --
|    |    └─nconv: 3-43                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-44                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-45                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-46                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-47                  [-1, 32, 69, 3]           --
|    |    └─nconv: 3-48                  [-1, 32, 69, 3]           --
|    |    └─linear: 3-49                 [-1, 32, 69, 3]           7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-35                 [-1, 32, 69, 3]           64
├─ModuleList: 1                          []                        --
|    └─Conv2d: 2-36                      [-1, 32, 69, 1]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-37                      [-1, 32, 69, 1]           2,080
├─ModuleList: 1                          []                        --
|    └─Conv1d: 2-38                      [-1, 256, 69, 1]          8,448
├─ModuleList: 1                          []                        --
|    └─gcn: 2-39                         [-1, 32, 69, 1]           --
|    |    └─nconv: 3-50                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-51                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-52                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-53                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-54                  [-1, 32, 69, 1]           --
|    |    └─nconv: 3-55                  [-1, 32, 69, 1]           --
|    |    └─linear: 3-56                 [-1, 32, 69, 1]           7,200
├─ModuleList: 1                          []                        --
|    └─BatchNorm2d: 2-40                 [-1, 32, 69, 1]           64
├─Conv2d: 1-2                            [-1, 512, 69, 1]          131,584
├─Conv2d: 1-3                            [-1, 3, 69, 1]            1,539
==========================================================================================
Total params: 292,163
Trainable params: 292,163
Non-trainable params: 0
Total mult-adds (M): 79.10
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 11.00
Params size (MB): 1.11
Estimated Total Size (MB): 12.12
==========================================================================================/home/cseadmin/mhy/model/GraphWaveNet.py:331: RuntimeWarning: divide by zero encountered in power
  d_inv_sqrt = np.power(d, -0.5).flatten()

XS_torch.shape:   torch.Size([14021, 1, 69, 12])
YS_torch.shape:   torch.Size([14021, 3, 69, 1])
LOSS is : MAE
epoch 0 time used: 10  seconds  train loss: 0.3011890819261624 validation loss: 0.3661608957625496
epoch 1 time used: 9  seconds  train loss: 0.24090939220909502 validation loss: 0.3476087065914054
epoch 2 time used: 10  seconds  train loss: 0.2185826583613314 validation loss: 0.3400421412550104
epoch 3 time used: 10  seconds  train loss: 0.20638589423974563 validation loss: 0.33483959643485817
epoch 4 time used: 9  seconds  train loss: 0.20015456405279106 validation loss: 0.3353795511547117
epoch 5 time used: 10  seconds  train loss: 0.1966145389294601 validation loss: 0.3318314133323538
epoch 6 time used: 10  seconds  train loss: 0.19231163237376286 validation loss: 0.330373228701332
epoch 7 time used: 10  seconds  train loss: 0.189353654011088 validation loss: 0.3314029185246959
epoch 8 time used: 9  seconds  train loss: 0.18602791123935133 validation loss: 0.32786713573705517
epoch 9 time used: 9  seconds  train loss: 0.18458783273340088 validation loss: 0.3174495614397818
epoch 10 time used: 8  seconds  train loss: 0.18355277215653223 validation loss: 0.3224260735804193
epoch 11 time used: 9  seconds  train loss: 0.1797678677877153 validation loss: 0.3066325555409422
epoch 12 time used: 10  seconds  train loss: 0.1773257286260211 validation loss: 0.3032551852893775
epoch 13 time used: 9  seconds  train loss: 0.17661261109603046 validation loss: 0.32516236859121395
epoch 14 time used: 9  seconds  train loss: 0.17579224471028324 validation loss: 0.2997710674882139
epoch 15 time used: 9  seconds  train loss: 0.17542633243733521 validation loss: 0.30731411874124276
epoch 16 time used: 9  seconds  train loss: 0.17348172462915495 validation loss: 0.30356068178985846
epoch 17 time used: 10  seconds  train loss: 0.1723758325704659 validation loss: 0.31418604886130613
epoch 18 time used: 9  seconds  train loss: 0.17174768029555149 validation loss: 0.31856878735103816
epoch 19 time used: 9  seconds  train loss: 0.16985516040730173 validation loss: 0.2968605354351788
epoch 20 time used: 9  seconds  train loss: 0.169790597324617 validation loss: 0.31184495469535073
epoch 21 time used: 9  seconds  train loss: 0.16796782051638512 validation loss: 0.29980723727313846
epoch 22 time used: 9  seconds  train loss: 0.16728413426646746 validation loss: 0.30041573068718874
epoch 23 time used: 9  seconds  train loss: 0.16616920920354286 validation loss: 0.2958930237457811
epoch 24 time used: 9  seconds  train loss: 0.16542710107333658 validation loss: 0.3032940828453386
epoch 25 time used: 9  seconds  train loss: 0.16521601004323783 validation loss: 0.3020422920729185
epoch 26 time used: 9  seconds  train loss: 0.16442283260188742 validation loss: 0.30857821148052533
epoch 27 time used: 9  seconds  train loss: 0.1650033231799129 validation loss: 0.2916443724497617
epoch 28 time used: 9  seconds  train loss: 0.16362748560588292 validation loss: 0.3019114424518633
epoch 29 time used: 10  seconds  train loss: 0.16257407407652566 validation loss: 0.30980543578888303
epoch 30 time used: 9  seconds  train loss: 0.16186824696515645 validation loss: 0.3013898971518719
epoch 31 time used: 9  seconds  train loss: 0.16168103725408006 validation loss: 0.29116416001279083
epoch 32 time used: 9  seconds  train loss: 0.16082776630103568 validation loss: 0.2969065715228906
epoch 33 time used: 10  seconds  train loss: 0.1598220563620902 validation loss: 0.3018242223087339
epoch 34 time used: 10  seconds  train loss: 0.15899322437742536 validation loss: 0.29555182600116564
epoch 35 time used: 9  seconds  train loss: 0.1588497676093764 validation loss: 0.2935508239867683
epoch 36 time used: 9  seconds  train loss: 0.15811684436641846 validation loss: 0.2981777361509668
epoch 37 time used: 8  seconds  train loss: 0.15797082680928268 validation loss: 0.2958457793804556
epoch 38 time used: 9  seconds  train loss: 0.15708841562251685 validation loss: 0.2929221515273341
epoch 39 time used: 9  seconds  train loss: 0.1568970541914006 validation loss: 0.2967082004817771
epoch 40 time used: 9  seconds  train loss: 0.15579701930935547 validation loss: 0.2916550265505051
Early stopping at epoch: 41
YS.shape, YS_pred.shape before, (14021, 3, 69, 1) (14021, 3, 69, 1)
YS.shape, YS_pred.shape after, (14021, 3, 69) (14021, 3, 69)
YS_pred.shape before (14021, 3, 69)
YS_pred.shape after (14021, 3, 69)
YS.shape, YS_pred.shape, (14021, 3, 69) (14021, 3, 69)
****************************************
GraphWaveNet, train, Torch MSE, 1.5311164359e-01, 0.1531116436
GraphWaveNet, train, MSE, RMSE, MAE, MAPE, 130.8782420833, 11.4402028865, 6.4517210381, 41.7540457576
Model Training Ended ... Mon Jan  3 18:34:23 2022
pred_METR-LA_GraphWaveNet_2201031827 testing started Mon Jan  3 18:34:23 2022
TEST XS.shape, YS.shape (3507, 1, 69, 12) (3507, 3, 69, 1)
Model Testing Started ... Mon Jan  3 18:34:23 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
YS.shape, YS_pred.shape before, (3507, 3, 69, 1) (3507, 3, 69, 1)
YS.shape, YS_pred.shape after, (3507, 3, 69) (3507, 3, 69)
YS.shape, YS_pred.shape, (3507, 3, 69) (3507, 3, 69)
****************************************
GraphWaveNet, test, Torch MSE, 3.3953753627e-01, 0.3395375363
all pred steps, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 273.8766643882, 16.5492194495, 9.7022676775, 49.1031315529
1 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 159.6604415586, 12.6356812859, 7.6786341145, 41.1914212763
2 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 279.6653127969, 16.7231968474, 9.8068399485, 49.4358554580
3 step, GraphWaveNet, test, MSE, RMSE, MAE, MAPE, 382.3076219710, 19.5526883566, 11.6213884226, 56.6823496450
Model Testing Ended ... Mon Jan  3 18:34:24 2022
