nohup: ignoring input
../data-NYCBike/60min/2019-2020-graph-inflow.npz
Namespace(adjpath='../data-NYCZones/adjmatrix/W_od_bike_new.csv', adjtype='symnadj', batchsize=64, channel=1, dataname='METR-LA', epoch=200, ex='typhoon-inflow', flowpath='../data-NYCBike/60min/2019-2020-graph-inflow.npz', gpu=6, graphnum=2, loss='MAE', lr=0.001, n_node=69, optimizer='Adam', patience=10, target=0, timestep_in=12, timestep_out=3, trainratio=0.8, trainvalsplit=0.125)
data.shape (17544, 69)
pred_METR-LA_STGCN1_1_2201032143 training started Mon Jan  3 21:43:19 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14023, 1, 12, 69)
getXSYS YS.shape(14023, 1, 1, 69)
TRAIN XS.shape YS,shape (14023, 1, 12, 69) (14023, 1, 1, 69)
Model Training Started ... Mon Jan  3 21:43:19 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([2, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          256
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    |    └─spatio_conv_layer: 3-4       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-5                  [-1, 32, 10, 69]          2,080
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-6                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-7                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-8                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-9                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-10      [-1, 32, 6, 69]           3,104
|    |    └─spatio_conv_layer: 3-11      [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 32, 6, 69]           2,080
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-13                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-17                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-18                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 107,297
Trainable params: 107,297
Non-trainable params: 0
Total mult-adds (M): 16.41
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 2.43
Params size (MB): 0.41
Estimated Total Size (MB): 2.84
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.2420585116867914 validation loss: 0.27059292283251296
epoch 1 time used: 5  seconds  train loss: 0.18883107001934968 validation loss: 0.25687206200341534
epoch 2 time used: 5  seconds  train loss: 0.17850074426080506 validation loss: 0.2623003886569519
epoch 3 time used: 5  seconds  train loss: 0.1724628861759772 validation loss: 0.27390722339655155
epoch 4 time used: 5  seconds  train loss: 0.16611163573189294 validation loss: 0.26268340663371326
epoch 5 time used: 5  seconds  train loss: 0.16258513171593153 validation loss: 0.25572142585542496
epoch 6 time used: 5  seconds  train loss: 0.16151548010990108 validation loss: 0.2529478979855351
epoch 7 time used: 5  seconds  train loss: 0.15904911843469305 validation loss: 0.25936594600345636
epoch 8 time used: 5  seconds  train loss: 0.15797394096559883 validation loss: 0.2657415348498806
epoch 9 time used: 5  seconds  train loss: 0.15592764614798135 validation loss: 0.25891212614107595
epoch 10 time used: 5  seconds  train loss: 0.15672510518421462 validation loss: 0.25397097619002845
epoch 11 time used: 5  seconds  train loss: 0.15478049329168542 validation loss: 0.2567247469052545
epoch 12 time used: 5  seconds  train loss: 0.1536556959419398 validation loss: 0.2584852672480068
epoch 13 time used: 5  seconds  train loss: 0.15317196223972868 validation loss: 0.2650961404994632
epoch 14 time used: 5  seconds  train loss: 0.15338684538320108 validation loss: 0.26543209947862423
epoch 15 time used: 5  seconds  train loss: 0.15204081064865854 validation loss: 0.2598216981630766
Early stopping at epoch: 16
YS.shape, YS_pred.shape, (14023, 1, 1, 69) (14023, 1, 1, 69)
YS.shape, YS_pred.shape, (14023, 69) (14023, 69)
****************************************
STGCN1, train, Torch MSE, 1.5259776540e-01, 0.1525977654

STGCN1, train, MSE, RMSE, MAE, MAPE, 111.2775001035, 10.5488151042, 6.1346694415, 38.1284469513

Model Training Ended ... Mon Jan  3 21:45:05 2022
pred_METR-LA_STGCN1_1_2201032143 testing started Mon Jan  3 21:45:05 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3509, 1, 12, 69)
getXSYS YS.shape(3509, 1, 1, 69)
TEST XS.shape, YS.shape (3509, 1, 12, 69) (3509, 1, 1, 69)
Model Testing Started ... Mon Jan  3 21:45:05 2022
TIMESTEP_IN, TIMESTEP_OUT 12 1
torch.Size([2, 3, 69, 69])
YS.shape, YS_pred.shape, (3509, 1, 1, 69) (3509, 1, 1, 69)
YS.shape, YS_pred.shape, (3509, 69) (3509, 69)
****************************************
STGCN1, test, Torch MSE, 3.0924805051e-01, 0.3092480505

STGCN1, test, MSE, RMSE, MAE, MAPE, 189.0980614600, 13.7512930832, 8.3980703043, 42.7742266938

Model Testing Ended ... Mon Jan  3 21:45:11 2022
pred_METR-LA_STGCN2_1_2201032145 training started Mon Jan  3 21:45:11 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14022, 1, 12, 69)
getXSYS YS.shape(14022, 1, 1, 69)
TRAIN XS.shape YS,shape (14022, 1, 12, 69) (14022, 1, 1, 69)
Model Training Started ... Mon Jan  3 21:45:11 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([2, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          256
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    |    └─spatio_conv_layer: 3-4       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-5                  [-1, 32, 10, 69]          2,080
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-6                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-7                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-8                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-9                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-10      [-1, 32, 6, 69]           3,104
|    |    └─spatio_conv_layer: 3-11      [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 32, 6, 69]           2,080
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-13                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-17                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-18                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 107,297
Trainable params: 107,297
Non-trainable params: 0
Total mult-adds (M): 16.41
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 2.43
Params size (MB): 0.41
Estimated Total Size (MB): 2.84
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.29612734608977065 validation loss: 0.3620974356558278
epoch 1 time used: 5  seconds  train loss: 0.23107109209180257 validation loss: 0.35797195139097204
epoch 2 time used: 5  seconds  train loss: 0.20943972750027418 validation loss: 0.35860909954248943
epoch 3 time used: 5  seconds  train loss: 0.20026000241713843 validation loss: 0.3568063409275418
epoch 4 time used: 5  seconds  train loss: 0.19582012073341137 validation loss: 0.358807534455437
epoch 5 time used: 5  seconds  train loss: 0.19092432905481327 validation loss: 0.3566815099815471
epoch 6 time used: 5  seconds  train loss: 0.187310107894608 validation loss: 0.33172890651042436
epoch 7 time used: 5  seconds  train loss: 0.18386955256226575 validation loss: 0.34502993237611845
epoch 8 time used: 5  seconds  train loss: 0.18318159781090934 validation loss: 0.3464160700627755
epoch 9 time used: 5  seconds  train loss: 0.181119014433645 validation loss: 0.337629351575784
epoch 10 time used: 5  seconds  train loss: 0.17944421251111262 validation loss: 0.3246025124482951
epoch 11 time used: 5  seconds  train loss: 0.17637742899023667 validation loss: 0.3159308040985297
epoch 12 time used: 5  seconds  train loss: 0.17604492391581172 validation loss: 0.3393095704024
epoch 13 time used: 5  seconds  train loss: 0.17340131404954867 validation loss: 0.3264859324853487
epoch 14 time used: 5  seconds  train loss: 0.1721181236198376 validation loss: 0.3338512512050352
epoch 15 time used: 5  seconds  train loss: 0.1710332490121816 validation loss: 0.31556714028205046
epoch 16 time used: 5  seconds  train loss: 0.17067956053372146 validation loss: 0.3109605301806944
epoch 17 time used: 5  seconds  train loss: 0.1696574111186027 validation loss: 0.3215730646747354
epoch 18 time used: 5  seconds  train loss: 0.16854338668428295 validation loss: 0.3139379450374512
epoch 19 time used: 5  seconds  train loss: 0.1672840768246519 validation loss: 0.3108847191248087
epoch 20 time used: 5  seconds  train loss: 0.16681803921774263 validation loss: 0.30761852319826755
epoch 21 time used: 5  seconds  train loss: 0.16650651692639684 validation loss: 0.31077704653016375
epoch 22 time used: 5  seconds  train loss: 0.16436286012164847 validation loss: 0.30932846248863904
epoch 23 time used: 5  seconds  train loss: 0.16461496922913268 validation loss: 0.30550916575392656
epoch 24 time used: 5  seconds  train loss: 0.16521124011128036 validation loss: 0.31367621810111196
epoch 25 time used: 5  seconds  train loss: 0.16325378006119068 validation loss: 0.298548756074851
epoch 26 time used: 5  seconds  train loss: 0.16215429282516827 validation loss: 0.30787340248576317
epoch 27 time used: 5  seconds  train loss: 0.16206440471409683 validation loss: 0.30776422319926333
epoch 28 time used: 5  seconds  train loss: 0.16143475310664876 validation loss: 0.31108624275180863
epoch 29 time used: 5  seconds  train loss: 0.1613585619840852 validation loss: 0.31826513186224653
epoch 30 time used: 5  seconds  train loss: 0.16054693956894556 validation loss: 0.30592344141115274
epoch 31 time used: 5  seconds  train loss: 0.15929774421770712 validation loss: 0.3034921539761445
epoch 32 time used: 5  seconds  train loss: 0.15889238022108107 validation loss: 0.31752313201725313
epoch 33 time used: 5  seconds  train loss: 0.15885890920948834 validation loss: 0.30722631314313553
epoch 34 time used: 5  seconds  train loss: 0.15820210021572462 validation loss: 0.3149730258170224
Early stopping at epoch: 35
YS.shape, YS_pred.shape, (14022, 1, 1, 69) (14022, 1, 1, 69)
YS.shape, YS_pred.shape, (14022, 69) (14022, 69)
****************************************
STGCN2, train, Torch MSE, 1.5685795090e-01, 0.1568579509

STGCN2, train, MSE, RMSE, MAE, MAPE, 145.3562776378, 12.0563791263, 6.7296635464, 41.6931107389

Model Training Ended ... Mon Jan  3 21:48:45 2022
pred_METR-LA_STGCN2_1_2201032145 testing started Mon Jan  3 21:48:45 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3508, 1, 12, 69)
getXSYS YS.shape(3508, 1, 1, 69)
TEST XS.shape, YS.shape (3508, 1, 12, 69) (3508, 1, 1, 69)
Model Testing Started ... Mon Jan  3 21:48:45 2022
TIMESTEP_IN, TIMESTEP_OUT 12 2
torch.Size([2, 3, 69, 69])
YS.shape, YS_pred.shape, (3508, 1, 1, 69) (3508, 1, 1, 69)
YS.shape, YS_pred.shape, (3508, 69) (3508, 69)
****************************************
STGCN2, test, Torch MSE, 3.5390321547e-01, 0.3539032155

STGCN2, test, MSE, RMSE, MAE, MAPE, 280.2755811007, 16.7414330659, 9.7820221062, 48.2208627829

Model Testing Ended ... Mon Jan  3 21:48:45 2022
pred_METR-LA_STGCN3_1_2201032148 training started Mon Jan  3 21:48:45 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(14021, 1, 12, 69)
getXSYS YS.shape(14021, 1, 1, 69)
TRAIN XS.shape YS,shape (14021, 1, 12, 69) (14021, 1, 1, 69)
Model Training Started ... Mon Jan  3 21:48:45 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([2, 3, 69, 69])
==========================================================================================
Layer (type:depth-idx)                   Output Shape              Param #
==========================================================================================
├─st_conv_block: 1-1                     [-1, 64, 8, 69]           --
|    └─temporal_conv_layer: 2-1          [-1, 32, 10, 69]          --
|    |    └─align: 3-1                   [-1, 32, 12, 69]          --
|    |    └─Conv2d: 3-2                  [-1, 64, 10, 69]          256
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-3       [-1, 32, 10, 69]          3,104
|    |    └─spatio_conv_layer: 3-4       [-1, 32, 10, 69]          3,104
|    └─linear: 2-2                       [-1, 32, 10, 69]          --
|    |    └─Conv2d: 3-5                  [-1, 32, 10, 69]          2,080
|    └─temporal_conv_layer: 2-3          [-1, 64, 8, 69]           --
|    |    └─align: 3-6                   [-1, 64, 10, 69]          --
|    |    └─Conv2d: 3-7                  [-1, 64, 8, 69]           6,208
|    └─LayerNorm: 2-4                    [-1, 8, 69, 64]           8,832
|    └─Dropout: 2-5                      [-1, 64, 8, 69]           --
├─st_conv_block: 1-2                     [-1, 64, 4, 69]           --
|    └─temporal_conv_layer: 2-6          [-1, 32, 6, 69]           --
|    |    └─align: 3-8                   [-1, 32, 8, 69]           2,080
|    |    └─Conv2d: 3-9                  [-1, 64, 6, 69]           12,352
|    └─ModuleList: 2                     []                        --
|    |    └─spatio_conv_layer: 3-10      [-1, 32, 6, 69]           3,104
|    |    └─spatio_conv_layer: 3-11      [-1, 32, 6, 69]           3,104
|    └─linear: 2-7                       [-1, 32, 6, 69]           --
|    |    └─Conv2d: 3-12                 [-1, 32, 6, 69]           2,080
|    └─temporal_conv_layer: 2-8          [-1, 64, 4, 69]           --
|    |    └─align: 3-13                  [-1, 64, 6, 69]           --
|    |    └─Conv2d: 3-14                 [-1, 64, 4, 69]           6,208
|    └─LayerNorm: 2-9                    [-1, 4, 69, 64]           8,832
|    └─Dropout: 2-10                     [-1, 64, 4, 69]           --
├─output_layer: 1-3                      [-1, 1, 1, 69]            --
|    └─temporal_conv_layer: 2-11         [-1, 64, 1, 69]           --
|    |    └─align: 3-15                  [-1, 64, 4, 69]           --
|    |    └─Conv2d: 3-16                 [-1, 128, 1, 69]          32,896
|    └─LayerNorm: 2-12                   [-1, 1, 69, 64]           8,832
|    └─temporal_conv_layer: 2-13         [-1, 64, 1, 69]           --
|    |    └─align: 3-17                  [-1, 64, 1, 69]           --
|    |    └─Conv2d: 3-18                 [-1, 64, 1, 69]           4,160
|    └─Conv2d: 2-14                      [-1, 1, 1, 69]            65
==========================================================================================
Total params: 107,297
Trainable params: 107,297
Non-trainable params: 0
Total mult-adds (M): 16.41
==========================================================================================
Input size (MB): 0.00
Forward/backward pass size (MB): 2.43
Params size (MB): 0.41
Estimated Total Size (MB): 2.84
==========================================================================================
epoch 0 time used: 5  seconds  train loss: 0.3509818304525667 validation loss: 0.4418078521048757
epoch 1 time used: 5  seconds  train loss: 0.26214815901163 validation loss: 0.4542814582603289
epoch 2 time used: 5  seconds  train loss: 0.2400092289974062 validation loss: 0.4298844680198587
epoch 3 time used: 5  seconds  train loss: 0.23148814872767196 validation loss: 0.4186256960739902
epoch 4 time used: 5  seconds  train loss: 0.22096772361237021 validation loss: 0.40436074754815066
epoch 5 time used: 5  seconds  train loss: 0.2166165598477764 validation loss: 0.41405865016217513
epoch 6 time used: 5  seconds  train loss: 0.21326613327094154 validation loss: 0.41280800461157074
epoch 7 time used: 5  seconds  train loss: 0.20639035050317833 validation loss: 0.3937385988895103
epoch 8 time used: 5  seconds  train loss: 0.20415124008544386 validation loss: 0.3840783031341762
epoch 9 time used: 5  seconds  train loss: 0.199410979172326 validation loss: 0.3977703698111206
epoch 10 time used: 5  seconds  train loss: 0.19651096444157928 validation loss: 0.3990061407557094
epoch 11 time used: 5  seconds  train loss: 0.19615641937393452 validation loss: 0.36703606540654904
epoch 12 time used: 5  seconds  train loss: 0.19220866192949684 validation loss: 0.3709456218152609
epoch 13 time used: 5  seconds  train loss: 0.19213430440635762 validation loss: 0.41310066079930174
epoch 14 time used: 5  seconds  train loss: 0.19078384594397238 validation loss: 0.4003624285858696
epoch 15 time used: 5  seconds  train loss: 0.1893788208188395 validation loss: 0.3904088163675068
epoch 16 time used: 5  seconds  train loss: 0.18775251579665578 validation loss: 0.3789968124404337
epoch 17 time used: 5  seconds  train loss: 0.18539197287693215 validation loss: 0.40017011810967534
epoch 18 time used: 5  seconds  train loss: 0.18422668801094058 validation loss: 0.406866179387092
epoch 19 time used: 5  seconds  train loss: 0.18353936688341066 validation loss: 0.38343814418306366
epoch 20 time used: 5  seconds  train loss: 0.1830296286123367 validation loss: 0.3911031827509097
Early stopping at epoch: 21
YS.shape, YS_pred.shape, (14021, 1, 1, 69) (14021, 1, 1, 69)
YS.shape, YS_pred.shape, (14021, 69) (14021, 69)
****************************************
STGCN3, train, Torch MSE, 1.7845804362e-01, 0.1784580436

STGCN3, train, MSE, RMSE, MAE, MAPE, 201.9581978975, 14.2111997346, 7.7476142890, 47.8718106377

Model Training Ended ... Mon Jan  3 21:50:57 2022
pred_METR-LA_STGCN3_1_2201032148 testing started Mon Jan  3 21:50:57 2022
getXSYS data.shape(17544, 69)
getXSYS XS.shape(3507, 1, 12, 69)
getXSYS YS.shape(3507, 1, 1, 69)
TEST XS.shape, YS.shape (3507, 1, 12, 69) (3507, 1, 1, 69)
Model Testing Started ... Mon Jan  3 21:50:57 2022
TIMESTEP_IN, TIMESTEP_OUT 12 3
torch.Size([2, 3, 69, 69])
YS.shape, YS_pred.shape, (3507, 1, 1, 69) (3507, 1, 1, 69)
YS.shape, YS_pred.shape, (3507, 69) (3507, 69)
****************************************
STGCN3, test, Torch MSE, 4.2605599655e-01, 0.4260559965

STGCN3, test, MSE, RMSE, MAE, MAPE, 435.3055245920, 20.8639767205, 12.0787796568, 57.5154331571

Model Testing Ended ... Mon Jan  3 21:50:57 2022
